
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spkw13_c</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spkw13_c</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>
              <a href="#Detailed_Input">Detailed_Input<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>
              <big><b><a href="#Examples">Examples<br></a></b></big>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
              <a href="#Index_Entries">Index_Entries<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
   spkw13_c ( Write SPK segment, type 13 ) 

   void spkw13_c ( SpiceInt             handle,
                   SpiceInt             body,
                   SpiceInt             center,
                   ConstSpiceChar     * frame,
                   SpiceDouble          first,
                   SpiceDouble          last,
                   ConstSpiceChar     * segid,
                   SpiceInt             degree,
                   SpiceInt             n,
                   ConstSpiceDouble     states[][6],
                   ConstSpiceDouble     epochs[]     )

</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
   Write a type 13 segment to an SPK file.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
   <a href="../req/naif_ids.html">NAIF_IDS</a>
   <a href="../req/spc.html">SPC</a>
   <a href="../req/spk.html">SPK</a>
   <a href="../req/time.html">TIME</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
   EPHEMERIS
   FILES


</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
   VARIABLE  I/O  DESCRIPTION
   --------  ---  --------------------------------------------------
   handle     I   Handle of an SPK file open for writing.
   body       I   NAIF code for an ephemeris object.
   center     I   NAIF code for center of motion of body.
   frame      I   Reference frame name.
   first      I   Start time of interval covered by segment.
   last       I   End time of interval covered by segment.
   segid      I   Segment identifier.
   degree     I   Degree of interpolating polynomials.
   n          I   Number of states.
   states     I   Array of states.
   epochs     I   Array of epochs corresponding to states.
   MAXDEG     P   Maximum allowed degree of interpolating polynomial.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
   handle      is the file handle of an SPK file that has been
               opened for writing.

   body        is the NAIF integer code for an ephemeris object
               whose state relative to another body is described
               by the segment to be created.

   center      is the NAIF integer code for the center of motion
               of the object identified by body.

   frame       is the NAIF name for a reference frame
               relative to which the state information for body
               is specified.

   first,
   last        are, respectively, the start and stop times of
               the time interval over which the segment defines
               the state of body.

   segid       is the segment identifier. An SPK segment
               identifier may contain up to 40 characters.

   degree      is the degree of the Hermite polynomials used to
               interpolate the states. All components of the
               state vectors are interpolated by polynomials of
               fixed degree.

   n           is the number of states in the input state vector
               array.

   states      contains a time-ordered array of geometric states
               ( x, y, z, dx/dt, dy/dt, dz/dt, in kilometers and
               kilometers per second ) of body relative to center,
               specified relative to frame.

   epochs      is an array of epochs corresponding to the members
               of the state array. The epochs are specified as
               seconds past J2000, TDB.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
   None. See -Particulars for a description of the effect of this
   routine.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
   MAXDEG         is the maximum allowed degree of the interpolating
                  polynomial. If the value of MAXDEG is increased,
                  the SPICELIB routine SPKPVN must be changed
                  accordingly. In particular, the size of the
                  record passed to SPKRnn and SPKEnn must be
                  increased, and comments describing the record size
                  must be changed.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
   If any of the following exceptions occur, this routine will return
   without creating a new segment.

   1)  If `frame' is not a recognized name, the error
       SPICE(INVALIDREFFRAME) is signaled by a routine in the call
       tree of this routine.

   2)  If the last non-blank character of `segid' occurs past index 40,
       the error SPICE(SEGIDTOOLONG) is signaled by a routine in the
       call tree of this routine.

   3)  If `segid' contains any nonprintable characters, the error
       SPICE(NONPRINTABLECHARS) is signaled by a routine in the call
       tree of this routine.

   4)  If `degree' is not at least 1 or is greater than MAXDEG, the
       error SPICE(INVALIDDEGREE) is signaled by a routine in the
       call tree of this routine.

   5)  If `degree' is not odd, the error SPICE(INVALIDDEGREE) is
       signaled by a routine in the call tree of this routine.

   6)  If the number of states `n' is not at least (degree+1)/2, the
       error SPICE(TOOFEWSTATES) is signaled by a routine in the call
       tree of this routine.

   7)  If `first' is greater than or equal to `last', the error
       SPICE(BADDESCRTIMES) is signaled by a routine in the call tree
       of this routine.

   8)  If the elements of the array `epochs' are not in strictly
       increasing order, the error SPICE(TIMESOUTOFORDER) is
       signaled by a routine in the call tree of this routine.

   9)  If the first epoch, epochs[0], is greater than `first', the
       error SPICE(BADDESCRTIMES) is signaled by a routine in the
       call tree of this routine.

   10) If the last epoch, epochs[n-1], is less than `last', the error
       SPICE(BADDESCRTIMES) is signaled by a routine in the call tree
       of this routine.

   11) If any of the `frame' or `segid' input string pointers is
       null, the error SPICE(NULLPOINTER) is signaled.

   12) If any of the `frame' or `segid' input strings has zero
       length, the error SPICE(EMPTYSTRING) is signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
   A new type 13 SPK segment is written to the SPK file attached
   to HANDLE.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
   This routine writes an SPK type 13 data segment to the open SPK
   file according to the format described in the type 13 section of
   the SPK Required Reading. The SPK file must have been opened with
   write access.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
   The numerical results shown for this example may differ across
   platforms. The results depend on the SPICE kernels used as
   input, the compiler and supporting libraries, and the machine
   specific arithmetic implementation.

   1) Suppose that you have a time-ordered array of geometric states
      of a new object that follows Phobos, with a delay of 1 hour,
      in its orbit around Mars and are prepared to produce a segment
      of type 13 in an SPK file. Create a new SPK file with this
      segment. Use an existing SPK to create the input data for the
      SPK segment.

      Use the meta-kernel shown below to load the required SPICE
      kernels.


         KPL/MK

         File: spkw13_ex1.tm

         This meta-kernel is intended to support operation of SPICE
         example programs. The kernels shown here should not be
         assumed to contain adequate or correct versions of data
         required by SPICE-based user applications.

         In order for an application to use this meta-kernel, the
         kernels referenced here must be present in the user's
         current working directory.

         The names and contents of the kernels referenced
         by this meta-kernel are as follows:

            File name                        Contents
            ---------                        --------
            mar097.bsp                       Mars satellite ephemeris
            naif0012.tls                     Leapseconds

         \begindata

            KERNELS_TO_LOAD = ( 'mar097.bsp',
                                'naif0012.tls' )

         \begintext

         End of meta-kernel


      Example code begins here.


      /.
         Program spkw13_ex1
      ./
      #include &lt;stdio.h&gt;
      #include &lt;math.h&gt;
      #include &quot;SpiceUsr.h&quot;

      int main( )
      {

         /.
         Local parameters.
         ./
         #define SPKNAM       &quot;spkw13_ex1.bsp&quot;
         #define DEGREE       3
         #define MARS         499
         #define NEPOCS       800
         #define NOBJ         403

         /.
         Local variables.
         ./
         SpiceChar          * ifname;
         SpiceChar          * segid;

         SpiceDouble          delta;
         SpiceDouble          et;
         SpiceDouble          epochs [NEPOCS];
         SpiceDouble          lt;
         SpiceDouble          state  [6];
         SpiceDouble          states [NEPOCS][6];
         SpiceDouble          step;
         SpiceDouble          time;

         SpiceInt             i;
         SpiceInt             handle;

         /.
         Load the input SPK file.
         ./
         <a href="furnsh_c.html">furnsh_c</a> ( &quot;spkw13_ex1.tm&quot; );

         /.
         Convert the input UTC to ephemeris time
         ./
         <a href="str2et_c.html">str2et_c</a> ( &quot;2018 Apr 03 08:35&quot;, &amp;et );

         /.
         Create the time-ordered array of geometric states,
         at unequal time steps.
         ./
         time  = et;
         step  = 60.0;
         delta = 10.0;

         for ( i = 0; i &lt; NEPOCS; i++ )
         {

            <a href="spkezr_c.html">spkezr_c</a> ( &quot;PHOBOS&quot;,    time, &quot;J2000&quot;, &quot;NONE&quot;, &quot;MARS&quot;,
                        states[i], &amp;lt                           );

            epochs[i] = time + 3600.0;
            time = time + step + sin( <a href="halfpi_c.html">halfpi_c</a> ( ) * i / 2.0 ) * delta;

         }

         /.
         Open a new SPK file, with 5000 characters reserved
         for comments.
         ./
         ifname = &quot;Test SPK type 13 internal filename.&quot;;
         <a href="spkopn_c.html">spkopn_c</a> ( SPKNAM, ifname, 5000, &amp;handle );

         /.
         Create a segment identifier.
         ./
         segid = &quot;MY_SAMPLE_SPK_TYPE_13_SEGMENT&quot;;

         /.
         Write the segment.
         ./
         <b>spkw13_c</b> ( handle,    NOBJ,             MARS, &quot;J2000&quot;,
                    epochs[0], epochs[NEPOCS-1], segid, DEGREE,
                    NEPOCS,    states,           epochs        );

         /.
         Close the new SPK file.
         ./
         <a href="spkcls_c.html">spkcls_c</a> ( handle );

         /.
         Compute the state of Phobos as seen from Mars,
         12 hours after the input UTC time.
         ./
         et = et + 43200.0;
         <a href="spkezr_c.html">spkezr_c</a> ( &quot;PHOBOS&quot;, et, &quot;J2000&quot;, &quot;NONE&quot;, &quot;MARS&quot;,
                     state,  &amp;lt                          );

         printf( &quot;Phobos as seen from Mars\n&quot; );
         printf( &quot;   Epoch       (s): %19.5f\n&quot;, et );
         printf( &quot;   Position   (km): %13.5f %13.5f %13.5f\n&quot;,
                                state[0], state[1], state[2] );
         printf( &quot;   Velocity (km/s): %13.5f %13.5f %13.5f\n&quot;,
                                state[3], state[4], state[5] );
         printf( &quot;\n&quot; );

         /.
         Load the newly created kernel, and compute the state
         of the new object as seen from Mars, 13 hours after
         the input UTC time.
         ./
         <a href="furnsh_c.html">furnsh_c</a> ( SPKNAM );
         et = et + 3600.0;

         <a href="spkezr_c.html">spkezr_c</a> ( &quot;403&quot;,   et, &quot;J2000&quot;, &quot;NONE&quot;, &quot;MARS&quot;,
                     state, &amp;lt                         );

         printf( &quot;Object 403 as seen from Mars\n&quot; );
         printf( &quot;   Epoch       (s): %19.5f\n&quot;, et );
         printf( &quot;   Position   (km): %13.5f %13.5f %13.5f\n&quot;,
                                state[0], state[1], state[2] );
         printf( &quot;   Velocity (km/s): %13.5f %13.5f %13.5f\n&quot;,
                                state[3], state[4], state[5] );

         return ( 0 );
      }


      When this program was executed on a Mac/Intel/cc/64-bit
      platform, the output was:


      Phobos as seen from Mars
         Epoch       (s):     576059769.18566
         Position   (km):   -7327.26277    2414.32655    5207.10638
         Velocity (km/s):      -0.94289      -1.89473      -0.39671

      Object 403 as seen from Mars
         Epoch       (s):     576063369.18566
         Position   (km):   -7327.26277    2414.32655    5207.10638
         Velocity (km/s):      -0.94289      -1.89473      -0.39671


      Note that after run completion, a new SPK file exists in
      the output directory.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
   None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
   None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
   N.J. Bachman        (JPL)
   J. Diaz del Rio     (ODC Space)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
   -CSPICE Version 1.0.1, 10-AUG-2021 (JDR)

       Edited the header to comply with NAIF standard.

       Added complete example to the -Examples section.

   -CSPICE Version 1.0.0, 15-FEB-2000 (NJB)
</PRE>
<h4><a name="Index_Entries">Index_Entries</a></h4>
<PRE>
   write SPK type_13 ephemeris data segment
</PRE>
<h4>Link to routine spkw13_c source file <a href='../../../src/cspice/spkw13_c.c'>spkw13_c.c</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:41:13 2021</pre>

</body>
</html>

