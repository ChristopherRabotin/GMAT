<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="DesigningaHohmannTransfer"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>Designing a Hohmann Transfer</title>

  <section>
    <title>Objective and Overview</title>

    <para><emphasis role="bold">Final result:</emphasis> <link
    xlink:href="scripts/HohmannTransferDesign.script">HohmannTransferDesign.script</link></para>

    <para>In this tutorial, we will use differential correction to perform a
    Hohmann transfer from an initial parking orbit to a final mission orbit.
    In order to focus on the configuration of the target sequence, we will
    make extensive use of the default configurations for spacecraft,
    propagators, and maneuvers. This tutorial is split into the following
    basic steps:</para>

    <procedure>
      <step>
        <para>Create and configure a differential corrector.</para>
      </step>

      <step>
        <para>Modify the default Orbit View to visualize the
        trajectory.</para>
      </step>

      <step>
        <para>Create two default Impulsive Maneuvers.</para>
      </step>

      <step>
        <para>Add a target sequence to the mission to raise apogee to GEO
        altitude.</para>
      </step>

      <step>
        <para>Add a second target sequence to circularize the orbit.</para>
      </step>

      <step>
        <para>Run the mission, save the solution, and rerun the mission using
        the converged solution.</para>
      </step>
    </procedure>
  </section>

  <section>
    <title>Creating and Configuring the Resource Tree</title>

    <para>Begin by loading the default mission ( click the new mission button
    in the toolbar) or starting a new GMAT session. For this tutorial, we will
    use the default configurations for DefaultSC, DefaultProp, and the default
    impulsive burn. DefaultSC is configured to a near circular orbit and
    DefaultProp is configured to use Earth as the central body with Earth
    10x10 gravity field and perturbations from the Sun and Moon. The default
    impulsive burn is in the VNB coordinate system. You may want to open the
    dialog boxes for these objects and look more closely at them as we will
    leave the settings of those objects at their default values.</para>

    <section>
      <title>Creating the Differential Corrector</title>

      <para>To create a differential corrector for use in the mission
      sequence:</para>

      <procedure>
        <step>
          <para>Locate the Solvers folder in the Resource Tree and expand if
          it is minimized.</para>
        </step>

        <step>
          <para>Right-click the Boundary Value Solvers folder, select Add, and
          then select DifferentialCorrector.</para>
        </step>
      </procedure>
    </section>

    <section>
      <title>Modifying the default Orbit View</title>

      <para>We need to make minor modifications to default Orbit View so that
      the entire final orbit will fit in the graphics window.</para>

      <procedure>
        <step>
          <para>Locate DefaultOrbitView in the Resource Tree, and right-click
          on it, and select Open.</para>
        </step>

        <step>
          <para>Change the SolverIterations input field, located in the
          Drawing Option group box, to the value All.</para>
        </step>

        <step>
          <para>Change the ViewScaleFactor input field to the value
          1.5.</para>
        </step>

        <step>
          <para>Change the ViewUpDefinition Axis to X.</para>
        </step>

        <step>
          <para>Verify the configuration against the screen capture below,
          make any changes necessary, and click Ok on the DefaultOrbitView
          dialog box.</para>
        </step>
      </procedure>

      <para><screenshot>
          <info>
            <title>Modifications to the Default OrbitView</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" contentdepth="100%"
                         fileref="files/images/Tut_Hohmann_DefaultOpenGL.png"
                         scalefit="1" width="100%"></imagedata>
            </imageobject>

            <caption>
              <para>Modifications to the Default OrbitView</para>
            </caption>
          </mediaobject>
        </screenshot></para>
    </section>

    <section>
      <title>Creating the Maneuvers.</title>

      <para>You need two default maneuvers for this tutorial and we will
      rename the default maneuver and create a new maneuver:</para>

      <procedure>
        <step>
          <para>Locate DefaultIB in the Resource Tree, right-click on it,
          select Rename, and change the name to dv1.</para>
        </step>

        <step>
          <para>Right-click on the Burns folder, select
          Add--&gt;ImpulsiveBurn.</para>
        </step>

        <step>
          <para>Right-click on the impulsive burn created in the previous
          step, select Rename, and change the name to dv2.</para>
        </step>
      </procedure>
    </section>
  </section>

  <section>
    <title>Creating and Configuring the Mission Tree</title>

    <para>Below you will create two targeting segments. The first targeting
    segment will raise orbit apogee to GEOsynchronous altitude (~42165km). The
    second targeting segment will circularize the orbit. Each targeting
    segment employs a Target command, a Vary command, a Maneuver, a Propagate
    Command and Achieve command inside of the Target branch command. You'll
    begin by modifying the intial propagate command to propagate to periapsis.
    Next you will create the command structure and finally you will configure
    each command.</para>

    <section>
      <title>Initial Propagate Sequence</title>

      <para>To configure the initial propagate sequence to propagate to
      periapsis, perform the following steps:</para>

      <procedure>
        <step>
          <para>Left-click on the Mission tab to bring up the Mission
          Tree.</para>
        </step>

        <step>
          <para>Right-click on Propagate1 and select Open from the
          menu.</para>
        </step>

        <step>
          <para>Locate the Stopping Conditions group box and then right click
          on the set of ellipses next to the text "DefaultSC.ElapsedSecs".
          This will open the Parameter Select Dialog box.</para>
        </step>

        <step>
          <para>Under the Object Properties list on the Parameter Select
          Dialog box, locate periapsis and double-click on it. Click the Ok
          button to close the Parameter Select Dialog box.</para>
        </step>

        <step>
          <para>Click the Ok button on the Propagate 1 dialog box to save
          changes and close.</para>
        </step>
      </procedure>

      <screenshot>
        <info>
          <title>Figure: Propagate1 Propagate Command</title>
        </info>

        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Tut_Hohmann_Propagate1PropagateCommand.jpeg"
                       scalefit="1" width="100%"></imagedata>
          </imageobject>

          <caption>
            <para>Figure: Propagate1 Propagate Command</para>
          </caption>
        </mediaobject>
      </screenshot>

      <section>
        <title>Creating the Command Sequence</title>

        <para>To determine the delta Vs required to raise the orbit apogee to
        GEO altitude and then circularize the orbit , you will employ a
        Targeting loop. Begin by creating the commands necessary to perform
        the targeting sequence as described below. The figure below
        illustrates the configuration of the mission tree after you have
        completed the steps in this section.</para>

        <screenshot>
          <info>
            <title>Figure: Mission Tree for Hohmann Transfer</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" contentdepth="100%"
                         fileref="files/images/Tut_Hohmann_MissionTree.png"
                         scalefit="1" width="100%"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Mission Tree for Hohmann Transfer</para>
            </caption>
          </mediaobject>
        </screenshot>

        <procedure>
          <step>
            <para>Right-click on Propagate1 in the Misssion Tree, select
            Insert After, and select Target.</para>
          </step>

          <step>
            <para>Right-click on Target1 in the Mission Tree, select Insert
            After, and select Vary.</para>
          </step>

          <step>
            <para>Right-click on Vary1 in the Mission Tree, select Insert
            After, and select Manuever.</para>
          </step>

          <step>
            <para>Right-click on Maneuver1 in the Mission Tree, select Insert
            After, and select Propagate.</para>
          </step>

          <step>
            <para>Right-click on Propagate2 in the Mission Tree, select Insert
            After, and select Achieve.</para>
          </step>

          <step>
            <para>Right-click on Achieve1 in the Mission Tree, select Insert
            After, and select Vary.</para>
          </step>

          <step>
            <para>Right-click on Vary2 in the Mission Tree, select Insert
            After, and select Manuever.</para>
          </step>

          <step>
            <para>Right-click on Maneuver2 in the Mission Tree, select Insert
            After, and select Propagate.</para>
          </step>

          <step>
            <para>Right-click on Propagate3 in the Mission Tree, select Insert
            After, and select Achieve.</para>
          </step>
        </procedure>

        <para>Let's talk about the function of the command sequence you
        created above. The Vary commands define the variables the differential
        corrector can modify to achieve the goals defined in the Achieve
        commands. Because there are two variables (Vary commands) and two
        Achieve commands (constraints), this is a "square" targeting problem.
        Below you will configure the Vary commands to modify the maneuver
        values to achieve a final orbit radius of 42165 and an eccentricity of
        0.0001</para>
      </section>

      <section>
        <title>Configuring the Command Sequence</title>

        <para>Now you will configure the commands you created above to solve
        for the delta-Vs required to perform a Hohmann transfer.</para>

        <procedure>
          <step>
            <para>Right Click on Target1 in the Mission Tree and select Open.
            Locate the ExitMode drop-down menu and set it to SaveAndContinue.
            This will save the converged solution of the targeting
            problem.</para>
          </step>

          <step>
            <para>When you are finished, click OK to close the Target1 dialog
            box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Target1TargetCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Target1 Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Right Click on Vary1 in the Mission Tree and select Open.
            Notice that the in the Variable SetUp group box, the variable is
            defined as dv1.Element1. This is the velocity component of dv1 in
            the local VNB system. So we do not need to change the targeter
            variable.</para>
          </step>

          <step>
            <para>Locate the initial value text box and set it to 1.0.</para>
          </step>

          <step>
            <para>Set the MaxStep to 0.5 and then click Ok to close the Vary1
            dialog box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Vary1VaryCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Vary1 Vary Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Right-click on the Maneuver1 command in the Mission Tree.
            Notice that the command is set to apply DefaultIB to DefaultSC so
            we do not need to change any settings for this command. Click Ok
            to close the Maneuver1 dialog box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Maneuver1ManeuverCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Maneuver1 Maneuver Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Right-click on the Propagate2 dialog box. Use the same
            procedure shown in the sections above to set the stopping condtion
            to Apoapsis and then click Ok to close the dialog box.</para>
          </step>

          <step>
            <para>Finally, Right-click on the <literal>Achieve1</literal>
            command in the Mission Tree. Notice that the goal is set to
            DefaultSC.Earth.RMAG. So we do not need to change any settings for
            this command. Click Ok to close the dialog box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Achieve1AchieveCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Achieve1 Achieve Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Click on Vary2 in the Mission Tree and select Open.</para>
          </step>

          <step>
            <para>Click the Edit button next to Variable text box.</para>
          </step>

          <step>
            <para>Click on dv2 under the Object List.</para>
          </step>

          <step>
            <para>Double-click on Element1 under the ObjectProperties.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_ParamSelectdV2.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Achieve1 Achieve Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Locate the initial value text box and set it to 1.0.</para>
          </step>

          <step>
            <para>Locate the MaxStep text box and set it to 0.2. Click Ok to
            close the Vary1 dialog box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Vary2VaryCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Achieve1 Achieve Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Right-click on the <literal>Maneuver2</literal> command in
            the Mission Tree.</para>
          </step>

          <step>
            <para>Locate the on the <literal>Burn</literal> combo box and
            change it to <literal>dv2</literal>. Click OK to close the
            Maneuver2 dialog box.</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Achieve1AchieveCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Achieve1 Achieve Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>

          <step>
            <para>Right-click on the Propagate2 dialog box. Use the same
            procedure shown above to set the stopping condtion to
            <literal>Apoapsis</literal> and then click Ok to close the dialog
            box.</para>
          </step>

          <step>
            <para>Finally, Right-click on the Achieve2 command in the Mission
            Tree.</para>
          </step>

          <step>
            <para>Click on the Edit button next to the Goal text box.
            Tree.</para>
          </step>

          <step>
            <para>Locate <literal> ECC </literal> in the Object Properties
            list and double-click on it. Hit Ok to close the Parameter Select
            Dialog Box.</para>
          </step>

          <step>
            <para>Change the <literal> Value </literal> to 0.005.</para>
          </step>

          <step>
            <para>Change the <literal> Tolerance </literal> to 0.0001</para>

            <screenshot>
              <mediaobject>
                <imageobject>
                  <imagedata align="center" contentdepth="100%"
                             fileref="files/images/Tut_Hohmann_Achieve2AchieveCommand.png"
                             scalefit="1" width="100%"></imagedata>
                </imageobject>

                <caption>
                  <para>Figure: Achieve1 Achieve Command</para>
                </caption>
              </mediaobject>
            </screenshot>
          </step>
        </procedure>
      </section>
    </section>
  </section>

  <section>
    <title>Running the Mission</title>

    <para>Before running the mission, click on the Save button in the toolbar
    and save your file to the desired location. Now click on the Run button in
    the Toolbar. As the mission is running, you will see the Differetial
    Corrector try different maneuvers values resulting in trajectories
    iterations in light blue. These are Differential Corrector iterations, and
    perturbation passes to determine the Jacobian of the two-point boundary
    value problem. After the mission is run, the OrbitView should appear
    similar to the image shown below.</para>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_Hohmann_OutputAfterFinalPropagateSequence.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Output After Final Propagate Sequence</para>
        </caption>
      </mediaobject>
    </screenshot>
  </section>
</section>
