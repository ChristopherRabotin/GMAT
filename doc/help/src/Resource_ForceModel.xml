<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0" xml:id="ForceModel"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>ForceModel</primary>
  </indexterm>

  <refmeta>
    <refentrytitle>ForceModel</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>

    <refmiscinfo class="version">2012a</refmiscinfo>

    <refmiscinfo class="manual">Resources</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>ForceModel</refname>

    <refpurpose>A model of enviromental forces.</refpurpose>
  </refnamediv>

  <refsection>
    <title>Description</title>

    <para>A <guilabel>ForceModel</guilabel> is a model of the environmental
    forces and dynamics that affect the motion of a spacecraft. GMAT supports
    numerous force models such as point mass and spherical harmonic gravity
    models, atmospheric drag, solar radiation pressure, tide models, and
    relativistic corrections. A <guilabel>ForceModel</guilabel> is configured
    and attached to the <guilabel>Propagator</guilabel> object (see the
    Propagator object for differences between script and GUI configuration
    when configuring a Propagator). The <guilabel>Propagator</guilabel>, along
    with the <guilabel>Propagate</guilabel> command, uses a
    <guilabel>ForceModel</guilabel> to numerically solve the orbital equations
    of motion (forwards or backwards in time) using the forces configured in
    the <guilabel>ForceModel</guilabel> object, and may include thrust terms
    in the case of powered flight. See the Remarks and Examples below for
    detailed information on how to configure force models for your
    application.</para>

    <para><phrase role="ref_seealso">See Also</phrase>: <xref
    linkend="Propagator"/></para>
  </refsection>

  <refsection>
    <title>Options</title>

    <informaltable colsep="0" frame="topbot">
      <tgroup cols="2">
        <colspec colnum="1" colwidth=".5*"/>

        <colspec colnum="2" colwidth="3*"/>

        <thead>
          <row>
            <entry>Option</entry>

            <entry>Description</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry><guilabel>CentralBody</guilabel></entry>

            <entry><para>The central body of propagation.
            <guilabel>CentralBody</guilabel> must be a celestial body and
            cannot be a <guilabel>LibrationPoint</guilabel>,
            <guilabel>Barycenter</guilabel>, <guilabel>Spacecraft</guilabel>,
            or other special point.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>OBJECT_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Celestial Body</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>Earth</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Drag</guilabel></entry>

            <entry><para>Deprecated. This field has been replaced with
            <guilabel>Drag.AtmosphereModel</guilabel>.</para></entry>
          </row>

          <row>
            <entry><guilabel>Drag.AtmosphereModel </guilabel></entry>

            <entry><para>Specifies the atmosphere model used in the drag
            force. This field is only active if there is a
            <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>None</guilabel>,
                    <guilabel>JacchiaRoberts</guilabel>,
                    <guilabel>MSISE86</guilabel>,
                    <guilabel>MSISE90</guilabel>, <guilabel>NRLMSISE00.
                    </guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>MSISE90</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Drag.F107</guilabel></entry>

            <entry><para>The instantaneous value of solar flux at wavelength
            of 10.7 cm. This field is only active if there is a
            <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>REAL_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>50 &lt;= Draft.F107 &lt;= 400</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>150</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>W/m^2/Hz</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Drag.F107A</guilabel></entry>

            <entry><para>The average (monthly) value of solar flux at
            wavelength of 10.7 cm. This field is only active in the script if
            there is a <guilabel>PrimaryBody</guilabel>.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>REAL_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>50 &lt;= Drag.F107A &lt;= 400</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>150</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>W/m^2/Hz</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Drag.MagneticIndex</guilabel></entry>

            <entry><para>The geomagnetic index (Kp) used in density
            calculations. Kp is a planetary 3-hour-average, geomagnetic index
            that measures magnetic effects of solar radiation. This field is
            only active if there is a <guilabel>PrimaryBody</guilabel>.
            </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>REAL_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>0 &lt;= Real Number &lt;= 9</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>3</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>ErrorControl </guilabel></entry>

            <entry><para>Controls how error in the current integration step is
            estimated. The error in the current step is computed by the
            selection of <guilabel>ErrorControl</guilabel> and compared to the
            value set in the <guilabel>Accuracy</guilabel> field to determine
            if the step has an acceptable error or needs to be improved. All
            error measurements are relative error, however, the reference for
            the relative error changes depending upon the selection of
            <guilabel>ErrorControl</guilabel>. <guilabel>RSSStep</guilabel> is
            the Root Sum Square (RSS) relative error measured with respect to
            the current step. <guilabel>RSSState</guilabel> is the (RSS)
            relative error measured with respect to the current state.
            <guilabel>LargestStep</guilabel> is the state vector component
            with the largest relative error measured with respect to the
            current step. <guilabel>LargestState</guilabel> is the state
            vector component with the largest relative error measured with
            respect to the current state. Setting
            <guilabel>ErrorControl</guilabel> to <guilabel>None</guilabel>
            turns off error control and the integrator takes constant steps at
            the value defined by <guilabel>InitialStepSize</guilabel> on the
            numerical integrator.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>None</guilabel>,
                    <guilabel>RSSStep</guilabel>,
                    <guilabel>RSSState</guilabel>,
                    <guilabel>LargestState</guilabel>,
                    <guilabel>LargestStep</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>RSSStep</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>GravityField.Earth.EarthTideModel</guilabel></entry>

            <entry><para>Flag for type of Earth tide model. This field is
            always active but only used in the dynamics when there is a
            harmonic gravity model for Earth.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>None</guilabel>,
                    <guilabel>SolidAndPole</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>None</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>GravityField.<replaceable>PrimaryBodyName</replaceable>.Degree
            </guilabel></entry>

            <entry><para>The degree of the harmonic gravity field. This field
            is only active if there is a <guilabel>PrimaryBody</guilabel>.
            </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>INTEGER_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>0&lt;Degree&lt;Max Degree On File</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>4 (When loading a custom file in the GUI, GMAT sets
                    <guilabel>Degree</guilabel> to the max value on the
                    file)</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>GravityField.<replaceable>PrimaryBodyName</replaceable>.Order</guilabel></entry>

            <entry><para>The order of the harmonic gravity field. This field
            is only active if there is a <guilabel>PrimaryBody</guilabel>.
            </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>INTEGER_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>0&lt;<guilabel>Order</guilabel>&lt;Max Degree On
                    File AND <guilabel>Degree</guilabel> &lt;=
                    <guilabel>Order</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>4 (When loading a custom file in the GUI, GMAT sets
                    <guilabel>Order</guilabel> to the max value on the
                    file)</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>GravityField.<replaceable>PrimaryBodyName</replaceable>.PotentialFile</guilabel></entry>

            <entry><para>The gravity potential file. This field is only active
            if there is a <guilabel>PrimaryBod</guilabel>y. See the Remarks
            section below for detailed explanation of supported file types and
            how to configure gravity files.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Gravity File</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>path and name of .cof OR .grv file</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>JGM2.cof</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>Model</guilabel></entry>

            <entry><para>A GUI list of "configured' gravity files defined in
            the file gmat_startup_file.txt. <guilabel>Model</guilabel> allows
            you to quickly choose between gravity files distributed with GMAT.
            For example, if <guilabel>PrimaryBody</guilabel> is Earth, you can
            select among Earth gravity models provided with GMAT such as
            <guilabel>JGM-2</guilabel> and <guilabel>EGM-96</guilabel>. If you
            select <guilabel>Other</guilabel>, you can provide the path and
            filename for a custom gravity file.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Model Type</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>JGM-2</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>Gravity File Name.</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>JGM-2</guilabel>,
                    <guilabel>JGM-3</guilabel>, <guilabel>EGM-96</guilabel>,
                    <guilabel>Mars-50C</guilabel>,
                    <guilabel>MGNP-180U</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>PointMasses</guilabel></entry>

            <entry><para>A list of celestial bodies to be treated as point
            masses in the force model. A body cannot be both the
            <guilabel>PrimaryBody</guilabel> and in the
            <guilabel>PointMasses</guilabel> list.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Celestial Body List</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Celestial Body not selected as
                    <guilabel>PrimaryBody</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>Empty List</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>PrimaryBodies</guilabel></entry>

            <entry><para>A body modeled with a "complex" force model. A
            primary body can have an atmosphere and harmonic gravity model.
            Currently GMAT only supports one primary body per force model. The
            primary body must be the same as the
            <guilabel>CentralBody</guilabel>, and cannot be included in the
            <guilabel>PointMasses</guilabel> field. </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Celestial Body</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>Celestial Body</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>Earth</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>RelativisticCorrection</guilabel></entry>

            <entry><para>Sets relativistic correction on or
            off.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>On</guilabel>,
                    <guilabel>Off</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para><guilabel>Off</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SRP</guilabel></entry>

            <entry><para>Sets SRP force on or off. See the Remarks section for
            a detailed explanation of SRP configuration.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Enumeration</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para><guilabel>On</guilabel>,
                    <guilabel>Off</guilabel></para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>Off</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>N/A</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>GUI, script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SRP.Flux</guilabel></entry>

            <entry><para>The value of SRP flux at 1 AU. This field is only
            active in the script if <guilabel>SRP</guilabel> is on.
            </para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>REAL_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>1300 &lt;<guilabel>SRP.Flux</guilabel> &lt;
                    1450</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>1367</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>W/m^2</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SRP.Flux_Pressure</guilabel></entry>

            <entry><para>The solar flux at 1 AU divided by the speed of light.
            This field is only active in the script if SRP is on. See the
            Remarks section for a detailed explanation of SRP
            configuration.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>REAL_TYPE</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>4.33e-6 &lt; <guilabel>SRP.Flux_Pressure</guilabel>
                    &lt; 4.84e-6</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>4.55982118135874e-006</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>W *s/m^3</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>

          <row>
            <entry><guilabel>SRP.Nominal_Sun </guilabel></entry>

            <entry><para>The value of one Astronomical Unit in km used in
            scaling SRP.Flux, which is flux at 1 AU, to the flux at spacecraft
            distance from sun. This field is only active in the script if SRP
            is on. See the Remarks section for a detailed explanation of SRP
            configuration.</para><variablelist>
                <varlistentry>
                  <term>Data Type</term>

                  <listitem>
                    <para>Real</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>135e6&lt;<guilabel>Nominal_Sun</guilabel>&lt;165e6</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Access</term>

                  <listitem>
                    <para>set</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>149597870.691</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Units</term>

                  <listitem>
                    <para>km</para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>script</para>
                  </listitem>
                </varlistentry>
              </variablelist></entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </refsection>

  <refsection>
    <title>GUI</title>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Resource_ForceModel.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>
    </screenshot>

    <para>Settings for the<guilabel> ForceModel</guilabel> object.</para>
  </refsection>

  <refsection>
    <title>Remarks</title>

    <para><emphasis>Overview of Primary Body/Central Body and Field
    Interactions</emphasis></para>

    <para>In GMAT, a primary body is a celestial body that is modeled with a
    complex force model which may include a spherical harmonic gravity model,
    tides, or drag. A body cannot appear in both the
    <guilabel>PrimaryBodies</guilabel> and <guilabel>PointMasses</guilabel>
    fields. GMAT currently requires that there are no more than one primary
    body per <guilabel>ForceModel</guilabel>, but this behavior will change in
    future versions and the user interface is designed to naturally support
    this future development area.</para>

    <para>GMAT currently requires that the primary body is either the same as
    the <guilabel>CentralBody</guilabel> or set to <guilabel>None</guilabel>.
    If you change the <guilabel>CentralBody</guilabel> in the GUI, GMAT
    changes the primary body to <guilabel>None</guilabel>, and you can then
    select between <guilabel>None</guilabel> and the central body. When you
    select a primary body in the GUI, the <guilabel>Gravity</guilabel> and
    <guilabel>Drag</guilabel> fields activate and allow you to select models
    for those forces consistent with the body selected in the
    <guilabel>PrimaryBodies</guilabel> field. For example, if you select Earth
    as the primary body, you can only select Earth drag models in the
    <guilabel>Drag.AtmosphereModel</guilabel> field. See the field list above
    for available models.</para>

    <para><emphasis>Configuring Gravitational Models</emphasis></para>

    <para>GMAT supports point mass gravity, spherical harmonic, and Earth tide
    models. On a <guilabel>Propagator</guilabel>, all celestial bodies are
    classified into two mutually exclusive categories:
    <guilabel>PrimaryBodies</guilabel>, and <guilabel>Point Masses</guilabel>.
    To model a body as a point mass, add it to the
    <guilabel>PointMasses</guilabel> list. GMAT currently requires that there
    be only a single body in the <guilabel>PrimaryBodies</guilabel> list. When
    a primary body is selected, the <guilabel>CentralBody</guilabel> and
    primary body must be the same.</para>

    <para>Bodies modeled as <guilabel>PointMasses</guilabel> use the
    gravitational parameter defined on the body (i.e. Earth.Mu) in the
    equations of motion. Bodies defined as <guilabel>PrimaryBodies</guilabel>
    use the constants defined on the potential file in the equations of
    motion. GMAT supports two gravity file formats: the .cof format and the
    STK .grv format. You can provide a custom potential file for your
    application as long as it is one of the supported formats. Potential files
    defined in the startup file are available in the
    <guilabel>Model</guilabel> list in the GUI. For example, the following
    lines in the startup file configure GMAT so that EGM96 is an available
    option for <guilabel>Model</guilabel> in the GUI when the primary body is
    Earth:</para>

    <programlisting>EARTH_POT_PATH         = DATA_PATH/gravity/earth/
EGM96_FILE             = EARTH_POT_PATH/EGM96.cof </programlisting>

    <para>Below is an example script snippet for configuring a custom gravity
    model including Earth tides.</para>

    <programlisting>Create ForceModel aForceModel;
aForceModel.CentralBody = Earth;
aForceModel.PrimaryBodies = {Earth};
aForceModel.GravityField.Earth.Degree = 21;
aForceModel.GravityField.Earth.Order  = 21;
aForceModel.GravityField.Earth.PotentialFile = 'c:\MyData\File.cof';
aForceModel.GravityField.Earth.EarthTideModel = 'SolidAndPole'; </programlisting>

    <para><emphasis>Configuring Drag Models</emphasis></para>

    <para>GMAT supports many density models for Earth including
    <guilabel>Jacchia-Roberts</guilabel> and various MSISE models. Density
    models for non-Earth bodies -- the Mars-GRAM model for example -- are
    included using custom plug-in components and are currently only supported
    in the script interface.</para>

    <para>To configure Earth density models, select Earth as the primary body,
    In the GUI, this activates the <guilabel>AtmosphereModel </guilabel>list.
    You can configure the solar flux values using the <guilabel>
    Setup</guilabel> button next to the <guilabel>AtmosphereModel</guilabel>
    list after you have selected an atmosphere model. Below is an example
    script snippet for configuring the <guilabel>NRLMSISE00</guilabel> density
    model.</para>

    <programlisting>Create ForceModel aForceModel;
GMAT aForceModel.PrimaryBodies = {Earth};
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00;
GMAT aForceModel.Drag.F107 = 145;
GMAT aForceModel.Drag.F107A = 160;
GMAT aForceModel.Drag.MagneticIndex = 4;
</programlisting>

    <caution>
      <para>Caution: GMAT uses the original single precision FORTAN code
      developed by the scientists who created the MSISE models. At low
      altitudes, the single precision density can cause numeric issues in the
      double precision integrator step size control and integration can be
      unacceptably slow. You can avoid the performance issue by using either
      fixed step integration or by using a relatively high
      <guilabel>Accuracy</guilabel> value such as 1e-8. You may need to
      experiment with the <guilabel>Accuracy</guilabel> setting to a value
      acceptable for your application.</para>
    </caution>

    <para>Note that when you select <guilabel>None</guilabel> for
    <guilabel>Drag.AtmosphereModel </guilabel>, the fields
    <guilabel>Drag.F107</guilabel>, <guilabel>Drag.F107A</guilabel>, and
    <guilabel>Drag.MagneticIndex</guilabel> are inactive and must be removed
    from your script file to avoid parsing errors. When working in the GUI,
    this is performed automatically.</para>

    <para>The table below describes the limits on altitude for drag models
    supported by GMAT.</para>

    <informaltable colsep="0" frame="topbot">
      <tgroup cols="3">
        <colspec colnum="1" colwidth="1.0*"/>

        <colspec colnum="2" colwidth="1.0*"/>

        <colspec colnum="3" colwidth="1.5*"/>

        <thead>
          <row>
            <entry>Model</entry>

            <entry>Theoretical Altitude (h) Limits</entry>

            <entry>Comments</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry><guilabel>MSISE86</guilabel></entry>

            <entry><para>90 &lt; h &lt; 1000</para></entry>

            <entry><para>GMAT will not allow propagation below 90 km
            altitude.</para></entry>
          </row>

          <row>
            <entry><guilabel>MSISE90</guilabel></entry>

            <entry><para>0 &lt; h &lt;1000</para></entry>

            <entry><para>GMAT will allow propagation below 0 km altitude but
            results are non-physical.</para></entry>
          </row>

          <row>
            <entry><guilabel>NRLMSISE00</guilabel></entry>

            <entry>0 &lt; h &lt;1000</entry>

            <entry><para> GMAT will allow propagation below 0 km altitude but
            results are non-physical. </para></entry>
          </row>

          <row>
            <entry><guilabel>JacchiaRoberts</guilabel></entry>

            <entry><para>h &gt; 100</para></entry>

            <entry><para>GMAT will not allow propagation below 100 km
            altitude. </para></entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>

    <para><emphasis>Configuring an SRP Model</emphasis></para>

    <para>GMAT uses a dual cone model to model central body shadowing of the
    spacecraft and models solar radiation pressure using a spherical
    spacecraft model. You can define the solar flux using two approaches which
    are currently only supported in the script interface. One approach is to
    define the flux value using the <guilabel>SRP.Flux</guilabel> field and
    the value of an astronomical unit (in km) using the
    <guilabel>Nominal_Sun</guilabel> field as shown in the following
    example.</para>

    <programlisting>Create ForceModel aForceModel;
GMAT aForceModel.PrimaryBodies = {Earth};
GMAT aForceModel.SRP = On;
GMAT aForceModel.SRP.Flux = 1367;
GMAT aForceModel.SRP.Nominal_Sun = 149597870.691; </programlisting>

    <para>An alternative approach is to define the flux pressure at 1
    astronomical unit using the <guilabel>Flux_Pressure</guilabel> field as
    shown below..</para>

    <programlisting>Create ForceModel aForceModel;
GMAT aForceModel.PrimaryBodies = {Earth};
GMAT aForceModel.SRP = On;
GMAT aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006;
GMAT aForceModel.SRP.Nominal_Sun = 149597870.691; </programlisting>

    <para>If you mix flux settings, as shown in the example below, GMAT will
    use the last approach in the script. Here, GMAT will use the
    <guilabel>Flux_Pressure</guilabel> setting.</para>

    <programlisting>Create ForceModel aForceModel;
GMAT aForceModel.PrimaryBodies = {Earth};
GMAT aForceModel.SRP = On;
GMAT aForceModel.SRP.Flux = 1370;
GMAT aForceModel.SRP.Nominal_Sun = 149597870;
GMAT aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006; </programlisting>

    <caution>
      <para>Caution: GMAT’s default option for configuring solar flux for an
      SRP model is to use <guilabel>SRP.Flux</guilabel> and<guilabel>
      Nominal_Sun</guilabel> fields. If you initially configured the
      <guilabel>Flux_Pressure</guilabel> field, when you save your mission via
      the save button in the toolbar, GMAT will write out
      <guilabel>SRP.Flux</guilabel> and <guilabel>Nominal_Sun</guilabel>
      values consistent with your setting of
      <guilabel>Flux_Pressure</guilabel>.</para>
    </caution>

    <para><emphasis> Variational Equations and the STM </emphasis></para>

    <para>GMAT can optionally propagate the orbit State Transition Matrix
    (STM). For more information on how to configure GMAT to compute the STM,
    see the Propagate command documentation.</para>

    <caution>
      <para>Caution: GMAT allows you to propagate the State Transition Matrix
      (STM) along with the orbital state. However, not all variational terms
      are implemented for STM propagation. The following are implemented:
      point mass perturbation, spherical harmonics (with tide models), and
      solar radiation pressure. The following are NOT implemented: drag and
      relativistic terms, and finite burns. Additionally, the SRP variational
      term does not include the partial derivative of the percent shadow with
      respect to orbital state. This approximation is acceptable for orbits
      with short penumbra durations but is inaccurate for orbits that spend
      relatively long periods of time in penumbra.</para>
    </caution>
  </refsection>

  <refsection>
    <title>Examples</title>

    <informalexample>
      <para>A <guilabel>ForceModel</guilabel> for point mass
      propagation.</para>

      <programlisting><code>Create Spacecraft aSat;

Create ForceModel aForceModel;
aForceModel.CentralBody = Earth;
aForceModel.PointMasses = {Earth};

Create Propagator aProp;
aProp.FM = aForceModel;

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2};</code></programlisting>
    </informalexample>

    <informalexample>
      <para>A <guilabel>ForceModel</guilabel> for high fidelity low Earth
      orbit propagation.</para>

      <programlisting><code>Create Spacecraft aSat;

Create ForceModel aForceModel;
aForceModel.CentralBody = Earth;
aForceModel.PrimaryBodies = {Earth};
aForceModel.PointMasses = {Sun, Luna};
aForceModel.SRP = On;
aForceModel.RelativisticCorrection = On;
aForceModel.ErrorControl = RSSStep;
aForceModel.GravityField.Earth.Degree = 20;
aForceModel.GravityField.Earth.Order = 20;
aForceModel.GravityField.Earth.PotentialFile = 'EGM96.cof';
aForceModel.GravityField.Earth.EarthTideModel = 'None';
aForceModel.Drag.AtmosphereModel = MSISE90;
aForceModel.Drag.F107 = 150;
aForceModel.Drag.F107A = 150;
aForceModel.Drag.MagneticIndex = 3;
aForceModel.SRP.Flux = 1359.388569998901;
aForceModel.SRP.Nominal_Sun = 149597870.691;

Create Propagator aProp;
aProp.FM = aForceModel;

BeginMissionSequence

Propagate aProp(aSat){aSat.ElapsedDays = .2};</code></programlisting>
    </informalexample>

    <informalexample>
      <para>A <guilabel>ForceModel</guilabel> for high fidelity lunar orbit
      propagation.</para>

      <programlisting><code>
Create Spacecraft moonSat;
GMAT moonSat.DateFormat = UTCGregorian;
GMAT moonSat.Epoch.UTCGregorian = 01 Jun 2004 12:00:00.000;
GMAT moonSat.CoordinateSystem = MoonMJ2000Eq;
GMAT moonSat.DisplayStateType = Cartesian;
GMAT moonSat.X = -1486.792117191545200;
GMAT moonSat.Y = 0.0;
GMAT moonSat.Z = 1486.792117191543000;
GMAT moonSat.VX = -0.142927729144255;
GMAT moonSat.VY = -1.631407624437537;
GMAT moonSat.VZ = 0.142927729144255;

Create CoordinateSystem MoonMJ2000Eq
MoonMJ2000Eq.Origin = Luna;
MoonMJ2000Eq.Axes   = MJ2000Eq;

Create ForceModel MoonLP165P;
GMAT MoonLP165P.CentralBody = Luna;
GMAT MoonLP165P.PrimaryBodies = {Luna};
GMAT MoonLP165P.SRP = On;
GMAT MoonLP165P.SRP.Flux = 1367;
GMAT MoonLP165P.SRP.Nominal_Sun = 149597870.691;
GMAT MoonLP165P.Gravity.Luna.PotentialFile = ../data/gravity/luna/LP165P.cof;
GMAT MoonLP165P.Gravity.Luna.Degree = 20;
GMAT MoonLP165P.Gravity.Luna.Order = 20;

Create Propagator RKV89;
GMAT RKV89.FM = MoonLP165P;

BeginMissionSequence

Propagate RKV89(Moon) {moonSat.ElapsedSecs = 300};</code></programlisting>
    </informalexample>
  </refsection>
</refentry>
