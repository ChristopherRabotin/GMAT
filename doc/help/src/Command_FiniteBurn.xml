<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0"
          xml:id="FiniteBurnCommand"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>BeginFiniteBurn</primary>
  </indexterm>
  <indexterm>
    <primary>EndFiniteBurn</primary>
  </indexterm>

  <refmeta>
    <refentrytitle>FiniteBurn</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>

    <refmiscinfo class="version">R2012a</refmiscinfo>

    <refmiscinfo class="manual">Commands</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>FiniteBurn</refname>

    <refpurpose>
      Model finite thrust maneuvers in the mission sequence
    </refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <title>Script Syntax</title>

    <synopsis>
      <literal>BeginFiniteBurn</literal> <replaceable>aFiniteBurn</replaceable>(<replaceable>aSpacecraft</replaceable>)
    </synopsis>

    <synopsis>
      <literal>EndFiniteBurn</literal> <replaceable>aFiniteBurn</replaceable>(<replaceable>aSpacecraft</replaceable>)
    </synopsis>
  </refsynopsisdiv>

  <refsection>
    <title>Description</title>

    <para>
      When you apply a <guilabel>BeginFiniteBurn</guilabel> command, you turn on the thruster configuration given in the specified <guilabel>FiniteBurn</guilabel> model.
      Similarly, when you apply an <guilabel>EndFiniteBurn</guilabel> command, you turn off the thruster configuration in the specified <guilabel>FiniteBurn</guilabel> model.
      After GMAT executes a <guilabel>BeginFiniteBurn</guilabel> command, all propagation for the spacecraft affected by the <guilabel>FiniteBurn</guilabel> object will include the
      configured finite thrust in the dynamics until an <guilabel>EndFiniteBurn</guilabel> line is executed for that configuration.  To apply the <guilabel>BeginFiniteBurn</guilabel> and
      <guilabel>EndFiniteBurn</guilabel> commands, a <guilabel>FiniteBurn</guilabel> object must be configured.  This object requires the configuration of <guilabel>Tank</guilabel> and <guilabel>Thruster</guilabel> models.
      See the Remarks section and the examples below for a more detailed explanation.
    </para>

    <para>
      <phrase role="ref_seealso">See Also</phrase>:
      <xref linkend="Spacecraft"/>,
      <xref linkend="Thruster"/>,
      <!--<xref linkend="Tank"/>,-->
      <xref linkend="FiniteBurn"/>
    </para>
  </refsection>

  <refsection>
    <title>Options</title>

    <informaltable colsep="0"
                   frame="topbot">
      <tgroup cols="2">
        <colspec colnum="1"
                 colwidth=".5*"/>

        <colspec colnum="2"
                 colwidth="3*"/>

        <thead>
          <row>
            <entry>Option</entry>

            <entry>Description</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry>
              <guilabel>BeginFiniteBurn - Burn</guilabel>
            </entry>

            <entry>
              <para>
                The Burn field defines the FiniteBurn object activated by the BeginFiniteBurn command.
              </para>
              <variablelist>
                <varlistentry>
                  <term>Accepted Data Types</term>

                  <listitem>
                    <para>
                      FiniteBurn
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>
                      FiniteBurn Object
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>
                      DefaultFB
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Required</term>

                  <listitem>
                    <para>
                      yes
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>
                      GUI, script
                    </para>
                  </listitem>
                </varlistentry>
              </variablelist>
            </entry>
          </row>

          <row>
            <entry>
              <guilabel>BeginFiniteBurn - SpacecraftList</guilabel>
            </entry>

            <entry>
              <para>
                The Spacecraft list field defines the spacecraft acted upon by the BeginFiniteBurn command.
                Spacecraft listed in SpacecraftList will have thrusters activated according to the configuration of the
                FiniteBurn object defined by the Burn field.
              </para>
              <variablelist>
                <varlistentry>
                  <term>Accepted Data Types</term>

                  <listitem>
                    <para>
                      Spacecraft
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>
                      Spacecraft Objects
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>
                      DefaultSC
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Required</term>

                  <listitem>
                    <para>
                      yes
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>
                      GUI, script
                    </para>
                  </listitem>
                </varlistentry>
              </variablelist>
            </entry>
          </row>

          <row>
            <entry>
              <guilabel>EndFiniteBurn - Burn</guilabel>
            </entry>

            <entry>
              <para>
                The Burn field defines the FiniteBurn object de-activated by the EndFiniteBurn command.
              </para>
              <variablelist>
                <varlistentry>
                  <term>Accepted Data Types</term>

                  <listitem>
                    <para>
                      FiniteBurn
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>
                      FiniteBurn Object
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>
                      DefaultFB
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Required</term>

                  <listitem>
                    <para>
                      yes
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>
                      GUI, script
                    </para>
                  </listitem>
                </varlistentry>
              </variablelist>
            </entry>
          </row>

          <row>
            <entry>
              <guilabel>EndFiniteBurn - SpacecraftList</guilabel>
            </entry>

            <entry>
              <para>
                The Spacecraft list field defines the spacecraft acted upon by the EndFiniteBurn command.
                Spacecraft listed in SpacecraftList will have thrusters de-activated according to the configuration of the
                FiniteBurn object defined by the Burn field.
              </para>
              <variablelist>
                <varlistentry>
                  <term>Accepted Data Types</term>

                  <listitem>
                    <para>
                      Spacecraft
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Allowed Values</term>

                  <listitem>
                    <para>
                      Spacecraft Objects
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Default Value</term>

                  <listitem>
                    <para>
                      DefaultSC
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Required</term>

                  <listitem>
                    <para>
                      yes
                    </para>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term>Interfaces</term>

                  <listitem>
                    <para>
                      GUI, script
                    </para>
                  </listitem>
                </varlistentry>
              </variablelist>
            </entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </refsection>

  <refsection>
    <title>GUI</title>

    <para>
      The BeginFiniteBurn and EndFiniteBurn command dialog boxes allow you to implement a finite burn by specifying which
      finite burn model should be used and which spacecraft the finite burn should be applied to.  The dialog boxes for
      BeginFiniteBurn and EndFiniteBurn are shown below.
    </para>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     contentdepth="100%"
                     fileref="files/images/Command_FiniteBurn_GUI_1.png"
                     scalefit="1"
                     width="100%"/>
        </imageobject>
      </mediaobject>
    </screenshot>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center"
                     contentdepth="100%"
                     fileref="files/images/Command_FiniteBurn_GUI_2.png"
                     scalefit="1"
                     width="100%"/>
        </imageobject>
      </mediaobject>
    </screenshot>

    <para>
      Use the Burn menu to select the FiniteBurn model for the maneuver.  Use the Spacecraft text box to
      select the spacecraft for the finite burn. You can either type the spacecraft name in the Spacecraft text box or
      click the Edit button and select the spacecraft using the ParameterSelectDialog box.
    </para>

    <para>
      If you add a BeginFiniteBurn command or EndFiniteBurn command to the mission sequence, without first
      creating a FiniteBurn object, GMAT will create a default FiniteBurn object called DefaultFB.  However, you
      will need to configure the required Tank and Thruster objects required for a FiniteBurn before you can run the mission.
      See the Remarks section for detailed instructions.
    </para>

  </refsection>

  <refsection>
    <title>Remarks</title>

    <refsection>
      <title>
        Configuring a Finite Burn
      </title>

      <para>
        To use the BeginFiniteBurn and EndFiniteBurn commands in your mission sequence, you must configure a FiniteBurn object
        along with Tank and Thruster objects as shown in the examples below and as described in these steps:
      </para>

      <orderedlist>
        <listitem>
          <para>
            Create and configure a Tank model.
          </para>
        </listitem>
        <listitem>
          <para>
            Create a Thruster model:
          </para>
          <orderedlist>
            <listitem>
              <para>
                Set the parameters (direction, thrust, specific impulse, etc) for the thruster
              </para>
            </listitem>
            <listitem>
              <para>
                Configure the thruster to use the tank created in Step 1.
              </para>
            </listitem>
          </orderedlist>
        </listitem>
        <listitem>
          <para>
            Add the Tank and Thruster created in the previous two steps to the spacecraft.
          </para>
        </listitem>
        <listitem>
          <para>
            Create a FiniteBurn model and configure it to use the Thruster created in Step 2.
          </para>
        </listitem>
      </orderedlist>
    </refsection>

    <refsection>
      <title>Initial Thruster Status</title>

      <para>
        When you configure the spacecraft, tank, thruster, and finite burn objects, GMAT initializes these objects with the thrusters
        turned off, so that no finite burns are active.  You must use the BeginFiniteBurn command to turn on the thruster if you want to
        apply a finite burn during propagation.
      </para>

      <warning>
        <para>
          Caution: If GMAT throws the error message “Propagator Exception: MassFlow is not a known propagation parameter
          on DefaultSC”, then you have not configured all of the required models to perform a finite burn.  See detailed instructions
          above and examples to configure models required by the EndFiniteBurn/BeginFiniteBurn commands.
        </para>
      </warning>
    </refsection>

    <refsection>
      <title>
        BeginFiniteBurn and EndFiniteBurn commands are NOT branch commands
      </title>

      <para>
        The <guilabel>BeginFiniteBurn</guilabel> and <guilabel>EndFiniteBurn</guilabel> commands are NOT branch commands, meaning, a BeginFiniteBurn
        command can exist without an EndFiniteBurn command (however, this may result in depleting all the fuel in the spacecraft model).
        For behavior when fuel mass is fully depleted during a finite burn see the Tank object.
      </para>

      <para>
        Similarly, since the <guilabel>BeginFiniteBurn</guilabel> and <guilabel>EndFiniteBurn</guilabel> commands are used to turn on or off the thrusters, applying the
        same command multiple times in a script without its inverse is the same as applying it once.  In other words, if you do this:
      </para>

      <programlisting>
        <code>
  BeginFiniteBurn aFiniteBurn(aSat)
  BeginFiniteBurn aFiniteBurn(aSat)
  BeginFiniteBurn aFiniteBurn(aSat)
        </code>
      </programlisting>

      <para>
        The effect is the same as only applying the <guilabel>BeginFiniteBurn</guilabel> command one time.
        The same holds true for the <guilabel>EndFiniteBurn</guilabel> command.
      </para>
    </refsection>
  </refsection>

  <refsection>
    <title>Examples</title>

    <informalexample>
      <para>
        Perform a finite burn while the spacecraft is between true anomaly of 300 degrees and 60 degrees.
      </para>

      <programlisting>
        <code>
  %  Create objects
  Create Spacecraft aSat
  Create Thruster aThruster
  Create FuelTank aTank
  Create FiniteBurn aFiniteBurn
  Create Propagator aPropagator

  %  Configure the physical objects
  aSat.Thrusters        = {aThruster}
  aThruster.Tank        = {aTank}
  aSat.Tanks            = {aTank}
  aFiniteBurn.Thrusters = {aThruster}

  BeginMissionSequence

  %  Prop to TA = 300 then maneuver until TA = 60
  Propagate aPropagator(aSat, {aSat.TA = 300})
  BeginFiniteBurn aFiniteBurn(aSat)
  Propagate aPropagator(aSat, {aSat.TA = 60})
  EndFiniteBurn aFiniteBurn(aSat)
        </code>
      </programlisting>
    </informalexample>

    <informalexample>
      <para>
        Perform a velocity direction maneuver firing the thruster for 2 minutes.
      </para>

      <programlisting>
        <code>
  %  Create objects
  Create Spacecraft aSat
  Create Thruster aThruster
  Create FuelTank aTank
  Create FiniteBurn aFiniteBurn
  Create Propagator aPropagator

  %  Configure the physical objects
  aThruster.CoordinateSystem = Local
  aThruster.Origin = Earth
  aThruster.Axes   = VNB
  aThruster.ThrustDirection1 = 1
  aThruster.ThrustDirection2 = 0
  aThruster.ThrustDirection3 = 0

  %  Configure the physical objects
  aSat.Thrusters    	 = {aThruster}
  aThruster.Tank    	 = {aTank}
  aSat.Tanks        	 = {aTank}
  aFiniteBurn.Thrusters = {aThruster}

  BeginMissionSequence

  %  Fire thruster for 2 minutes
  BeginFiniteBurn aFiniteBurn(aSat)
  Propagate aPropagator(aSat, {aSat.ElapsedSecs = 120})
  EndFiniteBurn aFiniteBurn(aSat)
        </code>
      </programlisting>
    </informalexample>
  </refsection>
</refentry>
