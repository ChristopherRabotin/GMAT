<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>Lunar Transfer</title>

  <para>This tutorial was started from the default settings in the June 9,
  2008 build of GMAT.</para>

  <section>
    <title>Objective and Overview</title>

    <para>The primary goal of this mission is for you to learn how to create
    and propagate a transfer trajectory from a LEO (Low Earth Orbit) to a
    lunar orbit. Given the capabilities of GMAT, you will also learn how to
    solve for several initially unknown variables and apply them to give your
    spacecraft a more efficient path to the moon.</para>

    <para>Download the script file:
    [http://gmat.ed-pages.com/wiki/tiki-download_file.php?fileId=34|LunarTransferTutorial.script]</para>

    <section>
      <title>Prerequisites</title>

      <itemizedlist>
        <listitem>
          <para>Basic understanding of Hohmann Transfer trajectories</para>
        </listitem>

        <listitem>
          <para>Tutorials:</para>

          <itemizedlist>
            <listitem>
              <para>((Creating and Propagating a Spacecraft))</para>
            </listitem>

            <listitem>
              <para>((Designing a Hohmann Transfer))</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Mission Description</title>

      <itemizedlist>
        <listitem>
          <para>Objective: Target a lunar transfer trajectory with several
          initially undetermined variables and achieve a given altitude for a
          lunar propagation.</para>
        </listitem>

        <listitem>
          <para>Assume:</para>

          <itemizedlist>
            <listitem>
              <para>Launch site is Kennedy Space Center (INC = 28.5°)</para>
            </listitem>

            <listitem>
              <para>Parking orbit altitude is 185 km (SMA = 6555 km)</para>
            </listitem>

            <listitem>
              <para>Parking orbit is nearly circular (ECC = 0.001)</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Find:</para>

          <itemizedlist>
            <listitem>
              <para>RAAN</para>
            </listitem>

            <listitem>
              <para>AOP</para>
            </listitem>

            <listitem>
              <para>ΔV</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Resource, Mission, and Output trees</title>

      <screenshot>
        <info>
          <title>Figure: Lunar Transfer Resource, Mission, and Output
          trees</title>
        </info>

        <mediaobject>
          <imageobject>
            <imagedata align="center" fileref="???"></imagedata>
          </imageobject>

          <caption>
            <para>Figure: Lunar Transfer Resource, Mission, and Output
            trees</para>
          </caption>
        </mediaobject>
      </screenshot>
    </section>
  </section>

  <section>
    <title>Creating and Configuring the Resource Tree</title>

    <para>For this tutorial, two spacecraft, two impulsive burns, and three
    undetermined variables are needed in order to propagate a viable lunar
    transfer trajectory to a lunar orbit. To realistically account for the
    varying gravitational fields of the sun, earth, and moon, three
    propagators are required. Two OpenGL plots are needed to see how the
    spacecraft and its trajectory would look from an arbitrary point of view
    in space. Finally, an earth-lunar and lunar coordinate system should be
    used to allow for an easier interpretation of how the spacecraft is
    positioned once the moon is the primary body of its propagation.</para>

    <section>
      <title>Objects Required</title>

      <itemizedlist>
        <listitem>
          <para>Spacecraft: InitSat and Sat</para>
        </listitem>

        <listitem>
          <para>Impulsive Burns: TOI (Transfer Orbit Insertion) and LOI (Lunar
          Orbit Insertion)</para>
        </listitem>

        <listitem>
          <para>Propagators: EarthOnlyProp, NearEarthProp, and
          NearMoonProp</para>
        </listitem>

        <listitem>
          <para>Plots/Reports: EarthOGL and EarthMoonOGL</para>
        </listitem>

        <listitem>
          <para>Variables/Arrays/Strings: RAAN, AOP, and ΔV</para>
        </listitem>

        <listitem>
          <para>Coordinate Systems: EarthToMoon and LunaFixed</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Creating and Modifying Objects</title>

      <itemizedlist>
        <listitem>
          <para>Spacecraft</para>

          <itemizedlist>
            <listitem>
              <para>Add a spacecraft to the resource tree and name it
              Sat</para>
            </listitem>

            <listitem>
              <para>Set the epoch format to UTCGregorian</para>
            </listitem>

            <listitem>
              <para>Use Keplerian as the State Type for the coordinate
              system</para>
            </listitem>

            <listitem>
              <para>See Assumptions to modify spacecraft element
              properties</para>
            </listitem>

            <listitem>
              <para>Clone Sat and rename it InitSat</para>
            </listitem>
          </itemizedlist>

          <para>Script Syntax:</para>

          <programlisting><code>Create Spacecraft Sat;
GMAT Sat.DateFormat = UTCGregorian;
GMAT Sat.DisplayStateType = Keplerian;
GMAT Sat.SMA = 6554.999999999999;
GMAT Sat.ECC = 0.0009999999999997056;
GMAT Sat.INC = 28.50000000000001;
Create Spacecraft InitSat;</code></programlisting>

          <screenshot>
            <info>
              <title>Figure: Sat Spacecraft Object</title>
            </info>

            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="???"></imagedata>
              </imageobject>

              <caption>
                <para>Figure: Sat Spacecraft Object</para>
              </caption>
            </mediaobject>
          </screenshot>
        </listitem>

        <listitem>
          <para>Propagators</para>

          <itemizedlist>
            <listitem>
              <para>EarthOnly:</para>

              <itemizedlist>
                <listitem>
                  <para>Include only a heliocentric pointmass</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create ForceModel EarthOnly_ForceModel;
GMAT EarthOnly_ForceModel.PointMasses = {Sun};

Create Propagator EarthOnly;</code></programlisting>

              <screenshot>
                <info>
                  <title>Figure: NearEarthProp Propagator Object</title>
                </info>

                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="???"></imagedata>
                  </imageobject>

                  <caption>
                    <para>Figure: NearEarthProp Propagator Object</para>
                  </caption>
                </mediaobject>
              </screenshot>
            </listitem>

            <listitem>
              <para>NearEarthProp:</para>

              <itemizedlist>
                <listitem>
                  <para>Include heliocentric and lunar point masses</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create ForceModel NearEarthProp_ForceModel;
GMAT NearEarthProp_ForceModel.PointMasses = {Sun, Luna};

Create Propagator NearEarthProp;
GMAT NearEarthProp.FM = NearEarthProp_ForceModel;</code></programlisting>
            </listitem>

            <listitem>
              <para>NearMoonProp:</para>

              <itemizedlist>
                <listitem>
                  <para>Use the moon as the only Primary Body</para>
                </listitem>

                <listitem>
                  <para>Change the gravity model to LP-165 with a degree and
                  order of 4</para>
                </listitem>

                <listitem>
                  <para>Include geocentric and heliocentric point
                  masses</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create ForceModel NearMoonProp_ForceModel;
GMAT NearMoonProp_ForceModel.CentralBody = Luna;
GMAT NearMoonProp_ForceModel.PrimaryBodies = {Luna};
GMAT NearMoonProp_ForceModel.PointMasses = {Sun, Earth};
GMAT NearMoonProp_ForceModel.GravityField.Luna.PotentialFile = 
'LP165P.cof';

Create Propagator NearMoonProp;
GMAT NearMoonProp.FM = NearMoonProp_ForceModel;</code></programlisting>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Burns</para>

          <itemizedlist>
            <listitem>
              <para>TOI:</para>

              <itemizedlist>
                <listitem>
                  <para>Change V to be 2 km/s</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create ImpulsiveBurn TOI;
GMAT TOI.Element1 = 2;</code></programlisting>

              <screenshot>
                <info>
                  <title>Figure: TOI Impulsive Burn Object</title>
                </info>

                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="???"></imagedata>
                  </imageobject>

                  <caption>
                    <para>Figure: TOI Impulsive Burn Object</para>
                  </caption>
                </mediaobject>
              </screenshot>
            </listitem>

            <listitem>
              <para>LOI:</para>

              <para>Script Syntax:</para>

              <programlisting><code>Create ImpulsiveBurn LOI;</code></programlisting>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Variables/Arrays/Strings</para>

          <itemizedlist>
            <listitem>
              <para>Add three variables to the resource tree and name them
              RAAN, AOP, and ΔV</para>
            </listitem>

            <listitem>
              <para>Set each equal to zero and to the Sat spacecraft</para>
            </listitem>
          </itemizedlist>

          <para>Script Syntax:</para>

          <programlisting><code>Create Variable RAAN AOP V;</code></programlisting>

          <screenshot>
            <info>
              <title>Figure: RAAN Variable Object</title>
            </info>

            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="???"></imagedata>
              </imageobject>

              <caption>
                <para>Figure: RAAN Variable Object</para>
              </caption>
            </mediaobject>
          </screenshot>
        </listitem>

        <listitem>
          <para>Coordinate Systems</para>

          <itemizedlist>
            <listitem>
              <para>Add a new system to the resource tree and rename it
              EarthToMoon</para>
            </listitem>

            <listitem>
              <para>Change the origin to be the moon</para>
            </listitem>

            <listitem>
              <para>Set the Axes Type to ObjectReferenced</para>
            </listitem>

            <listitem>
              <para>Set the moon to be the primary body and the earth to be
              the secondary body</para>
            </listitem>
          </itemizedlist>

          <para>Script Syntax:</para>

          <programlisting><code>Create CoordinateSystem EarthMoonRot;
GMAT EarthMoonRot.Origin = Luna;
GMAT EarthMoonRot.Axes = ObjectReferenced;
GMAT EarthMoonRot.Primary = Luna;
GMAT EarthMoonRot.Secondary = Earth;</code></programlisting>

          <screenshot>
            <info>
              <title>Figure: EarthMoonRot Coordinate System Object</title>
            </info>

            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="???"></imagedata>
              </imageobject>

              <caption>
                <para>Figure: EarthMoonRot Coordinate System Object</para>
              </caption>
            </mediaobject>
          </screenshot>
        </listitem>

        <listitem>
          <para>Plots/Reports</para>

          <itemizedlist>
            <listitem>
              <para>EarthOGL:</para>

              <itemizedlist>
                <listitem>
                  <para>Add Luna to the Selected Celestial Objects
                  field</para>
                </listitem>

                <listitem>
                  <para>Use a View Scale Factor of 15</para>
                </listitem>

                <listitem>
                  <para>Select X as View Up Definition Axis</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create OpenGLPlot EarthOGL;
GMAT EarthOGL.Add = {Sat, Earth, Luna};
GMAT EarthOGL.ViewScaleFactor = 15;
GMAT EarthOGL.ViewUpAxis = X;</code></programlisting>

              <screenshot>
                <info>
                  <title>Figure: EarthOGL OpenGL Plot Object</title>
                </info>

                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="???"></imagedata>
                  </imageobject>

                  <caption>
                    <para>Figure: EarthOGL OpenGL Plot Object</para>
                  </caption>
                </mediaobject>
              </screenshot>
            </listitem>

            <listitem>
              <para>EarthMoonOGL:</para>

              <itemizedlist>
                <listitem>
                  <para>Add Luna to the Selected Celestial Objects
                  field</para>
                </listitem>

                <listitem>
                  <para>Change the coordinate system in the View Definition
                  and View Up Definition group boxes to be EarthToMoon</para>
                </listitem>

                <listitem>
                  <para>Select Luna as the View Point Reference and View
                  Direction body from those drop down menus</para>
                </listitem>
              </itemizedlist>

              <para>Script Syntax:</para>

              <programlisting><code>Create OpenGLPlot EarthMoonOGL;
GMAT EarthMoonOGL.Add = {Sat, Luna, Earth};
GMAT EarthMoonOGL.ViewDirection = Luna;
GMAT EarthMoonOGL.ViewUpAxis = Z;
GMAT EarthMoonOGL.ViewPointReference = Earth;
GMAT EarthMoonOGL.CoordinateSystem = EarthMJ2000Eq;
GMAT EarthMoonOGL.ViewUpCoordinateSystem = EarthMJ2000Eq;</code></programlisting>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>
  </section>

  <section>
    <title>Creating and Configuring the Mission Sequence</title>

    <para>[tiki-index.php?page=Lunar+Transfer+Tutorial#_b_Resource_Mission_and_Output_trees_b_|Resource
    Mission and Output trees]</para>

    <para>This mission calls three targeting sequences to accomplish the
    mission, which are explained below. The goal of the mission is to vary
    three unknowns, achieve them, and successfully transfer into a lunar,
    polar, circular orbit. To achieve a polar orbit we will use what is known
    as B-Plane Targeting to define how we want the orbit to be oriented.
    Setting the BdotT variable to zero says our spacecraft will orbit over the
    lunar poles. If the orbit was to be equatorial we would simply replace
    BdotT with a BdotR of zero. (Note: If the dot product of B and T vectors
    is unfamiliar to you, Analytical Graphics Inc., makers of STK, has a good
    website
    [https://www.analyticalgraphics.com/resources/help/stk613/helpSystem/extfile/gator/eq-bplane.htm|explaining]
    it).</para>

    <itemizedlist>
      <listitem>
        <para>The Target 1 Sequence solves for three specified variables (in
        this case RAAN, AOP, and ΔV) by appling the first impulsive burn to
        get the spacecraft to exit its parking orbit and enter a lunar
        transfer trajectory. The spacecraft is told to propagate from the
        parking orbit's apoapsis to initiate the sequence.</para>
      </listitem>

      <listitem>
        <para>The Target 2 Sequence calls the values achieved in Target 1 to
        use them as a good initial guess to converge onto a viable lunar
        transfer trajectory, which is why we needed a second spacecraft.
        InitSat uses those achieved values and sets them equal to three new
        Vary commands. These new commands wish to achieve a lunar altitude and
        BdotT, calling for a definite type of lunar orbit. Also, in order to
        make things more realistic, two Propagates are added to slowly
        progress from one dominant gravitational field into another when
        approaching the moon.</para>
      </listitem>

      <listitem>
        <para>The Target 3 Sequence utilizes the second impulsive burn to slow
        the spacecraft in its velocity direction to achieve a circular
        eccentricity, and a polar, lunar orbit. This sequence states occurs at
        lunar apoapsis.</para>
      </listitem>
    </itemizedlist>

    <section>
      <title>Creating and Modifying Sequences</title>

      <section>
        <title>Target 1 Sequence</title>

        <itemizedlist>
          <listitem>
            <para>Target 1:</para>

            <itemizedlist>
              <listitem>
                <para>Vary 1:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the first Variable to Element1 using the TOI
                    impulsive burn</para>
                  </listitem>

                  <listitem>
                    <para>Set the Initial Value parameter equal to 3.15
                    km/s</para>
                  </listitem>

                  <listitem>
                    <para>Define the Lower (Limit) to be 3.05 km/s</para>
                  </listitem>

                  <listitem>
                    <para>Define the Upper (Limit) to 3.25 km/s</para>
                  </listitem>

                  <listitem>
                    <para>Change the Max Step to 0.01 km/s</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Vary 2:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the second Variable to AOP</para>
                  </listitem>

                  <listitem>
                    <para>Use an Initial Value of 0°</para>
                  </listitem>

                  <listitem>
                    <para>Change the Perturbation field to 0.2</para>
                  </listitem>

                  <listitem>
                    <para>Change the Max Step to 15°</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Vary 3:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the third Variable to RAAN</para>
                  </listitem>

                  <listitem>
                    <para>Set the Initial Value equal to 320°</para>
                  </listitem>

                  <listitem>
                    <para>Change the Perturbation to 0.2</para>
                  </listitem>

                  <listitem>
                    <para>Change the Max Step to 15°</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Maneuver 1: utilize the TOI impulsive burn</para>
              </listitem>

              <listitem>
                <para>Propagate 1: set the Stopping Condition parameter to
                earth's apoapsis</para>
              </listitem>

              <listitem>
                <para>Achieve 1:</para>

                <itemizedlist>
                  <listitem>
                    <para>Goal:</para>

                    <itemizedlist>
                      <listitem>
                        <para>Highlight Sat in Object List menu</para>
                      </listitem>

                      <listitem>
                        <para>Select the EarthToMoon coordinate system from
                        the drop down menu</para>
                      </listitem>

                      <listitem>
                        <para>Add X to the Selected Value(s) field</para>
                      </listitem>

                      <listitem>
                        <para>Change the Value field to be 16000 km</para>
                      </listitem>
                    </itemizedlist>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Achieve 2:</para>

                <itemizedlist>
                  <listitem>
                    <para>Goal:</para>

                    <itemizedlist>
                      <listitem>
                        <para>Highlight Sat in Object List menu</para>
                      </listitem>

                      <listitem>
                        <para>Select the MarsMJ2000Eq coordinate system from
                        the drop down menu</para>
                      </listitem>

                      <listitem>
                        <para>Add Y in to the Selected Value(s) field</para>
                      </listitem>

                      <listitem>
                        <para>Change the Value field to be 0 km</para>
                      </listitem>
                    </itemizedlist>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Achieve 3:</para>

                <itemizedlist>
                  <listitem>
                    <para>Goal:</para>

                    <itemizedlist>
                      <listitem>
                        <para>Highlight Sat in Object List menu</para>
                      </listitem>

                      <listitem>
                        <para>Select the MarsMJ2000Eq coordinate system from
                        the drop down menu</para>
                      </listitem>

                      <listitem>
                        <para>Add Z in to the Selected Value(s) field</para>
                      </listitem>

                      <listitem>
                        <para>Change the Value field to be 0 km</para>
                      </listitem>
                    </itemizedlist>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <para>Script Syntax:</para>

        <programlisting><code>GMAT InitSat = Sat;
Target DC1;
   Vary DC1(Sat.RAAN = 270, {Perturbation = .01, MaxStep = 15, Lower = -5360, Upper = 5360});
   Vary DC1(Sat.AOP = 0, {Perturbation = .01, MaxStep = 15, Lower = -5360, Upper = 5360});
   Vary DC1(TOI.Element1 = 3.1, {Perturbation = 0.00001, MaxStep = 0.005, Lower = 3.05, Upper = 3.25});
   Maneuver TOI(Sat);
   Propagate EarthOnly(Sat) {Sat.Earth.Apoapsis};
   Achieve DC1(Sat.EarthMoonRot.X = 10000, {Tolerance = 1});
   Achieve DC1(Sat.EarthMoonRot.Y = 0, {Tolerance = 1});
   Achieve DC1(Sat.EarthMoonRot.Z = 0, {Tolerance = 1});
EndTarget;</code></programlisting>

        <screenshot>
          <info>
            <title>Figure: Target1 Target Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Target1 Target Command</para>
            </caption>
          </mediaobject>
        </screenshot>

        <screenshot>
          <info>
            <title>Figure: Vary1 Vary Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Vary1 Vary Command</para>
            </caption>
          </mediaobject>
        </screenshot>

        <screenshot>
          <info>
            <title>Figure: Maneuver1 Maneuver Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Maneuver1 Maneuver Command</para>
            </caption>
          </mediaobject>
        </screenshot>

        <screenshot>
          <info>
            <title>Figure: Propagate1 Propagate Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Propagate1 Propagate Command</para>
            </caption>
          </mediaobject>
        </screenshot>

        <screenshot>
          <info>
            <title>Figure: Achieve1 Achieve Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Achieve1 Achieve Command</para>
            </caption>
          </mediaobject>
        </screenshot>

        <itemizedlist>
          <listitem>
            <para>Equation 1: set Sat.RAAN = RAAN</para>
          </listitem>

          <listitem>
            <para>Equation 2: set Sat.AOP = AOP</para>
          </listitem>

          <listitem>
            <para>Equation 3: set Sat = InitSat</para>
          </listitem>
        </itemizedlist>

        <para>Script Syntax:</para>

        <programlisting><code>GMAT Sat.RAAN = RAAN;
GMAT Sat.AOP = AOP;
GMAT Sat = InitSat;</code></programlisting>

        <screenshot>
          <info>
            <title>Figure: Equation1 Equation Command</title>
          </info>

          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="???"></imagedata>
            </imageobject>

            <caption>
              <para>Figure: Equation1 Equation Command</para>
            </caption>
          </mediaobject>
        </screenshot>
      </section>

      <section>
        <title>Target 2 Sequence</title>

        <itemizedlist>
          <listitem>
            <para>Target 2:</para>

            <itemizedlist>
              <listitem>
                <para>Vary 4:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the first Variable to Element 1 using TOI
                    impulsive burn</para>
                  </listitem>

                  <listitem>
                    <para>Set the Initial Value to TOI.Element1</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Vary 5:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the second Variable to AOP</para>
                  </listitem>

                  <listitem>
                    <para>Set the Initial Value to AOP</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Vary 6:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the third Variable to RAAN</para>
                  </listitem>

                  <listitem>
                    <para>Set the Initial Value to RAAN</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Maneuver 2: utilize the TOI impulsive burn</para>
              </listitem>

              <listitem>
                <para>Set the stopping condition parameter to be 2 days for
                Sat in Propagate 2</para>
              </listitem>

              <listitem>
                <para>Set the stopping condition parameter to be lunar
                periapsis in Propagate 3</para>
              </listitem>

              <listitem>
                <para>Achieve 4:</para>

                <itemizedlist>
                  <listitem>
                    <para>Goal:</para>

                    <itemizedlist>
                      <listitem>
                        <para>Use Lunar altitude</para>
                      </listitem>

                      <listitem>
                        <para>Set the Altitude to 300 km</para>
                      </listitem>

                      <listitem>
                        <para>Use a Tolerance of 1.0 km</para>
                      </listitem>
                    </itemizedlist>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Achieve 5:</para>

                <itemizedlist>
                  <listitem>
                    <para>Define the Goal as BdotT using the EarthToMoon
                    coordinate system</para>

                    <itemizedlist>
                      <listitem>
                        <para>Use a BdotT of 0.0 km</para>
                      </listitem>

                      <listitem>
                        <para>Use a Tolerance of 1.0 km</para>
                      </listitem>
                    </itemizedlist>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <para>Script Syntax:</para>

        <programlisting><code>GMAT Sat = InitSat;	
GMAT RAAN = Sat.RAAN;
GMAT AOP = Sat.AOP;

Target DefaultDC;
   Vary DefaultDC(TOI.Element1 = TOI.Element1, {Perturbation = 0.0001, MaxStep = 0.2, Lower = -9.999999e300, Upper = 
      9.999999e300});
   Vary DefaultDC(Sat.AOP = AOP, {Perturbation = 0.1, MaxStep = 15} 

   Vary DefaultDC(Sat.RAAN = RAAN, {Perturbation = 0.1, MaxStep = 15} 
   Maneuver TOI(Sat);
   Propagate EarthMoonProp(Sat) {Sat.ElapsedDays = 2.0};
   Propagate MoonProp(Sat) {Sat.Luna.Periapsis};
   Achieve DefaultDC(Sat.Luna.Altitude = 300, {Tolerance = 1.0});
   Achieve DefaultDC(Sat.EarthToMoon.BdotT = 0.0, {Tolerance = 1.0});
EndTarget;</code></programlisting>
      </section>

      <section>
        <title>Target 3 Sequence</title>

        <itemizedlist>
          <listitem>
            <para>Target 3:</para>

            <itemizedlist>
              <listitem>
                <para>Vary 7:</para>

                <itemizedlist>
                  <listitem>
                    <para>Set the Variable to V using LOI impulsive
                    burn</para>
                  </listitem>

                  <listitem>
                    <para>Use an Initial Value of - 0.5 km/s</para>
                  </listitem>

                  <listitem>
                    <para>Define the Lower (Limit) to be - 4 km/s</para>
                  </listitem>

                  <listitem>
                    <para>Define the (Limit) to be 3.14 km/s</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para>Maneuver 3: utilize the LOI impulsive burn</para>
              </listitem>

              <listitem>
                <para>Propagate 4: change the Stopping Condition parameter to
                be lunar apoapsis</para>
              </listitem>

              <listitem>
                <para>Achieve 6:</para>

                <itemizedlist>
                  <listitem>
                    <para>Change the Goal to reach a lunar eccentricity</para>
                  </listitem>

                  <listitem>
                    <para>Change the eccentricity Value to be equal to
                    zero</para>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <para>Script Syntax:</para>

        <programlisting><code>Target DC1;
   Vary DC1(LOI.Element1 = 0.5, {Perturbation = 0.0001, MaxStep = 0.2, Lower = -4, Upper = 3.14159});
   Maneuver LOI(Sat);
   Propagate NearMoonProp(Sat) {Sat.Luna.Apoapsis};
   Achieve DC1(Sat.Luna.Altitude = 300, {Tolerance = 1});
   Achieve DC1(Sat.Luna.ECC = 0, {Tolerance = 0.1});
EndTarget;
Propagate NearMoonProp(Sat) {Sat.ElapsedDays = 2};
Propagate MoonProp(Sat) {Sat.ElapsedDays = 2.0};</code></programlisting>
      </section>
    </section>
  </section>

  <section>
    <title>Running the Mission</title>

    <para>[tiki-index.php?page=Lunar+Transfer+Tutorial#_b_Resource_Mission_and_Output_trees_b_|Resource
    Mission and Output trees]</para>

    <para>You have now configured the mission, and it is time to run it and
    see the results. First, save the changes you've made and then click the
    green arrow on the tool bar to run the mission. The screen capture below
    summarizes what you should see after correctly completing this
    tutorial.</para>

    <screenshot>
      <info>
        <title>Figure: Output</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="???"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Output</para>
        </caption>
      </mediaobject>
    </screenshot>
  </section>
</chapter>
