<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0" xml:id="Propagator"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>Propagator</primary>
  </indexterm>

  <refmeta>
    <refentrytitle>Propagator</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>



    <refmiscinfo class="manual">Resources</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>Propagator</refname>

    <refpurpose>A propagator models spacecraft motion.</refpurpose>
  </refnamediv>

  <refsection>
    <title>Overview of Propagator Components</title>

    <para>A <guilabel>Propagator</guilabel> is the GMAT component used to
    model spacecraft motion. GMAT contains two types of propagators: a
    numerical integrator type, and an ephemeris type. When using a numerical
    integrator type <guilabel>Propagator</guilabel>, you can choose among a
    suite of numerical integrators implementing Runge-Kutta and predictor
    corrector methods. Numeric <guilabel>Propagators</guilabel> also require a
    <guilabel>ForceModel</guilabel>. Additionally, you can configure a
    <guilabel>Propagator</guilabel> to use SPICE kernels for
    propopagation.</para>

    <para>GMAT's documentation for <guilabel>Propagator</guilabel> components
    is broken down into three sections:</para>

    <itemizedlist>
      <listitem>
        <para>For numerical <guilabel>Propagator</guilabel> documentation see
        <xref linkend="Propagator_NumericalPropagator"
        xrefstyle="select:title"/></para>
      </listitem>

      <listitem>
        <para>For <guilabel>ForceModel</guilabel> documentation see <xref
        linkend="Propagator_ForceModel" xrefstyle="select:title"/></para>
      </listitem>

      <listitem>
        <para>For SPICE <guilabel>Propagator</guilabel> documentation see
        <xref linkend="Propagator_SPKPropagator"
        xrefstyle="select:title"/></para>
      </listitem>
    </itemizedlist>

    <para><phrase role="ref_seealso">See Also</phrase>: <xref
    linkend="Spacecraft"/>, <xref linkend="Propagate"/></para>
  </refsection>

  <refsection xml:id="Propagator_NumericalPropagator">
    <title>Numerical Propagator</title>

    <indexterm>
      <primary>Numerical Integrator</primary>
    </indexterm>

    <refsection>
      <title>Overview</title>

      <para>A <guilabel>Propagator</guilabel> object that uses a numerical
      integrator (as opposed to an ephemeris propagator) is one of a few
      objects in GMAT that is configured differently in the scripting and in
      the GUI. In the GUI, you configure the integrator and force model
      setting on the same dialog box. See the <xref
      linkend="Propagator_Numeric_Remarks" xrefstyle="select:title"/> section
      below for detailed discussion of GMAT’s numerical integrators as well as
      performance and accuracy comparisons, and usage recommendations.</para>

      <para>When working in the script, you must create a
      <guilabel>ForceModel</guilabel> object separately from the
      <guilabel>Propagator</guilabel> and specify the force model using the
      “<guilabel>FM</guilabel>” field on the propagator object. See the <xref
      linkend="Propagator_Numeric_Examples" xrefstyle="select:title"/> section
      later in this section for details.</para>
    </refsection>

    <refsection>
      <title>Options</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><literal>Accuracy</literal></entry>

              <entry><para>The desired accuracy for an integration step. GMAT
              uses the method selected in the
              <guibutton>ErrorControl</guibutton> field on the Force Model to
              determine a metric of the integration accuracy. For each step,
              the integrator ensures that the error in accuracy is smaller
              than the value defined by the
              <guibutton>ErrorControl</guibutton> metric.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND Real &lt; 1</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-11 except for ABM integrator which is
                      1e-10</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>FM</guilabel></entry>

              <entry><para>Identifies the force model used by an integrator.
              If no force model is provided, GMAT uses an Earth centered
              propagator with a 4x4 gravity model.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>ForceModel</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>InitialStepSize</guilabel></entry>

              <entry><para>The size of the first step attempted by the
              integrator. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0.0001</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>60</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>sec.</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>LowerError</guilabel></entry>

              <entry><para>The lower bound on integration error, used to
              determine when to make the step size larger. Applies only to
              <guilabel>AdamsBashforthMoulton</guilabel>
              integrator.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND 0 &lt;
                      <guilabel>LowerError</guilabel>
                      &lt;<guilabel>TargetError</guilabel> &lt;
                      <guilabel>Accuracy</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-13</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MaxStep</guilabel></entry>

              <entry><para>The maximum allowable step
              size.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND <guilabel>MinStep</guilabel> &lt;=
                      <guilabel>MaxStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>2700</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MaxStepAttempts</guilabel></entry>

              <entry><para>The number of attempts the integrator takes to meet
              the tolerance defined by the <guibutton>Accuracy</guibutton>
              field.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Integer &gt;= 1</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>50</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MinStep</guilabel></entry>

              <entry><para>The minimum allowable step size.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND <guibutton>MinStep</guibutton>
                      &lt;= <guibutton>MaxStep</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>0.001</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>sec.</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>StopIfAccuracy-IsViolated</guilabel></entry>

              <entry><para>Flag to stop propagation if integration error value
              defined by <guilabel>Accuracy</guilabel> is not
              satisfied.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Boolean</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>true, false</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>true</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>TargetError</guilabel></entry>

              <entry><para>The nominal bound on integration error, used to set
              the target integration accuracy when adjusting step size.
              Applies only to <guilabel>AdamsBashforthMoulton</guilabel>
              integrator.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND 0 &lt;
                      <guilabel>LowerError</guilabel> &lt;
                      <guilabel>TargetError</guilabel> &lt;
                      <guilabel>Accuracy</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-11</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Type</guilabel></entry>

              <entry><para>Specifies the integrator or analytic propagator
              used to model the time evolution of spacecraft motion.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guibutton>PrinceDormand78</guibutton>,
                      <guibutton>PrinceDormand45</guibutton>,
                      <guibutton>RungeKutta89</guibutton>,<guibutton>RungeKutta68</guibutton>,
                      <guibutton>RungeKutta56</guibutton>,
                      <guibutton>AdamsBashforthMoulton, SPK</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guibutton>RungeKutta89</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Resource_NumericalIntegrators_GUI_1.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para>Settings for the embedded Runge-Kutta integrators. Select the
      desired integrator from the <guilabel>Type</guilabel> menu.</para>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Resource_NumericalIntegrators_GUI_2.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para>The Adams-Bashforth-Moulton integrator has additional settings as
      shown.</para>
    </refsection>

    <refsection xml:id="Propagator_Numeric_Remarks">
      <title>Remarks</title>

      <para><emphasis>Best Practices for Using Numerical
      Integrators</emphasis></para>

      <para>The comparison data presented in a later section suggest that the
      <guilabel>PrinceDormand78</guilabel> integrator is the best all purpose
      integrator in GMAT. When in doubt, use the
      <guilabel>PrinceDormance78</guilabel> integrator, and set
      <guilabel>MinStep</guilabel> to zero so that the integrator’s adaptive
      step algorithm controls the minimum integration step size. Below are
      some important comments on GMAT’s step size control algorithms and the
      dangers of using a non-zero value for the minimum integration step size.
      The <guilabel>AdamsBashforthMoulton</guilabel> integrator is a low order
      integrator and we only recommend its use for low precision analysis when
      a predictor-corrector algorithm is required. We recommend that you study
      the performance and accuracy analysis documented later in this section
      to select a numerical integrator for your application. You may need to
      perform further analysis and comparisons for your application.</para>

      <caution>
        <para>Caution: GMAT’s default error computation mode is
        <guilabel>RSStep</guilabel> and this is a more stringent error control
        method than <guilabel>RSSState</guilabel> that is often used as the
        default in other software such as STK. If you set Accuracy to a very
        small number, 1e-13 for example, and leave
        <guilabel>ErrorControl</guilabel> set to <guilabel>RSSStep</guilabel>,
        integrator performance will be poor, for little if any improvement in
        the accuracy of the orbit integration. To find the best balance
        between integration accuracy and performance, we recommend you
        experiment with the accuracy setting for your selected integrator for
        your application. You can start with a relatively high setting of
        <guilabel>Accuracy</guilabel>, say 1e-9, and lower the accuracy by an
        order of magnitude at a time and compare the final orbital states to
        determine where smaller values of <guilabel>Accuracy</guilabel> result
        in longer propagation times without providing more accurate orbital
        solutions.</para>
      </caution>

      <caution>
        <para>Caution: GMAT allows you to set a minimum step on numerical
        integrators. It is possible that the requested
        <guilabel>Accuracy</guilabel> cannot be achieved given the
        <guilabel>MinimumStep</guilabel> setting. The
        <guilabel>Propagator</guilabel> flag
        <guilabel>StopIfAccuracyIsViolated</guilabel> determines the behavior
        if <guilabel>Accuracy</guilabel> cannot be satisfied. If
        <guilabel>StopIfAccuracyIsViolated</guilabel> is true, GMAT will throw
        an error and stop execution if integration accuracy is not satisfied.
        If <guilabel>StopIfAccuracyIsViolated</guilabel> is false, GMAT will
        only throw a warning that the integration accuracy was not satisfied
        but will continue to propagate the orbit.</para>
      </caution>

      <para><emphasis>Numerical Integrators Overview</emphasis></para>

      <para>The table below describes each numerical integrator in
      detail.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.5*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>RungeKutta89</guilabel></entry>

              <entry><para>An adaptive step, ninth order Runge-Kutta
              integrator with eighth order error control. The coefficients
              were derived by J. Verner. Verner developed several sets of
              coefficients for an 89 integrator and we have chosen the
              coefficients that are the most robust but not necessarily the
              most efficient.</para></entry>
            </row>

            <row>
              <entry><guilabel>PrinceDormand78</guilabel></entry>

              <entry><para>An adaptive step, eighth order Runge-Kutta
              integrator with seventh order error control. The coefficients
              were derived by Prince and Dormand.</para></entry>
            </row>

            <row>
              <entry><guilabel>PrinceDormand45</guilabel></entry>

              <entry>An adaptive step, fifth order Runge-Kutta integrator with
              fourth order error control. The coefficients were derived by
              Prince and Dormand.</entry>
            </row>

            <row>
              <entry><guilabel>RungeKutta68</guilabel></entry>

              <entry><para>A second order Runge-Kutta-Nystrom type integrator
              with coefficients developed by by Dormand, El-Mikkawy and
              Prince. The integrator is a 9-stage Nystrom integrator, with
              error control on both the dependent variables and their
              derivatives. This second order implementation will correctly
              integrate forces that are non-conservative but it is not
              recommended for this use. See the integrator comparisons below
              for numerical comparisons. You cannot use this integrator to
              integrate mass during a finite maneuver because the mass flow
              rate is a first order differential equation not supported by
              this integrator.</para></entry>
            </row>

            <row>
              <entry><guilabel>RungeKutta56</guilabel></entry>

              <entry><para>An adaptive step, sixth order Runge-Kutta
              integrator with fifth order error control. The coefficients were
              derived by E. Fehlberg.</para></entry>
            </row>

            <row>
              <entry><guilabel>AdamsBashforthMoulton</guilabel></entry>

              <entry><para>A fourth-order Adams-Bashford predictor /
              Adams-Moulton corrector as described in Fundamentals of
              Astrodynamics by Bate, Mueller, and White. The predictor step
              extrapolates the next state of the variables using the the
              derivative information at the current state and three previous
              states of the variables. The corrector uses derivative
              information evaluated for this state, along with the derivative
              information at the original state and two preceding states, to
              tune this state, giving the final, corrected state. The ABM
              integrator uses the RungeKutta89 integrator to start the
              integration process. The ABM is a low order integrator and
              should not be used for precise applications or for highly
              nonlinear applications such as celestial body
              flybys.</para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para><emphasis>Performance &amp; Accuracy Comparison of Numerical
      Integrators</emphasis></para>

      <para>The tables below contain performance comparison data for GMAT's
      numerical integrators. The first table shows the orbit types, dynamics
      models, and propagation duration for each test case included in the
      comparison. Five orbit types were compared: low earth orbit, Molniya,
      Mars transfer (Type 2), Lunar transfer, and finite burn (case 1 is blow
      down, and case 2 is pressure regulated). For each test case, the orbit
      was propagated forward for a duration and then back-propagated to the
      intial epoch. The error values in the table are the RSS difference of
      the final position after forward and backward propagation to the initial
      position. The run time data for each orbit type is normalized on the
      integrator with the fasted run time for that orbit type. For all test
      cases the <guilabel>ErrorControl</guilabel> setting was set to
      <guilabel>RSSStep</guilabel>. <guilabel>Accuracy</guilabel> was set to
      1e-12 for all integrators except for
      <guilabel>AdamsBashfourthMoulton</guilabel> which was set to 1e-11
      because of poor performance when <guilabel>Accuracy</guilabel> was set
      to 1e-11.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="1.5*"/>

          <colspec colnum="3" colwidth="0.75*"/>

          <thead>
            <row>
              <entry>Orbit</entry>

              <entry>Dynamics Model</entry>

              <entry>Duration</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>LEO</guilabel></entry>

              <entry><para>Earth 20x20, Sun, Moon, drag using MSISE90 density,
              SRP </para></entry>

              <entry><para> 1 day </para></entry>
            </row>

            <row>
              <entry><guilabel>Molniya</guilabel></entry>

              <entry><para>Earth 20x20, Sun, Moon, drag using Jacchia Roberts
              density, SRP </para></entry>

              <entry><para> 3 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Mars Transfer</guilabel></entry>

              <entry><para>Near Earth: Earth 8x8, Sun, Moon,
              SRP</para><para>Deep Space: All planets as point mass
              perturbations</para><para>Near Mars: Mars 8x8 SRP</para></entry>

              <entry><para> 333 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Lunar Transfer</guilabel></entry>

              <entry><para>Earth central body with all planets as point mass
              perturbations</para></entry>

              <entry><para> 5.8 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Finite Burn (case 1 and 2)</guilabel></entry>

              <entry><para>Point mass gravity </para></entry>

              <entry><para> 7200 sec. </para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para>Comparing the run time data for each integrator shown in the table
      below we see that the <guilabel>PrinceDormand78</guilabel> integrator
      was the fastest for 4 of the 6 cases and tied with the
      <guilabel>RungeKutta89</guilabel> integrator for LEO test case. For the
      Lunar flyby case, the <guilabel>RungeKutta89</guilabel> was the fastest
      integrator, however, in this case the
      <guilabel>PrinceDormand78</guilabel> integrator was at least 2 orders of
      magnitude more accurate given equaivalent <guilabel>Accuracy</guilabel>
      settings. Notice that the <guilabel>AdamsBashforthMoulton</guilabel>
      integrator has km level errors for some orbits because it is a low-order
      integrator.</para>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/IntegratorComparisonTable.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para><emphasis>Fields Unique to the AdamsBashforthMoulton
      Integrator</emphasis></para>

      <para>The <guilabel>AdamsBashforthMoulton</guilabel> integrator has two
      additional fields named <guilabel>TargetError</guilabel> and
      <guilabel>LowerError</guilabel> that are only active when
      <guilabel>Type</guilabel> is set to
      <guilabel>AdamsBashforthMoulton</guilabel>. If you are using another
      integrator type, those fields must be removed from your script file to
      avoid parsing errors. When working in the GUI, this is performed
      automatically. See examples below for more details.</para>
    </refsection>

    <refsection xml:id="Propagator_Numeric_Examples">
      <title>Examples</title>

      <informalexample>
        <para>Propagate an orbit using a general purpose Runge-Kutta
        integrator:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = PrinceDormand78
aProp.InitialStepSize = 60
aProp.Accuracy        = 1e-011
aProp.MinStep         = 0
aProp.MaxStep         = 86400
aProp.MaxStepAttempts = 50
aProp.StopIfAccuracyIsViolated = true

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Propagate using a fixed step configuration. Do this by setting
        <guilabel>InitialStepSize</guilabel> to the desired fixed step size
        and setting <guilabel>ErrorControl</guilabel> to
        <guilabel>None</guilabel>. This example propagates in constant steps
        of 30 seconds:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel
aForceModel.ErrorControl = None

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = PrinceDormand78
aProp.InitialStepSize = 30

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Propagate an orbit using an Adams-Bashforth-Moulton
        predictor-corrector integrator:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel
aForceModel.ErrorControl = RSSStep

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = AdamsBashforthMoulton
aProp.InitialStepSize = 60
aProp.MinStep         = 0
aProp.MaxStep         = 86400
aProp.MaxStepAttempts = 50
%  Note the following fields must be set with decreasing values!
aProp.Accuracy        = 1e-010
aProp.TargetError     = 1e-011
aProp.LowerError      = 1e-013
aProp.StopIfAccuracyIsViolated = true

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>

  <refsection xml:id="Propagator_ForceModel">
    <title>Force Model</title>

    <indexterm>
      <primary>Force Model</primary>
    </indexterm>

    <refsection>
      <title>Overview</title>

      <para>A <guilabel>ForceModel</guilabel> is a model of the environmental
      forces and dynamics that affect the motion of a spacecraft. GMAT
      supports numerous force models such as point mass and spherical harmonic
      gravity models, atmospheric drag, solar radiation pressure, tide models,
      and relativistic corrections. A <guilabel>ForceModel</guilabel> is
      configured and attached to the <guilabel>Propagator</guilabel> object
      (see the <guilabel>Propagator</guilabel> object for differences between
      script and GUI configuration when configuring a
      <guilabel>Propagator</guilabel>). The <guilabel>Propagator</guilabel>,
      along with the <guilabel>Propagate</guilabel> command, uses a
      <guilabel>ForceModel</guilabel> to numerically solve the orbital
      equations of motion (forwards or backwards in time) using the forces
      configured in the <guilabel>ForceModel</guilabel> object, and may
      include thrust terms in the case of powered flight. See the discussion
      below for detailed information on how to configure force models for your
      application.</para>

      <para><phrase role="ref_seealso">See Also</phrase>: <xref
      linkend="Propagator"/></para>
    </refsection>

    <refsection>
      <title>Fields</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.8*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>CentralBody</guilabel></entry>

              <entry><para>The central body of propagation.
              <guilabel>CentralBody</guilabel> must be a celestial body and
              cannot be a <guilabel>LibrationPoint</guilabel>,
              <guilabel>Barycenter</guilabel>,
              <guilabel>Spacecraft</guilabel>, or other special
              point.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>CelestialBody</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Earth</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag</guilabel></entry>

              <entry><para>Deprecated. This field has been replaced with
              <guilabel>Drag.AtmosphereModel</guilabel>.</para></entry>
            </row>

            <row>
              <entry><guilabel>Drag.AtmosphereModel </guilabel></entry>

              <entry><para>Specifies the atmosphere model used in the drag
              force. This field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>None</guilabel>,
                      <guilabel>JacchiaRoberts</guilabel>,
                      <guilabel>MSISE86</guilabel>,
                      <guilabel>MSISE90</guilabel>, <guilabel>NRLMSISE00.
                      </guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>MSISE90</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.F107</guilabel></entry>

              <entry><para>The instantaneous value of solar flux at wavelength
              of 10.7 cm. This field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>50 &lt;= <guilabel>Drag.F107</guilabel> &lt;=
                      400</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>150</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W/m^2/Hz</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.F107A</guilabel></entry>

              <entry><para>The average (monthly) value of solar flux at
              wavelength of 10.7 cm. This field is only active in the script
              if there is a
              <guilabel>PrimaryBody</guilabel>.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>50 &lt;= <guilabel>Drag.F107A </guilabel>&lt;=
                      400</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>150</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W/m^2/Hz</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.MagneticIndex</guilabel></entry>

              <entry><para>The geomagnetic index (Kp) used in density
              calculations. Kp is a planetary 3-hour-average, geomagnetic
              index that measures magnetic effects of solar radiation. This
              field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0 &lt;= Real Number &lt;= 9</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>3</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>ErrorControl </guilabel></entry>

              <entry><para>Controls how error in the current integration step
              is estimated. The error in the current step is computed by the
              selection of <guilabel>ErrorControl</guilabel> and compared to
              the value set in the <guilabel>Accuracy</guilabel> field to
              determine if the step has an acceptable error or needs to be
              improved. All error measurements are relative error, however,
              the reference for the relative error changes depending upon the
              selection of <guilabel>ErrorControl</guilabel>.
              <guilabel>RSSStep</guilabel> is the Root Sum Square (RSS)
              relative error measured with respect to the current step.
              <guilabel>RSSState</guilabel> is the (RSS) relative error
              measured with respect to the current state.
              <guilabel>LargestStep</guilabel> is the state vector component
              with the largest relative error measured with respect to the
              current step. <guilabel>LargestState</guilabel> is the state
              vector component with the largest relative error measured with
              respect to the current state. Setting
              <guilabel>ErrorControl</guilabel> to <guilabel>None</guilabel>
              turns off error control and the integrator takes constant steps
              at the value defined by <guilabel>InitialStepSize</guilabel> on
              the numerical integrator.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>None</guilabel>,
                      <guilabel>RSSStep</guilabel>,
                      <guilabel>RSSState</guilabel>,
                      <guilabel>LargestState</guilabel>,
                      <guilabel>LargestStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>RSSStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​Earth.EarthTideModel</guilabel></entry>

              <entry><para>Flag for type of Earth tide model. This field is
              always active but only used in the dynamics when there is a
              harmonic gravity model for Earth.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>None</guilabel>,
                      <guilabel>SolidAndPole</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>None</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.Degree
              </guilabel></entry>

              <entry><para>The degree of the harmonic gravity field. This
              field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0&lt;<guilabel>Degree</guilabel>&lt;Max Degree On
                      File</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4 (When loading a custom file in the GUI, GMAT
                      sets <guilabel>Degree</guilabel> to the max value on the
                      file)</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.Order</guilabel></entry>

              <entry><para>The order of the harmonic gravity field. This field
              is only active if there is a <guilabel>PrimaryBody</guilabel>.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0&lt;<guilabel>Order</guilabel>&lt;Max Degree On
                      File AND <guilabel>Degree</guilabel> &lt;=
                      <guilabel>Order</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4 (When loading a custom file in the GUI, GMAT
                      sets <guilabel>Order</guilabel> to the max value on the
                      file)</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.PotentialFile</guilabel></entry>

              <entry><para>The gravity potential file. This field is only
              active if there is a <guilabel>PrimaryBod</guilabel>y. See
              discussion below for detailed explanation of supported file
              types and how to configure gravity files.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>path and name of .cof OR .grv file</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>JGM2.cof</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Model</guilabel></entry>

              <entry><para>A GUI list of "configured' gravity files defined in
              the file gmat_startup_file.txt. <guilabel>Model</guilabel>
              allows you to quickly choose between gravity files distributed
              with GMAT. For example, if <guilabel>PrimaryBody</guilabel> is
              Earth, you can select among Earth gravity models provided with
              GMAT such as <guilabel>JGM-2</guilabel> and
              <guilabel>EGM-96</guilabel>. If you select
              <guilabel>Other</guilabel>, you can provide the path and
              filename for a custom gravity file.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>JGM-2</guilabel>,
                      <guilabel>JGM-3</guilabel>, <guilabel>EGM-96</guilabel>,
                      <guilabel>Mars-50C</guilabel>,
                      <guilabel>MGNP-180U</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set,get</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>JGM-2</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>PointMasses</guilabel></entry>

              <entry><para>A list of celestial bodies to be treated as point
              masses in the force model. A body cannot be both the
              <guilabel>PrimaryBody</guilabel> and in the
              <guilabel>PointMasses</guilabel> list. An empty list "{}"
              removes all points masses from the list.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource array</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>array of <guilabel>CelestialBodies</guilabel> not
                      selected as <guilabel>PrimaryBody</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Empty List</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>PrimaryBodies</guilabel></entry>

              <entry><para>A body modeled with a "complex" force model. A
              primary body can have an atmosphere and harmonic gravity model.
              Currently GMAT only supports one primary body per force model.
              The primary body must be the same as the
              <guilabel>CentralBody</guilabel>, and cannot be included in the
              <guilabel>PointMasses</guilabel> field. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>CelestialBody</guilabel> not included in
                      <guilabel>PointMasses</guilabel>.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Earth</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>RelativisticCorrection</guilabel></entry>

              <entry><para>Sets relativistic correction on or
              off.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>On</guilabel>,
                      <guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP</guilabel></entry>

              <entry><para>Sets SRP force on or off. See the Remarks section
              for a detailed explanation of SRP
              configuration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>On</guilabel>,
                      <guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Off</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Flux</guilabel></entry>

              <entry><para>The value of SRP flux at 1 AU. This field is only
              active in the script if <guilabel>SRP</guilabel> is on.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>1300 &lt;<guilabel>SRP.Flux</guilabel> &lt;
                      1450</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1367</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W/m^2</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Flux_Pressure</guilabel></entry>

              <entry><para>The solar flux at 1 AU divided by the speed of
              light. This field is only active in the script if SRP is on. See
              the Remarks section for a detailed explanation of SRP
              configuration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>4.33e-6 &lt;
                      <guilabel>SRP.Flux_Pressure</guilabel> &lt;
                      4.84e-6</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4.55982118135874e-006</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W *s/m^3</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Nominal_Sun </guilabel></entry>

              <entry><para>The value of one Astronomical Unit in km used in
              scaling SRP.Flux, which is flux at 1 AU, to the flux at
              spacecraft distance from sun. This field is only active in the
              script if SRP is on. See the Remarks section for a detailed
              explanation of SRP configuration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>135e6&lt;<guilabel>Nominal_Sun</guilabel>&lt;165e6</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>149597870.691</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>km</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_ForceModel.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Settings for the<guilabel> ForceModel</guilabel> object.</para>
    </refsection>

    <refsection>
      <title>Remarks</title>

      <para><emphasis>Overview of Primary Body/Central Body and Field
      Interactions</emphasis></para>

      <para>In GMAT, a primary body is a celestial body that is modeled with a
      complex force model which may include a spherical harmonic gravity
      model, tides, or drag. A body cannot appear in both the
      <guilabel>PrimaryBodies</guilabel> and <guilabel>PointMasses</guilabel>
      fields. GMAT currently requires that there are no more than one primary
      body per <guilabel>ForceModel</guilabel>, but this behavior will change
      in future versions and the user interface is designed to naturally
      support this future development area.</para>

      <para>GMAT currently requires that the primary body is either the same
      as the <guilabel>CentralBody</guilabel> or set to
      <guilabel>None</guilabel>. If you change the
      <guilabel>CentralBody</guilabel> in the GUI, GMAT changes the primary
      body to <guilabel>None</guilabel>, and you can then select between
      <guilabel>None</guilabel> and the central body. When you select a
      primary body in the GUI, the <guilabel>Gravity</guilabel> and
      <guilabel>Drag</guilabel> fields activate and allow you to select models
      for those forces consistent with the body selected in the
      <guilabel>PrimaryBodies</guilabel> field. For example, if you select
      Earth as the primary body, you can only select Earth drag models in the
      <guilabel>Drag.AtmosphereModel</guilabel> field. See the field list
      above for available models.</para>

      <para><emphasis>Configuring Gravitational Models</emphasis></para>

      <para>GMAT supports point mass gravity, spherical harmonic, and Earth
      tide models. On a <guilabel>Propagator</guilabel>, all celestial bodies
      are classified into two mutually exclusive categories:
      <guilabel>PrimaryBodies</guilabel>, and <guilabel>Point
      Masses</guilabel>. To model a body as a point mass, add it to the
      <guilabel>PointMasses</guilabel> list. GMAT currently requires that
      there be only a single body in the <guilabel>PrimaryBodies</guilabel>
      list. When a primary body is selected, the
      <guilabel>CentralBody</guilabel> and primary body must be the
      same.</para>

      <para>Bodies modeled as <guilabel>PointMasses</guilabel> use the
      gravitational parameter defined on the body (i.e. Earth.Mu) in the
      equations of motion. Bodies defined as
      <guilabel>PrimaryBodies</guilabel> use the constants defined on the
      potential file in the equations of motion. GMAT supports two gravity
      file formats: the .cof format and the STK .grv format. You can provide a
      custom potential file for your application as long as it is one of the
      supported formats. Potential files defined in the startup file are
      available in the <guilabel>Model</guilabel> list in the GUI. For
      example, the following lines in the startup file configure GMAT so that
      EGM96 is an available option for <guilabel>Model</guilabel> in the GUI
      when the primary body is Earth:</para>

      <programlisting>EARTH_POT_PATH         = DATA_PATH/gravity/earth/
EGM96_FILE             = EARTH_POT_PATH/EGM96.cof </programlisting>

      <para>Below is an example script snippet for configuring a custom
      gravity model including Earth tides.</para>

      <programlisting>Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PrimaryBodies = {Earth}
aForceModel.GravityField.Earth.Degree = 21
aForceModel.GravityField.Earth.Order  = 21
aForceModel.GravityField.Earth.PotentialFile = 'c:\MyData\File.cof'
aForceModel.GravityField.Earth.EarthTideModel = 'SolidAndPole'</programlisting>

      <para><emphasis>Configuring Drag Models</emphasis></para>

      <para>GMAT supports many density models for Earth including
      <guilabel>Jacchia-Roberts</guilabel> and various MSISE models. Density
      models for non-Earth bodies -- the Mars-GRAM model for example -- are
      included using custom plug-in components and are currently only
      supported in the script interface.</para>

      <para>To configure Earth density models, select Earth as the primary
      body, In the GUI, this activates the <guilabel>AtmosphereModel
      </guilabel>list. You can configure the solar flux values using the
      <guilabel> Setup</guilabel> button next to the
      <guilabel>AtmosphereModel</guilabel> list after you have selected an
      atmosphere model. Below is an example script snippet for configuring the
      <guilabel>NRLMSISE00</guilabel> density model.</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.PrimaryBodies = {Earth}
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00
GMAT aForceModel.Drag.F107 = 145
GMAT aForceModel.Drag.F107A = 160
GMAT aForceModel.Drag.MagneticIndex = 4
</programlisting>

      <caution>
        <para>Caution: GMAT uses the original single precision FORTAN code
        developed by the scientists who created the MSISE models. At low
        altitudes, the single precision density can cause numeric issues in
        the double precision integrator step size control and integration can
        be unacceptably slow. You can avoid the performance issue by using
        either fixed step integration or by using a relatively high
        <guilabel>Accuracy</guilabel> value such as 1e-8. You may need to
        experiment with the <guilabel>Accuracy</guilabel> setting to a value
        acceptable for your application.</para>
      </caution>

      <para>Note that when you select <guilabel>None</guilabel> for
      <guilabel>Drag.AtmosphereModel </guilabel>, the fields
      <guilabel>Drag.F107</guilabel>, <guilabel>Drag.F107A</guilabel>, and
      <guilabel>Drag.MagneticIndex</guilabel> are inactive and must be removed
      from your script file to avoid parsing errors. When working in the GUI,
      this is performed automatically.</para>

      <para>The table below describes the limits on altitude for drag models
      supported by GMAT.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="1.0*"/>

          <colspec colnum="3" colwidth="1.5*"/>

          <thead>
            <row>
              <entry>Model</entry>

              <entry>Theoretical Altitude (h) Limits</entry>

              <entry>Comments</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>MSISE86</guilabel></entry>

              <entry><para>90 &lt; h &lt; 1000</para></entry>

              <entry><para>GMAT will not allow propagation below 90 km
              altitude.</para></entry>
            </row>

            <row>
              <entry><guilabel>MSISE90</guilabel></entry>

              <entry><para>0 &lt; h &lt;1000</para></entry>

              <entry><para>GMAT will allow propagation below 0 km altitude but
              results are non-physical.</para></entry>
            </row>

            <row>
              <entry><guilabel>NRLMSISE00</guilabel></entry>

              <entry>0 &lt; h &lt;1000</entry>

              <entry><para> GMAT will allow propagation below 0 km altitude
              but results are non-physical. </para></entry>
            </row>

            <row>
              <entry><guilabel>JacchiaRoberts</guilabel></entry>

              <entry><para>h &gt; 100</para></entry>

              <entry><para>GMAT will not allow propagation below 100 km
              altitude. </para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para><emphasis>Configuring an SRP Model</emphasis></para>

      <para>GMAT uses a dual cone model to model central body shadowing of the
      spacecraft and models solar radiation pressure using a spherical
      spacecraft model. You can define the solar flux using two approaches
      which are currently only supported in the script interface. One approach
      is to define the flux value using the <guilabel>SRP.Flux</guilabel>
      field and the value of an astronomical unit (in km) using the
      <guilabel>Nominal_Sun</guilabel> field as shown in the following
      example.</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.PrimaryBodies = {Earth}
GMAT aForceModel.SRP = On
GMAT aForceModel.SRP.Flux = 1367
GMAT aForceModel.SRP.Nominal_Sun = 149597870.691</programlisting>

      <para>An alternative approach is to define the flux pressure at 1
      astronomical unit using the <guilabel>Flux_Pressure</guilabel> field as
      shown below..</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.PrimaryBodies = {Earth}
GMAT aForceModel.SRP = On
GMAT aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006
GMAT aForceModel.SRP.Nominal_Sun = 149597870.691</programlisting>

      <para>If you mix flux settings, as shown in the example below, GMAT will
      use the last approach in the script. Here, GMAT will use the
      <guilabel>Flux_Pressure</guilabel> setting.</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.PrimaryBodies = {Earth}
GMAT aForceModel.SRP = On
GMAT aForceModel.SRP.Flux = 1370
GMAT aForceModel.SRP.Nominal_Sun = 149597870
GMAT aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006</programlisting>

      <caution>
        <para>Caution: GMAT’s default option for configuring solar flux for an
        SRP model is to use <guilabel>SRP.Flux</guilabel> and<guilabel>
        Nominal_Sun</guilabel> fields. If you initially configured the
        <guilabel>Flux_Pressure</guilabel> field, when you save your mission
        via the save button in the toolbar, GMAT will write out
        <guilabel>SRP.Flux</guilabel> and <guilabel>Nominal_Sun</guilabel>
        values consistent with your setting of
        <guilabel>Flux_Pressure</guilabel>.</para>
      </caution>

      <para><emphasis> Variational Equations and the STM </emphasis></para>

      <para>GMAT can optionally propagate the orbit State Transition Matrix
      (STM). For more information on how to configure GMAT to compute the STM,
      see the Propagate command documentation.</para>

      <caution>
        <para>Caution: GMAT allows you to propagate the State Transition
        Matrix (STM) along with the orbital state. However, not all
        variational terms are implemented for STM propagation. The following
        are implemented: point mass perturbation, spherical harmonics (with
        tide models), and solar radiation pressure. The following are NOT
        implemented: drag and relativistic terms, and finite burns.
        Additionally, the SRP variational term does not include the partial
        derivative of the percent shadow with respect to orbital state. This
        approximation is acceptable for orbits with short penumbra durations
        but is inaccurate for orbits that spend relatively long periods of
        time in penumbra.</para>
      </caution>
    </refsection>

    <refsection>
      <title>Examples</title>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for point mass
        propagation.</para>

        <programlisting><code>Create Spacecraft aSat

Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PointMasses = {Earth}

Create Propagator aProp
aProp.FM = aForceModel

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for high fidelity low Earth
        orbit propagation.</para>

        <programlisting><code>Create Spacecraft aSat

Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PrimaryBodies = {Earth}
aForceModel.PointMasses = {Sun, Luna}
aForceModel.SRP = On
aForceModel.RelativisticCorrection = On
aForceModel.ErrorControl = RSSStep
aForceModel.GravityField.Earth.Degree = 20
aForceModel.GravityField.Earth.Order = 20
aForceModel.GravityField.Earth.PotentialFile = 'EGM96.cof'
aForceModel.GravityField.Earth.EarthTideModel = 'None'
aForceModel.Drag.AtmosphereModel = MSISE90
aForceModel.Drag.F107 = 150
aForceModel.Drag.F107A = 150
aForceModel.Drag.MagneticIndex = 3
aForceModel.SRP.Flux = 1359.388569998901
aForceModel.SRP.Nominal_Sun = 149597870.691

Create Propagator aProp
aProp.FM = aForceModel

BeginMissionSequence

Propagate aProp(aSat){aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for high fidelity lunar orbit
        propagation.</para>

        <programlisting><code>Create Spacecraft moonSat
GMAT moonSat.DateFormat = UTCGregorian
GMAT moonSat.Epoch.UTCGregorian = 01 Jun 2004 12:00:00.000
GMAT moonSat.CoordinateSystem = MoonMJ2000Eq
GMAT moonSat.DisplayStateType = Cartesian
GMAT moonSat.X = -1486.792117191545200
GMAT moonSat.Y = 0.0
GMAT moonSat.Z = 1486.792117191543000
GMAT moonSat.VX = -0.142927729144255
GMAT moonSat.VY = -1.631407624437537
GMAT moonSat.VZ = 0.142927729144255

Create CoordinateSystem MoonMJ2000Eq
MoonMJ2000Eq.Origin = Luna
MoonMJ2000Eq.Axes   = MJ2000Eq

Create ForceModel MoonLP165P
GMAT MoonLP165P.CentralBody = Luna
GMAT MoonLP165P.PrimaryBodies = {Luna}
GMAT MoonLP165P.SRP = On
GMAT MoonLP165P.SRP.Flux = 1367
GMAT MoonLP165P.SRP.Nominal_Sun = 149597870.691
GMAT MoonLP165P.Gravity.Luna.PotentialFile = ../data/gravity/luna/LP165P.cof
GMAT MoonLP165P.Gravity.Luna.Degree = 20
GMAT MoonLP165P.Gravity.Luna.Order = 20

Create Propagator RKV89
GMAT RKV89.FM = MoonLP165P

BeginMissionSequence

Propagate RKV89(moonSat) {moonSat.ElapsedSecs = 300}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>

  <refsection xml:id="Propagator_SPKPropagator">
    <title>SPK-Configured Propagator</title>

    <indexterm>
      <primary>SPICE Orbit Propagation</primary>
    </indexterm>

    <refsection>
      <title>Description</title>

      <para>An SPK-configured <guilabel>Propagator</guilabel> propagates a
      spacecraft by interpolating user-provided SPICE kernels. You configure a
      <guilabel>Propagator</guilabel> to use an SPK kernel by setting the
      <guilabel>Type</guilabel> field to <guilabel>SPK</guilabel>. SPK kernels
      and the <guilabel>NAIFId</guilabel> are defined on the
      <guilabel>Spacecraft</guilabel> Resource. You control propagation,
      including stopping conditions, using the <guilabel>Propagate</guilabel>
      command.</para>

      <para><phrase role="ref_seealso">See Also</phrase>: <xref
      linkend="Spacecraft"/>, <xref linkend="Propagate"/></para>
    </refsection>

    <refsection>
      <title>Fields</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.3*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Field</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>CentralBody</guilabel></entry>

              <entry><para>The central body of propagation. This field has no
              affect for SPK propagators.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Celestial body</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>
                        <guilabel>Earth</guilabel>
                      </para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>EpochFormat</guilabel></entry>

              <entry><para> Only used for an SPK propagator. The format of the
              epoch contained in the StartEpoch field. </para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>A1ModJulian</guilabel>,
                      <guilabel>TAIModJulian</guilabel>,
                      <guilabel>UTCModJulian</guilabel>,
                      <guilabel>TTModJulian</guilabel>,
                      <guilabel>TDBModJulian</guilabel>,
                      <guilabel>A1Gregorian</guilabel>,
                      <guilabel>TAIGregorian</guilabel>,
                      <guilabel>TTGregorian</guilabel>,
                      <guilabel>UTCGregorian</guilabel>,
                      <guilabel>TDBGregorian</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>
                        <guilabel>A1ModJulian</guilabel>
                      </para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A unless Mod Julian and in that case Modified
                      Julian Date</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Start Epoch</guilabel></entry>

              <entry><para>Only used for an SPK propagator. The initial epoch
              of propagation. When an epoch is provided that epoch is used as
              the initial epoch. When the keyword "FromSpacecraft" is
              provided, the start epoch is inherited from the
              spacecraft.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>"Gregorian: 04 Oct 1957 12:00:00.000 &lt;= Epoch
                      &lt;= 28 Feb 2100 00:00:00.000 Modified Julian: 6116.0
                      &lt;= Epoch &lt;= 58127.5 or "FromSpacecraft"</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>21545</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>StepSize</guilabel></entry>

              <entry><para> The step size for an SPK Propagator.</para>
              <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>300</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Type</guilabel></entry>

              <entry><para>Specifies the integrator or analytic propagator
              used to model time evolution of spacecraft motion. </para>
              <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>PrinceDormand78</guilabel>,
                      <guilabel>PrinceDormand45</guilabel>,
                      <guilabel>RungeKutta89</guilabel>,<guilabel>RungeKutta68</guilabel>,
                      <guilabel>RungeKutta56</guilabel>,
                      <guilabel>BulirschStoer</guilabel>,
                      <guilabel>AdamsBashforthMoulton</guilabel>,
                      <guilabel>SPK</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>
                        <guilabel>RungeKutta89</guilabel>
                      </para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_EphemerisPropagator_GUI.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>To configure a <guilabel>Propagator</guilabel> to use SPK files,
      on the <guilabel>Propagator</guilabel> dialog box, select
      <guilabel>SPK</guilabel> in the <guilabel>Type</guilabel> menu. There
      are four fields you can configure for an SPK propagator including
      <guilabel>StepSize</guilabel>, <guilabel>CentralBody</guilabel>,
      <guilabel>EpochFormat</guilabel>, and <guilabel>StartEpoch</guilabel>.
      Note that changing the <guilabel>EpochFormat</guilabel> setting converts
      the input epoch to the selected format. You can also type
      <userinput>FromSpacecraft</userinput> into the
      <guilabel>StartEpoch</guilabel> field and the
      <guilabel>Propagator</guilabel> will use the epoch of the
      <guilabel>Spacecraft</guilabel> as the initial propagation epoch.</para>
    </refsection>

    <refsection>
      <title>Remarks</title>

      <para>To use an SPK-configured <guilabel>Propagator</guilabel>, you must
      specify the SPK kernels and <guilabel>NAIFId</guilabel> on the
      <guilabel>Spacecraft</guilabel>, configure a
      <guilabel>Propagator</guilabel> to use SPK files as opposed to numerical
      methods, and configure the <guilabel>Propagate</guilabel> command to use
      the configured SPK propagator. The subsections and examples below
      discuss each of these items in detail.</para>

      <refsection>
        <title>Configuring Spacecraft SPK Kernels</title>

        <para>To use an SPK-configured <guilabel>Propagator</guilabel>, you
        must add the SPK kernels to the <guilabel>Spacecraft</guilabel> and
        define the pacecraft's <guilabel>NAIFId</guilabel>. SPK Kernels for
        selected spacecraft are available <link
        xlink:href="http://naif.jpl.nasa.gov/naif/data_archived.html">here.</link>
        Two sample vehicle spk kernels, (GEOSat.bsp and MoonTransfer.bsp) are
        distributed with GMAT for example purposes. An example of how to add
        spacecraft kernels via the script interface is shown below.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
GMAT aSpacecraft.NAIFId = -123456789
GMAT aSpacecraft.OrbitSpiceKernelName = {...
                                    '..\data\vehicle\ephem\spk\GEOSat.bsp'}</code></programlisting>

        <para>To add <guilabel>Spacecraft</guilabel> SPK kernals via the
        GUI:</para>

        <procedure>
          <step>
            <para>On the <guilabel>Spacecraft</guilabel> dialog box, click the
            <guilabel>SPICE</guilabel> tab.</para>
          </step>

          <step>
            <para>Under the <guilabel>SPK Files</guilabel> list, click
            <guilabel>Add</guilabel>.</para>
          </step>

          <step>
            <para>Browse to locate and select the desired SPK file</para>
          </step>

          <step>
            <para>Repeat to add all necessary SPK kernels</para>
          </step>

          <step>
            <para>In the <guilabel>NAIF ID</guilabel> field, enter the
            spacecraft integer NAIF id number. Note: For a given mission, each
            spacecraft should have a unique NAIF ID if the spacecraft are
            propagated with an SPK propagator.</para>
          </step>
        </procedure>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata align="center" contentdepth="100%"
                         fileref="files/images/Resource_EphemerisPropagator_GUI_2.png"
                         scalefit="1" width="100%"/>
            </imageobject>
          </mediaobject>
        </screenshot>

        <para>You can add more than one kernel to a spacecraft as shown via
        scripting below, where the files GEOSat1.bsp and GEOSat2.bsp are dummy
        file names used for example purposes only and are not distributed with
        GMAT. In the script, you can use relative path or absolute path to
        define the location of an SKP file. Relative paths are defined with
        respect to the GMAT bin directory of your local installation.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
aSpacecraft.OrbitSpiceKernelName ={'C:\MyDataFiles\GEOSat1.bsp',...
                                   'C:\MyDataFiles\GEOSat2.bsp'}</code></programlisting>
      </refsection>

      <refsection>
        <title>Configuring an SPK Propagator</title>

        <para>You can define the <guilabel>StartEpoch</guilabel> of
        propagation of an SPK-configured <guilabel>Propagator</guilabel> on
        either the <guilabel>Propagator</guilabel> Resource or inherit the
        <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel>. Below is a script snippet that shows
        how to inherit the <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel>. To inherit the
        <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel> using the GUI</para>

        <procedure>
          <step>
            <para>Open the SPK propagator dialog box,</para>
          </step>

          <step>
            <para>In the <guilabel>StartEpoch</guilabel> field., type
            <userinput>FromSpacecraft</userinput> or select
            <guilabel>FromSpacecraft</guilabel> from the drop-down menu</para>
          </step>
        </procedure>

        <para>To explicitly define the <guilabel>StartEpoch</guilabel> on the
        <guilabel>Propagator</guilabel> Resource use the following
        syntax.</para>

        <programlisting><code>Create Propagator spkProp
spkProp.EpochFormat = 'UTCGregorian'
spkProp.StartEpoch = '22 Jul 2014 11:29:10.811'

Create Propagator spkProp2
spkProp2.EpochFormat = 'TAIModJulian'
spkProp2.StartEpoch = '23466.5'</code></programlisting>

        <para>To configure the step size, use the StepSize field.</para>

        <programlisting><code>Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
</code></programlisting>
      </refsection>

      <refsection>
        <title>Interaction with the Propagate Command</title>

        <para>An SPK-configured <guilabel>Propagator</guilabel> works with the
        <guilabel>Propagate</guilabel> command in the same way numerical
        propagators work with the <guilabel>Propagate</guilabel> command with
        the following exceptions:</para>

        <itemizedlist>
          <listitem>
            <para>If a <guilabel>Propagate</guilabel> command uses an SPK
            propagator, then you can only propagate one spacecraft using that
            propagator. You can however, mix SPK propagators and numeric
            propagators in a single propagate command.</para>
          </listitem>

          <listitem>
            <para>SPK-configured <guilabel>Propagators</guilabel> will not
            propagate the STM or compute the orbit Jacobian (A matrix).</para>
          </listitem>
        </itemizedlist>

        <para>In the example below, we assume a
        <guilabel>Spacecraft</guilabel> named <guilabel>aSpacecraf</guilabel>t
        and a <guilabel>Propagator</guilabel> named
        <guilabel>spkProp</guilabel> have been configured a-priori. An example
        command to propagate <guilabel>aSpacecraft</guilabel> to Earth
        Periapsis using <guilabel>spkProp</guilabel> is shown below.</para>

        <programlisting><code>Propagate spkProp(aSpacecraft) {aSpacecraft.Earth.Periapsis}</code></programlisting>

        <para>Below is a script snippet that demonstrates how to propagate
        backwards using an SPK propagator.</para>

        <programlisting><code>Propagate BackProp spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = -1.5}</code></programlisting>
      </refsection>

      <refsection>
        <title>Behavior Near Ephemeris Boundaries</title>

        <para>In general, ephemeris interpolation is less accurate near the
        boundaries of ephemeris files and we recommend providing ephemeris for
        significant periods beyond the initial and final epochs of your
        application for this and other reasons. When propagating near the
        beginning or end of ephemeris files, the use of the double precision
        arithmetic may affect results. For example, if an ephemeris file has
        has an initial epoch TDBModJulian = 21545.00037249916, and you specify
        the StartEpoch in UTC Gregorian, round off error in time conversions
        and/or truncation of time using the Gregorian format (only accurate to
        millisecond) may cause the requested epoch to fall slightly outside of
        the range provided on the ephemeris file. The best solution is to
        provide extra ephemeris data to avoid time issues at the boundaries
        and the more subtle issue of poor interpolation.</para>

        <warning>
          <para>To locate requested stopping conditions, GMAT needs to bracket
          the root of the stopping condition function. Then, GMAT uses
          standard root finding techniques to locate the stopping condition to
          the requested accuracy. If the requested stopping condition lies at
          or near the beginning or end of the ephemeris data, then bracketing
          the stopping condition may not be possible without stepping off the
          ephemeris file which throw an error and execution will stop. In this
          case, you must provide more ephemeris data to locate the desired
          stopping condition.</para>
        </warning>
      </refsection>
    </refsection>

    <refsection>
      <title>Examples</title>

      <informalexample>
        <para>Propagate a GEO spacecraft using an SPK-configured
        <guilabel>Propagator</guilabel>. Define the
        <guilabel>StartEpoch</guilabel> from the spacecraft. Note: the SPK
        kernel GEOSat.bsp is distributed with GMAT.</para>

        <programlisting><code>Create Spacecraft aSpacecraft;
aSpacecraft.Epoch.UTCGregorian = '02 Jun 2004 12:00:00.000'
aSpacecraft.NAIFId = -123456789
aSpacecraft.OrbitSpiceKernelName = {'..\data\vehicle\ephem\spk\GEOSat.bsp'}

Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
spkProp.CentralBody = Earth
spkProp.StartEpoch = FromSpacecraft

Create OrbitView EarthView
EarthView.Add = {aSpacecraft, Earth, Luna}
EarthView.ViewPointVector = [ 30000 -20000 10000 ]
EarthView.ViewScaleFactor = 2.5

BeginMissionSequence
Propagate spkProp(aSpacecraft) {aSpacecraft.TA = 90}
Propagate spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = 2.4}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Simulate a lunar transfer using an SPK-configured
        <guilabel>Propagator</guilabel>. Define
        <guilabel>StartEpoch</guilabel> on the
        <guilabel>Propagator</guilabel>. Note: the SPK kernel MoonTransfer.bsp
        is distributed with GMAT.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
aSpacecraft.NAIFId = -123456789
aSpacecraft.OrbitSpiceKernelName = {...
                          '..\data\vehicle\ephem\spk\MoonTransfer.bsp'}

Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
spkProp.CentralBody = Earth
spkProp.EpochFormat = 'UTCGregorian'
spkProp.StartEpoch = '22 Jul 2014 11:29:10.811'

Create OrbitView EarthView
EarthView.Add = {aSpacecraft, Earth, Luna}
EarthView.ViewPointVector = [ 30000 -20000 10000 ]
EarthView.ViewScaleFactor = 30

BeginMissionSequence
Propagate spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = 12}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>
</refentry>
