<?xml version="1.0" encoding="UTF-8"?>
<refentry version="5.0" xml:id="Propagator"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:xi="http://www.w3.org/2001/XInclude"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:m="http://www.w3.org/1998/Math/MathML"
          xmlns:html="http://www.w3.org/1999/xhtml"
          xmlns:db="http://docbook.org/ns/docbook">
  <indexterm>
    <primary>Propagator</primary>
  </indexterm>

  <refmeta>
    <refentrytitle>Propagator</refentrytitle>

    <refmiscinfo class="source">GMAT</refmiscinfo>

    <refmiscinfo class="manual">Resources</refmiscinfo>
  </refmeta>

  <refnamediv>
    <refname>Propagator</refname>

    <refpurpose>A propagator models spacecraft motion</refpurpose>
  </refnamediv>

  <refsection>
    <title>Overview of Propagator Components</title>

    <para>A <guilabel>Propagator</guilabel> is the GMAT component used to
    model spacecraft motion. GMAT contains two types of propagators: a
    numerical integrator type, and an ephemeris type. When using a numerical
    integrator type <guilabel>Propagator</guilabel>, you can choose among a
    suite of numerical integrators implementing Runge-Kutta and predictor
    corrector methods. Numeric <guilabel>Propagators</guilabel> also require a
    <guilabel>ForceModel</guilabel>. Additionally, you can configure a
    <guilabel>Propagator</guilabel> to use SPICE kernels or Code500 ephemeris
    files for propagation. This resource cannot be modified in the Mission
    Sequence. However, you set one <guilabel>Propagator</guilabel> equal to
    another <guilabel>Propagator</guilabel> in the mission,( i.e.
    <literal>myPropagator = yourPropagator</literal> ).</para>

    <para>GMAT's documentation for <guilabel>Propagator</guilabel> components
    is broken down into three sections:</para>

    <itemizedlist>
      <listitem>
        <para>For numerical <guilabel>Propagator</guilabel> documentation see
        <xref linkend="Propagator_NumericalPropagator"
        xrefstyle="select:title"/></para>
      </listitem>

      <listitem>
        <para>For <guilabel>ForceModel</guilabel> documentation see <xref
        linkend="Propagator_ForceModel" xrefstyle="select:title"/></para>
      </listitem>

      <listitem>
        <para>For SPICE <guilabel>Propagator</guilabel> documentation see
        <xref linkend="Propagator_SPKPropagator"
        xrefstyle="select:title"/></para>
      </listitem>

      <listitem>
        <para>For Code500 ephemeris <guilabel>Propagator</guilabel>
        documentation see <xref linkend="Propagator_Code500Propagator"
        xrefstyle="select:title"/></para>
      </listitem>
    </itemizedlist>

    <para><phrase role="ref_seealso">See Also</phrase>: <xref
    linkend="Spacecraft"/>, <xref linkend="Propagate"/></para>
  </refsection>

  <refsection xml:id="Propagator_NumericalPropagator">
    <title>Numerical Propagator</title>

    <indexterm>
      <primary>Numerical Integrator</primary>
    </indexterm>

    <refsection>
      <title>Overview</title>

      <para>A <guilabel>Propagator</guilabel> object that uses a numerical
      integrator (as opposed to an ephemeris propagator) is one of a few
      objects in GMAT that is configured differently in the scripting and in
      the GUI. In the GUI, you configure the integrator and force model
      setting on the same dialog box. See the <xref
      linkend="Propagator_Numeric_Remarks" xrefstyle="select:title"/> section
      below for detailed discussion of GMAT’s numerical integrators as well as
      performance and accuracy comparisons, and usage recommendations. This
      resource cannot be modified in the Mission Sequence. However, you can do
      whole object assignment in the mission,( i.e. <literal>myPropagator =
      yourPropagator</literal> ).</para>

      <para>When working in the script, you must create a
      <guilabel>ForceModel</guilabel> object separately from the
      <guilabel>Propagator</guilabel> and specify the force model using the
      “<guilabel>FM</guilabel>” field on the propagator object. See the <xref
      linkend="Propagator_Numeric_Examples" xrefstyle="select:title"/> section
      later in this section for details.</para>
    </refsection>

    <refsection>
      <title>Options</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>Accuracy</guilabel></entry>

              <entry><para>The desired accuracy for an integration step. GMAT
              uses the method selected in the
              <guibutton>ErrorControl</guibutton> field on the Force Model to
              determine a metric of the integration accuracy. For each step,
              the integrator ensures that the error in accuracy is smaller
              than the value defined by the
              <guibutton>ErrorControl</guibutton> metric.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND Real &lt; 1</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-11 except for ABM integrator which is
                      1e-10</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>FM</guilabel></entry>

              <entry><para>Identifies the force model used by an integrator.
              If no force model is provided, GMAT uses an Earth centered
              propagator with a 4x4 gravity model.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>ForceModel</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>InitialStepSize</guilabel></entry>

              <entry><para>The size of the first step attempted by the
              integrator. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0.0001</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>60</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>sec.</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>LowerError</guilabel></entry>

              <entry><para>The lower bound on integration error, used to
              determine when to make the step size larger. Applies only to
              <guilabel>AdamsBashforthMoulton</guilabel>
              integrator.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND 0 &lt;
                      <guilabel>LowerError</guilabel>
                      &lt;<guilabel>TargetError</guilabel> &lt;
                      <guilabel>Accuracy</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-13</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MaxStep</guilabel></entry>

              <entry><para>The maximum allowable step
              size.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND <guilabel>MinStep</guilabel> &lt;=
                      <guilabel>MaxStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>2700</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MaxStepAttempts</guilabel></entry>

              <entry><para>The number of attempts the integrator takes to meet
              the tolerance defined by the <guibutton>Accuracy</guibutton>
              field.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Integer &gt;= 1</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>50</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>MinStep</guilabel></entry>

              <entry><para>The minimum allowable step size.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND <guibutton>MinStep</guibutton>
                      &lt;= <guibutton>MaxStep</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>0.001</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>sec.</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>StopIfAccuracy-IsViolated</guilabel></entry>

              <entry><para>Flag to stop propagation if integration error value
              defined by <guilabel>Accuracy</guilabel> is not
              satisfied.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Boolean</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>true, false</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>true</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>TargetError</guilabel></entry>

              <entry><para>The nominal bound on integration error, used to set
              the target integration accuracy when adjusting step size.
              Applies only to <guilabel>AdamsBashforthMoulton</guilabel>
              integrator.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0 AND 0 &lt;
                      <guilabel>LowerError</guilabel> &lt;
                      <guilabel>TargetError</guilabel> &lt;
                      <guilabel>Accuracy</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1e-11</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Type</guilabel></entry>

              <entry><para>Specifies the integrator or analytic propagator
              used to model the time evolution of spacecraft motion.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guibutton>PrinceDormand78</guibutton>,
                      <guilabel>PrinceDormand853</guilabel>,
                      <guibutton>PrinceDormand45</guibutton>,
                      <guibutton>RungeKutta89</guibutton>,<guibutton>RungeKutta68</guibutton>,
                      <guibutton>RungeKutta56</guibutton>,
                      <guibutton>AdamsBashforthMoulton, SPK,
                      Code500</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guibutton>RungeKutta89</guibutton></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Resource_NumericalIntegrators_GUI_1.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para>Settings for the embedded Runge-Kutta integrators. Select the
      desired integrator from the <guilabel>Type</guilabel> menu.</para>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Resource_NumericalIntegrators_GUI_2.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para>The Adams-Bashforth-Moulton integrator has additional settings as
      shown.</para>
    </refsection>

    <refsection xml:id="Propagator_Numeric_Remarks">
      <title>Remarks</title>

      <para><emphasis>Best Practices for Using Numerical
      Integrators</emphasis></para>

      <para>The comparison data presented in a later section suggest that the
      <guilabel>PrinceDormand78</guilabel> integrator is the best all purpose
      integrator in GMAT. When in doubt, use the
      <guilabel>PrinceDormance78</guilabel> integrator, and set
      <guilabel>MinStep</guilabel> to zero so that the integrator’s adaptive
      step algorithm controls the minimum integration step size. Below are
      some important comments on GMAT’s step size control algorithms and the
      dangers of using a non-zero value for the minimum integration step size.
      The <guilabel>AdamsBashforthMoulton</guilabel> integrator is a low order
      integrator and we only recommend its use for low precision analysis when
      a predictor-corrector algorithm is required. We recommend that you study
      the performance and accuracy analysis documented later in this section
      to select a numerical integrator for your application. You may need to
      perform further analysis and comparisons for your application.</para>

      <caution>
        <para>Caution: GMAT’s default error computation mode is
        <guilabel>RSStep</guilabel> and this is a more stringent error control
        method than <guilabel>RSSState</guilabel> that is often used as the
        default in other software such as STK. If you set Accuracy to a very
        small number, 1e-13 for example, and leave
        <guilabel>ErrorControl</guilabel> set to <guilabel>RSSStep</guilabel>,
        integrator performance will be poor, for little if any improvement in
        the accuracy of the orbit integration. To find the best balance
        between integration accuracy and performance, we recommend you
        experiment with the accuracy setting for your selected integrator for
        your application. You can start with a relatively high setting of
        <guilabel>Accuracy</guilabel>, say 1e-9, and lower the accuracy by an
        order of magnitude at a time and compare the final orbital states to
        determine where smaller values of <guilabel>Accuracy</guilabel> result
        in longer propagation times without providing more accurate orbital
        solutions.</para>
      </caution>

      <caution>
        <para>Caution: GMAT allows you to set a minimum step on numerical
        integrators. It is possible that the requested
        <guilabel>Accuracy</guilabel> cannot be achieved given the
        <guilabel>MinimumStep</guilabel> setting. The
        <guilabel>Propagator</guilabel> flag
        <guilabel>StopIfAccuracyIsViolated</guilabel> determines the behavior
        if <guilabel>Accuracy</guilabel> cannot be satisfied. If
        <guilabel>StopIfAccuracyIsViolated</guilabel> is true, GMAT will throw
        an error and stop execution if integration accuracy is not satisfied.
        If <guilabel>StopIfAccuracyIsViolated</guilabel> is false, GMAT will
        only throw a warning that the integration accuracy was not satisfied
        but will continue to propagate the orbit.</para>
      </caution>

      <para><emphasis>Numerical Integrators Overview</emphasis></para>

      <para>The table below describes each numerical integrator in
      detail.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.5*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>RungeKutta89</guilabel></entry>

              <entry><para>An adaptive step, ninth order Runge-Kutta
              integrator with eighth order error control. The coefficients
              were derived by J. Verner. Verner developed several sets of
              coefficients for an 89 integrator and we have chosen the
              coefficients that are the most robust but not necessarily the
              most efficient.</para></entry>
            </row>

            <row>
              <entry><guilabel>PrinceDormand78</guilabel></entry>

              <entry><para>An adaptive step, eighth order Runge-Kutta
              integrator with seventh order error control. The coefficients
              were derived by Prince and Dormand.</para></entry>
            </row>

            <row>
              <entry><guilabel>PrinceDormand853</guilabel></entry>

              <entry><para>An adaptive step, eighth order Runge-Kutta
              integrator with 5th order error control that incorporates a 3rd
              order correction, as described in section II.10 of "Solving
              Ordinary Differential Equations I: Nonstiff Problems" by Hairer,
              Norsett and Warner. The coefficients were derived by Prince and
              Dormand. This integrator performs surprisingly well at loose
              Accuracy settings.</para></entry>
            </row>

            <row>
              <entry><guilabel>PrinceDormand45</guilabel></entry>

              <entry>An adaptive step, fifth order Runge-Kutta integrator with
              fourth order error control. The coefficients were derived by
              Prince and Dormand.</entry>
            </row>

            <row>
              <entry><guilabel>RungeKutta68</guilabel></entry>

              <entry><para>A second order Runge-Kutta-Nystrom type integrator
              with coefficients developed by by Dormand, El-Mikkawy and
              Prince. The integrator is a 9-stage Nystrom integrator, with
              error control on both the dependent variables and their
              derivatives. This second order implementation will correctly
              integrate forces that are non-conservative but it is not
              recommended for this use. See the integrator comparisons below
              for numerical comparisons. You cannot use this integrator to
              integrate mass during a finite maneuver because the mass flow
              rate is a first order differential equation not supported by
              this integrator.</para></entry>
            </row>

            <row>
              <entry><guilabel>RungeKutta56</guilabel></entry>

              <entry><para>An adaptive step, sixth order Runge-Kutta
              integrator with fifth order error control. The coefficients were
              derived by E. Fehlberg.</para></entry>
            </row>

            <row>
              <entry><guilabel>AdamsBashforthMoulton</guilabel></entry>

              <entry><para>A fourth-order Adams-Bashford predictor /
              Adams-Moulton corrector as described in Fundamentals of
              Astrodynamics by Bate, Mueller, and White. The predictor step
              extrapolates the next state of the variables using the the
              derivative information at the current state and three previous
              states of the variables. The corrector uses derivative
              information evaluated for this state, along with the derivative
              information at the original state and two preceding states, to
              tune this state, giving the final, corrected state. The ABM
              integrator uses the RungeKutta89 integrator to start the
              integration process. The ABM is a low order integrator and
              should not be used for precise applications or for highly
              nonlinear applications such as celestial body
              flybys.</para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para><emphasis>Performance &amp; Accuracy Comparison of Numerical
      Integrators</emphasis></para>

      <para>The tables below contain performance comparison data for GMAT's
      numerical integrators. The first table shows the orbit types, dynamics
      models, and propagation duration for each test case included in the
      comparison. Five orbit types were compared: low earth orbit, Molniya,
      Mars transfer (Type 2), Lunar transfer, and finite burn (case 1 is blow
      down, and case 2 is pressure regulated). For each test case, the orbit
      was propagated forward for a duration and then back-propagated to the
      intial epoch. The error values in the table are the RSS difference of
      the final position after forward and backward propagation to the initial
      position. The run time data for each orbit type is normalized on the
      integrator with the fasted run time for that orbit type. For all test
      cases the <guilabel>ErrorControl</guilabel> setting was set to
      <guilabel>RSSStep</guilabel>. <guilabel>Accuracy</guilabel> was set to
      1e-12 for all integrators except for
      <guilabel>AdamsBashfourthMoulton</guilabel> which was set to 1e-11
      because of poor performance when <guilabel>Accuracy</guilabel> was set
      to 1e-11.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="1.5*"/>

          <colspec colnum="3" colwidth="0.75*"/>

          <thead>
            <row>
              <entry>Orbit</entry>

              <entry>Dynamics Model</entry>

              <entry>Duration</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>LEO</guilabel></entry>

              <entry><para>Earth 20x20, Sun, Moon, drag using MSISE90 density,
              SRP </para></entry>

              <entry><para> 1 day </para></entry>
            </row>

            <row>
              <entry><guilabel>Molniya</guilabel></entry>

              <entry><para>Earth 20x20, Sun, Moon, drag using Jacchia Roberts
              density, SRP </para></entry>

              <entry><para> 3 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Mars Transfer</guilabel></entry>

              <entry><para>Near Earth: Earth 8x8, Sun, Moon,
              SRP</para><para>Deep Space: All planets as point mass
              perturbations</para><para>Near Mars: Mars 8x8 SRP</para></entry>

              <entry><para> 333 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Lunar Transfer</guilabel></entry>

              <entry><para>Earth central body with all planets as point mass
              perturbations</para></entry>

              <entry><para> 5.8 days </para></entry>
            </row>

            <row>
              <entry><guilabel>Finite Burn (case 1 and 2)</guilabel></entry>

              <entry><para>Point mass gravity </para></entry>

              <entry><para> 7200 sec. </para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para>Comparing the run time data for each integrator shown in the table
      below we see that the <guilabel>PrinceDormand78</guilabel> integrator
      was the fastest for 4 of the 6 cases and tied with the
      <guilabel>RungeKutta89</guilabel> integrator for LEO test case. For the
      Lunar flyby case, the <guilabel>RungeKutta89</guilabel> was the fastest
      integrator, however, in this case the
      <guilabel>PrinceDormand78</guilabel> integrator was at least 2 orders of
      magnitude more accurate given equaivalent <guilabel>Accuracy</guilabel>
      settings. Notice that the <guilabel>AdamsBashforthMoulton</guilabel>
      integrator has km level errors for some orbits because it is a low-order
      integrator.</para>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/IntegratorComparisonTable2.png"
                     scalefit="1" width="100%"/>
        </imageobject>
      </mediaobject>

      <para><emphasis>Fields Unique to the AdamsBashforthMoulton
      Integrator</emphasis></para>

      <para>The <guilabel>AdamsBashforthMoulton</guilabel> integrator has two
      additional fields named <guilabel>TargetError</guilabel> and
      <guilabel>LowerError</guilabel> that are only active when
      <guilabel>Type</guilabel> is set to
      <guilabel>AdamsBashforthMoulton</guilabel>. If you are using another
      integrator type, those fields must be removed from your script file to
      avoid parsing errors. When working in the GUI, this is performed
      automatically. See examples below for more details.</para>
    </refsection>

    <refsection xml:id="Propagator_Numeric_Examples">
      <title>Examples</title>

      <informalexample>
        <para>Propagate an orbit using a general purpose Runge-Kutta
        integrator:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = PrinceDormand78
aProp.InitialStepSize = 60
aProp.Accuracy        = 1e-011
aProp.MinStep         = 0
aProp.MaxStep         = 86400
aProp.MaxStepAttempts = 50
aProp.StopIfAccuracyIsViolated = true

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Propagate using a fixed step configuration. Do this by setting
        <guilabel>InitialStepSize</guilabel> to the desired fixed step size
        and setting <guilabel>ErrorControl</guilabel> to
        <guilabel>None</guilabel>. This example propagates in constant steps
        of 30 seconds:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel
aForceModel.ErrorControl = None

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = PrinceDormand78
aProp.InitialStepSize = 30

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Propagate an orbit using an Adams-Bashforth-Moulton
        predictor-corrector integrator:</para>

        <programlisting><code>Create Spacecraft aSat
Create ForceModel aForceModel
aForceModel.ErrorControl = RSSStep

Create Propagator aProp
aProp.FM              = aForceModel
aProp.Type            = AdamsBashforthMoulton
aProp.InitialStepSize = 60
aProp.MinStep         = 0
aProp.MaxStep         = 86400
aProp.MaxStepAttempts = 50
%  Note the following fields must be set with decreasing values!
aProp.Accuracy        = 1e-010
aProp.TargetError     = 1e-011
aProp.LowerError      = 1e-013
aProp.StopIfAccuracyIsViolated = true

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>

  <refsection xml:id="Propagator_ForceModel">
    <title>Force Model</title>

    <indexterm>
      <primary>Force Model</primary>
    </indexterm>

    <refsection>
      <title>Overview</title>

      <para>A <guilabel>ForceModel</guilabel> is a model of the environmental
      forces and dynamics that affect the motion of a spacecraft. GMAT
      supports numerous force models such as point mass and spherical harmonic
      gravity models, atmospheric drag, solar radiation pressure, tide models,
      and relativistic corrections. A <guilabel>ForceModel</guilabel> is
      configured and attached to the <guilabel>Propagator</guilabel> object
      (see the <guilabel>Propagator</guilabel> object for differences between
      script and GUI configuration when configuring a
      <guilabel>Propagator</guilabel>). The <guilabel>Propagator</guilabel>,
      along with the <guilabel>Propagate</guilabel> command, uses a
      <guilabel>ForceModel</guilabel> to numerically solve the orbital
      equations of motion (forwards or backwards in time) using the forces
      configured in the <guilabel>ForceModel</guilabel> object, and may
      include thrust terms in the case of powered flight. See the discussion
      below for detailed information on how to configure force models for your
      application. This resource cannot be modified in the Mission
      Sequence.</para>

      <para><phrase role="ref_seealso">See Also</phrase>: <xref
      linkend="Propagator"/></para>
    </refsection>

    <refsection xml:id="Propagator_ForceModel_Fields">
      <title>Fields</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.8*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Option</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>CentralBody</guilabel></entry>

              <entry><para>The central body of propagation.
              <guilabel>CentralBody</guilabel> must be a celestial body and
              cannot be a <guilabel>LibrationPoint</guilabel>,
              <guilabel>Barycenter</guilabel>,
              <guilabel>Spacecraft</guilabel>, or other special
              point.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>CelestialBody</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Earth</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag</guilabel></entry>

              <entry><para>Deprecated. This field has been replaced with
              <guilabel>Drag.AtmosphereModel</guilabel>.</para></entry>
            </row>

            <row>
              <entry><guilabel>Drag.AtmosphereModel</guilabel></entry>

              <entry><para>Specifies the atmosphere model used in the drag
              force. This field is only active if there is a
              <guilabel>PrimaryBody</guilabel>.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>If <guilabel>PrimaryBody</guilabel> is
                      <guilabel>Earth</guilabel>: <guilabel>None</guilabel>,
                      <guilabel>JacchiaRoberts</guilabel>,
                      <guilabel>MSISE86</guilabel>,
                      <guilabel>MSISE90</guilabel> (with plugin),
                      <guilabel>NRLMSISE00</guilabel> (with plugin)</para>

                      <para>If <guilabel>PrimaryBody</guilabel> is
                      <guilabel>Mars</guilabel>: <guilabel>None</guilabel>,
                      <guilabel>MarsGRAM2005</guilabel> (with plugin)</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>None</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.CSSISpaceWeatherFile</guilabel></entry>

              <entry><para>The file name of the CSSI space weather file with
              optional path information. See <xref
              linkend="Propagator_ForceModel_Remarks"
              xrefstyle="select:title"/> for details on file
              format.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>String containing name of the CSSI file with
                      optional path information.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><literal>'CSSI_2004To2026.txt'</literal></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.DensityModel</guilabel></entry>

              <entry><para>Enabled when
              <guilabel>Drag.AtmosphereModel</guilabel> is
              <guilabel>MarsGRAM2005</guilabel>. Specifies the Mars-GRAM
              density model to use. <guilabel>Mean</guilabel> is mean density
              with any optional wave model perturbations enabled by the input
              file. <guilabel>High</guilabel> is <guilabel>Mean</guilabel>
              density plus 1 standard deviation. <guilabel>Low</guilabel> is
              <guilabel>Mean</guilabel> density minus 1 standard
              deviation.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>High</guilabel>,
                      <guilabel>Low</guilabel>,
                      <guilabel>Mean</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Mean</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.F107</guilabel></entry>

              <entry><para>The instantaneous value of solar flux at wavelength
              of 10.7 cm. This field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. Realistic values for this
              seeting are 50 &lt;= <guilabel>Drag.F107</guilabel> &lt;=
              400.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>Drag.F107</guilabel>&gt;= 0</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>150</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>10^-22 W/m^2/Hz</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.F107A</guilabel></entry>

              <entry><para>The average (monthly) value of solar flux at
              wavelength of 10.7 cm. This field is only active in the script
              if there is a <guilabel>PrimaryBody</guilabel>. Realistic values
              for this seeting are 50 &lt;= <guilabel>Drag.F107A</guilabel>
              &lt;= 400.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>Drag.F107A</guilabel>&gt;=0</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>150</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>10^-22 W/m^2/Hz</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.HistoricWeatherSource</guilabel></entry>

              <entry><para>Defines the source for historical flux and
              Geo-magnetic indeces used in Earth density
              modeling.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>ConstantFluxAndGeoMag</guilabel>,
                      <guilabel>CSSISpaceWeatherFile</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>ConstantFluxAndGeoMag</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.InputFile</guilabel></entry>

              <entry><para>Enabled when
              <guilabel>Drag.AtmosphereModel</guilabel> is
              <guilabel>MarsGRAM2005</guilabel>. Path to the Mars-GRAM input
              namelist file that configures the model. See the <link
              linkend="Propagator_ForceModel_Remarks_ConfiguringDragModels_MarsGRAM2005">MarsGRAM2005
              section</link> for details on the individual settings in this
              file and how they are used by GMAT. Relative paths are relative
              to the GMAT <filename>bin</filename>
              directory.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Valid path to a Mars-GRAM input namelist
                      file</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><literal>'../data/atmosphere/MarsGRAM2005/inputstd0.txt'</literal></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.MagneticIndex</guilabel></entry>

              <entry><para>The geomagnetic index (Kp) used in density
              calculations. Kp is a planetary 3-hour-average, geomagnetic
              index that measures magnetic effects of solar radiation. This
              field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0 &lt;= Real Number &lt;= 9</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>3</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.PredictedWeatherSource</guilabel></entry>

              <entry><para>Defines the source for predicted flux and
              Geo-magnetic indeces used in Earth density
              modeling.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>SchattenFile</guilabel>,
                      <guilabel>CSSISpaceWeatherFile</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>ConstantFluxAndGeoMag</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.SchattenErrorModel</guilabel></entry>

              <entry><para>The error model used from the Schatten file.
              Schatten predicts include mean, +2 sigma, and -2 sigma models.
              See <xref linkend="Propagator_ForceModel_Remarks"
              xrefstyle="select:title"/> for details on the file
              format.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>Nominal</guilabel>,
                      <guilabel>PlusTwoSigma</guilabel>,
                      <guilabel>MinusTwoSigma</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Nominal</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.SchattenFile</guilabel></entry>

              <entry><para>The file name of the Schatten file with optional
              path information. See <xref
              linkend="Propagator_ForceModel_Remarks"
              xrefstyle="select:title"/> for details on file
              format.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>String containing name of the Schatten file with
                      optional path information.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><literal>'SchattenPredict.txt'</literal></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Drag.SchattenTimingModel</guilabel></entry>

              <entry><para>The timing model used from the Schatten file.
              Schatten predicts include a nominal solar cycle model, an early
              model, and a late model. See <xref
              linkend="Propagator_ForceModel_Remarks"
              xrefstyle="select:title"/> for details on the file
              format.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>NominalCycle</guilabel>,
                      <guilabel>EarlyCycle</guilabel>,
                      <guilabel>LateCycle</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>NominalCycle</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>ErrorControl </guilabel></entry>

              <entry><para>Controls how error in the current integration step
              is estimated. The error in the current step is computed by the
              selection of <guilabel>ErrorControl</guilabel> and compared to
              the value set in the <guilabel>Accuracy</guilabel> field to
              determine if the step has an acceptable error or needs to be
              improved. All error measurements are relative error, however,
              the reference for the relative error changes depending upon the
              selection of <guilabel>ErrorControl</guilabel>.
              <guilabel>RSSStep</guilabel> is the Root Sum Square (RSS)
              relative error measured with respect to the current step.
              <guilabel>RSSState</guilabel> is the (RSS) relative error
              measured with respect to the current state.
              <guilabel>LargestStep</guilabel> is the state vector component
              with the largest relative error measured with respect to the
              current step. <guilabel>LargestState</guilabel> is the state
              vector component with the largest relative error measured with
              respect to the current state. Setting
              <guilabel>ErrorControl</guilabel> to <guilabel>None</guilabel>
              turns off error control and the integrator takes constant steps
              at the value defined by <guilabel>InitialStepSize</guilabel> on
              the numerical integrator.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>None</guilabel>,
                      <guilabel>RSSStep</guilabel>,
                      <guilabel>RSSState</guilabel>,
                      <guilabel>LargestState</guilabel>,
                      <guilabel>LargestStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>RSSStep</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​Earth.EarthTideModel</guilabel></entry>

              <entry><para>Flag for type of Earth tide model. This field is
              always active but only used in the dynamics when there is a
              harmonic gravity model for Earth.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>None</guilabel>,
                      <guilabel>SolidAndPole</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>None</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.Degree
              </guilabel></entry>

              <entry><para>The degree of the harmonic gravity field. This
              field is only active if there is a
              <guilabel>PrimaryBody</guilabel>. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0&lt;<guilabel>Degree</guilabel>&lt;Max Degree On
                      File</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4 (When loading a custom file in the GUI, GMAT
                      sets <guilabel>Degree</guilabel> to the max value on the
                      file)</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.Order</guilabel></entry>

              <entry><para>The order of the harmonic gravity field. This field
              is only active if there is a <guilabel>PrimaryBody</guilabel>.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Integer</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>0&lt;<guilabel>Order</guilabel>&lt;Max Degree On
                      File AND <guilabel>Degree</guilabel> &lt;=
                      <guilabel>Order</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4 (When loading a custom file in the GUI, GMAT
                      sets <guilabel>Order</guilabel> to the max value on the
                      file)</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>GravityField.​<replaceable>PrimaryBodyName</replaceable>.PotentialFile</guilabel></entry>

              <entry><para>The gravity potential file. This field is only
              active if there is a <guilabel>PrimaryBod</guilabel>y. See
              discussion below for detailed explanation of supported file
              types and how to configure gravity files.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>path and name of .cof OR .grv file</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>JGM2.cof</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Model</guilabel></entry>

              <entry><para>A GUI list of "configured' gravity files defined in
              the file gmat_startup_file.txt. <guilabel>Model</guilabel>
              allows you to quickly choose between gravity files distributed
              with GMAT. For example, if <guilabel>PrimaryBody</guilabel> is
              Earth, you can select among Earth gravity models provided with
              GMAT such as <guilabel>JGM-2</guilabel> and
              <guilabel>EGM-96</guilabel>. If you select
              <guilabel>Other</guilabel>, you can provide the path and
              filename for a custom gravity file.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>JGM-2</guilabel>,
                      <guilabel>JGM-3</guilabel>, <guilabel>EGM-96</guilabel>,
                      <guilabel>Mars-50C</guilabel>,
                      <guilabel>MGNP-180U</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set,get</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>JGM-2</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>PointMasses</guilabel></entry>

              <entry><para>A list of celestial bodies to be treated as point
              masses in the force model. A body cannot be both the
              <guilabel>PrimaryBody</guilabel> and in the
              <guilabel>PointMasses</guilabel> list. An empty list "{}"
              removes all points masses from the list.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource array</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>array of <guilabel>CelestialBodies</guilabel> not
                      selected as <guilabel>PrimaryBody</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Empty List</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>PrimaryBodies</guilabel></entry>

              <entry><para>A body modeled with a "complex" force model. A
              primary body can have an atmosphere and harmonic gravity model.
              Currently GMAT only supports one primary body per force model.
              The primary body must be the same as the
              <guilabel>CentralBody</guilabel>, and cannot be included in the
              <guilabel>PointMasses</guilabel> field. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>CelestialBody</guilabel> not included in
                      <guilabel>PointMasses</guilabel>.</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Earth</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>RelativisticCorrection</guilabel></entry>

              <entry><para>Sets relativistic correction on or
              off.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>On</guilabel>,
                      <guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP</guilabel></entry>

              <entry><para>Sets SRP force on or off. See the Remarks section
              for a detailed explanation of SRP configuration. The SRP model
              used is set in the SRP.Model field.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>On</guilabel>,
                      <guilabel>Off</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Off</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Flux</guilabel></entry>

              <entry><para>The value of SRP flux at 1 AU. This field is only
              active in the script if <guilabel>SRP</guilabel> is on.
              </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>1200 &lt;<guilabel>SRP.Flux</guilabel> &lt;
                      1450</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>1367</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W/m^2</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Flux_Pressure</guilabel></entry>

              <entry><para>The solar flux at 1 AU divided by the speed of
              light. This field is only active in the script if SRP is on. See
              the Remarks section for a detailed explanation of SRP
              configuration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>4.33e-6 &lt;
                      <guilabel>SRP.Flux_Pressure</guilabel> &lt;
                      4.84e-6</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>4.55982118135874e-006</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>W *s/m^3</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Model </guilabel></entry>

              <entry><para>The model for SRP acceleration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>Spherical,SPADFile</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>Spherical</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>SRP.Nominal_Sun </guilabel></entry>

              <entry><para>The value of one Astronomical Unit in km used in
              scaling SRP.Flux, which is flux at 1 AU, to the flux at
              spacecraft distance from sun. This field is only active in the
              script if SRP is on. See the Remarks section for a detailed
              explanation of SRP configuration.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>135e6&lt;<guilabel>Nominal_Sun</guilabel>&lt;165e6</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>149597870.691</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>km</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_ForceModel.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>Settings for the<guilabel> ForceModel</guilabel> object.</para>
    </refsection>

    <refsection xml:id="Propagator_ForceModel_Remarks">
      <title>Remarks</title>

      <para><emphasis>Overview of Primary Body/Central Body and Field
      Interactions</emphasis></para>

      <para>In GMAT, a primary body is a celestial body that is modeled with a
      complex force model which may include a spherical harmonic gravity
      model, tides, or drag. A body cannot appear in both the
      <guilabel>PrimaryBodies</guilabel> and <guilabel>PointMasses</guilabel>
      fields. GMAT currently requires that there are no more than one primary
      body per <guilabel>ForceModel</guilabel>, but this behavior will change
      in future versions and the user interface is designed to naturally
      support this future development area.</para>

      <para>GMAT currently requires that the primary body is either the same
      as the <guilabel>CentralBody</guilabel> or set to
      <guilabel>None</guilabel>. If you change the
      <guilabel>CentralBody</guilabel> in the GUI, GMAT changes the primary
      body to <guilabel>None</guilabel>, and you can then select between
      <guilabel>None</guilabel> and the central body. When you select a
      primary body in the GUI, the <guilabel>Gravity</guilabel> and
      <guilabel>Drag</guilabel> fields activate and allow you to select models
      for those forces consistent with the body selected in the
      <guilabel>PrimaryBodies</guilabel> field. For example, if you select
      Earth as the primary body, you can only select Earth drag models in the
      <guilabel>Drag.AtmosphereModel</guilabel> field. See the field list
      above for available models.</para>

      <para><emphasis>Configuring Gravitational Models</emphasis></para>

      <para>GMAT supports point mass gravity, spherical harmonic, and Earth
      tide models. On a <guilabel>Propagator</guilabel>, all celestial bodies
      are classified into two mutually exclusive categories:
      <guilabel>PrimaryBodies</guilabel>, and <guilabel>Point
      Masses</guilabel>. To model a body as a point mass, add it to the
      <guilabel>PointMasses</guilabel> list. GMAT currently requires that
      there be only a single body in the <guilabel>PrimaryBodies</guilabel>
      list. When a primary body is selected, the
      <guilabel>CentralBody</guilabel> and primary body must be the
      same.</para>

      <para>Bodies modeled as <guilabel>PointMasses</guilabel> use the
      gravitational parameter defined on the body (i.e. Earth.Mu) in the
      equations of motion. Bodies defined as
      <guilabel>PrimaryBodies</guilabel> use the constants defined on the
      potential file in the equations of motion. GMAT supports two gravity
      file formats: the .cof format and the STK .grv format. You can provide a
      custom potential file for your application as long as it is one of the
      supported formats. Potential files defined in the startup file are
      available in the <guilabel>Model</guilabel> list in the GUI. For
      example, the following lines in the startup file configure GMAT so that
      EGM96 is an available option for <guilabel>Model</guilabel> in the GUI
      when the primary body is Earth:</para>

      <programlisting>EARTH_POT_PATH         = DATA_PATH/gravity/earth/
EGM96_FILE             = EARTH_POT_PATH/EGM96.cof </programlisting>

      <para>Below is an example script snippet for configuring a custom
      gravity model including Earth tides.</para>

      <programlisting>Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PrimaryBodies = {Earth}
aForceModel.GravityField.Earth.Degree = 21
aForceModel.GravityField.Earth.Order  = 21
aForceModel.GravityField.Earth.PotentialFile = 'c:\MyData\File.cof'
aForceModel.GravityField.Earth.EarthTideModel = 'SolidAndPole'</programlisting>

      <para><emphasis>Configuring Drag Models</emphasis></para>

      <para>GMAT supports many density models for Earth including
      <guilabel>Jacchia-Roberts</guilabel> and various MSISE models. Density
      models for non-Earth bodies -- the Mars-GRAM model for example -- are
      included using custom plug-in components and are currently only
      supported in the script interface.</para>

      <para>To configure Earth density models, select Earth as the primary
      body, In the GUI, this activates the <guilabel>AtmosphereModel
      </guilabel>list. You can configure the solar flux values using the
      <guilabel> Setup</guilabel> button next to the
      <guilabel>AtmosphereModel</guilabel> list after you have selected an
      atmosphere model. Below is an example script snippet for configuring the
      <guilabel>NRLMSISE00</guilabel> density model.</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.PrimaryBodies = {Earth}
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00
</programlisting>

      <caution>
        <para>Caution: GMAT uses the original single precision FORTAN code
        developed by the scientists who created the MSISE models. At low
        altitudes, the single precision density can cause numeric issues in
        the double precision integrator step size control and integration can
        be unacceptably slow. You can avoid the performance issue by using
        either fixed step integration or by using a relatively high
        <guilabel>Accuracy</guilabel> value such as 1e-8. You may need to
        experiment with the <guilabel>Accuracy</guilabel> setting to a value
        acceptable for your application.</para>
      </caution>

      <para>Note that when you select <guilabel>None</guilabel> for
      <guilabel>Drag.AtmosphereModel </guilabel>, the fields associated with
      density configuration, such as <guilabel>Drag.F107</guilabel>,
      <guilabel>Drag.F107A</guilabel>, and
      <guilabel>Drag.MagneticIndex</guilabel> and others are inactive and must
      be removed from your script file to avoid parsing errors. When working
      in the GUI, this is performed automatically.</para>

      <para>The table below describes the limits on altitude for drag models
      supported by GMAT.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="1.0*"/>

          <colspec colnum="2" colwidth="1.0*"/>

          <colspec colnum="3" colwidth="1.5*"/>

          <thead>
            <row>
              <entry>Model</entry>

              <entry>Theoretical Altitude (h) Limits</entry>

              <entry>Comments</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>MSISE86</guilabel></entry>

              <entry><para>90 &lt; h &lt; 1000</para></entry>

              <entry><para>GMAT will not allow propagation below 90 km
              altitude.</para></entry>
            </row>

            <row>
              <entry><guilabel>MSISE90</guilabel></entry>

              <entry><para>0 &lt; h &lt;1000</para></entry>

              <entry><para>GMAT will allow propagation below 0 km altitude but
              results are non-physical.</para></entry>
            </row>

            <row>
              <entry><guilabel>NRLMSISE00</guilabel></entry>

              <entry>0 &lt; h &lt;1000</entry>

              <entry><para> GMAT will allow propagation below 0 km altitude
              but results are non-physical. </para></entry>
            </row>

            <row>
              <entry><guilabel>JacchiaRoberts</guilabel></entry>

              <entry><para>h &gt; 100</para></entry>

              <entry><para>GMAT will not allow propagation below 100 km
              altitude. </para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para
      xml:id="Propagator_ForceModel_Remarks_ConfiguringDragModels_MarsGRAM2005"><emphasis>MarsGRAM2005</emphasis></para>

      <para>When <guilabel>PrimaryBody</guilabel> is
      <guilabel>Mars</guilabel>, you can choose Mars-GRAM 2005 as your
      atmosphere model. This model is only available when the
      <filename>libMarsGRAM</filename> plugin is available and enabled in the
      GMAT startup file.</para>

      <warning>
        <para>As of version R2015a, you can only have one unique Mars-GRAM
        force model configuration in a given script. If you include multiple
        propagators with Mars-GRAM force models with different Mars-GRAM
        configurations, the different configurations are not honored, and all
        of the propagators will use the same configuration for
        Mars-GRAM.</para>
      </warning>

      <para>When using the <guilabel>MarsGRAM2005</guilabel> atmosphere model,
      three new fields are available in the script language (but not the
      GUI):<itemizedlist spacing="compact">
          <listitem>
            <para><guilabel>Drag.InputFile</guilabel></para>
          </listitem>

          <listitem>
            <para><guilabel>Drag.DensityModel</guilabel></para>
          </listitem>
        </itemizedlist></para>

      <para>See the <link linkend="Propagator_ForceModel_Fields">Fields
      section</link> for details on these fields.</para>

      <para>In addition, the space weather fields are treated as
      follows:<itemizedlist spacing="compact">
          <listitem>
            <para><guilabel>Drag.F107</guilabel>: value of 10.7 cm solar flux
            at 1 AU, as documented in the <link
            linkend="Propagator_ForceModel_Fields">Fields
            section</link></para>
          </listitem>

          <listitem>
            <para><guilabel>Drag.F107A</guilabel>: not used</para>
          </listitem>

          <listitem>
            <para><guilabel>Drag.MagneticIndex</guilabel>: not used</para>
          </listitem>
        </itemizedlist></para>

      <para>The Mars-GRAM 2005 input file is a text file in FORTRAN NAMELIST
      format. Most variables in this file are passed directly to the Mars-GRAM
      model and are used as intended. However, some are replaced internally by
      GMAT-supplied values. The following table lists those input variables
      that are handled specially.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="0.5*"/>

          <thead>
            <row>
              <entry>Input Variable</entry>

              <entry>GMAT usage</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>(Unlisted)</entry>

              <entry>Passed through to Mars-GRAM 2005 model</entry>
            </row>

            <row>
              <entry><literal>DATADIR</literal></entry>

              <entry>Always
              <literal>'../data/atmosphere/MarsGRAM2005/binFiles'</literal></entry>
            </row>

            <row>
              <entry><literal>GCMDIR</literal></entry>

              <entry>Always
              <literal>'../data/atmosphere/MarsGRAM2005/binFiles'</literal></entry>
            </row>

            <row>
              <entry><literal>IERT</literal></entry>

              <entry>Always 1 (Earth-receive time)</entry>
            </row>

            <row>
              <entry><literal>IUTC</literal></entry>

              <entry>Always 0 (TT time)</entry>
            </row>

            <row>
              <entry><literal>MONTH</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>MDAY</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>MYEAR</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>NPOS</literal></entry>

              <entry>Always 1</entry>
            </row>

            <row>
              <entry><literal>IHR</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>IMIN</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>ISEC</literal></entry>

              <entry>Replaced by current propagation epoch</entry>
            </row>

            <row>
              <entry><literal>LonEW</literal></entry>

              <entry>Always 1 (positive East)</entry>
            </row>

            <row>
              <entry><literal>F107</literal></entry>

              <entry>Replaced by value of
              <guilabel>Drag.F107</guilabel></entry>
            </row>

            <row>
              <entry><literal>FLAT</literal></entry>

              <entry>Replaced by current propagation state</entry>
            </row>

            <row>
              <entry><literal>FLON</literal></entry>

              <entry>Replaced by current propagation state</entry>
            </row>

            <row>
              <entry><literal>FHGT</literal></entry>

              <entry>Replaced by current propagation state</entry>
            </row>

            <row>
              <entry><literal>MOLAhgts</literal></entry>

              <entry>Always 0 (reference ellipsoid)</entry>
            </row>

            <row>
              <entry><literal>iup</literal></entry>

              <entry>Always 0 (no output)</entry>
            </row>

            <row>
              <entry><literal>ipclat</literal></entry>

              <entry>Always 0 (planetographic input)</entry>
            </row>

            <row>
              <entry><literal>requa</literal></entry>

              <entry>Replaced by value of
              <guilabel>Mars.EquatorialRadius</guilabel></entry>
            </row>

            <row>
              <entry><literal>rpole</literal></entry>

              <entry>Replaced by GMAT's value of Mars polar radius (calculated
              from <guilabel>Mars.EquatorialRadius</guilabel> and
              <guilabel>Mars.Flattening</guilabel>)</entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>

      <para>The input file is read by the Mars-GRAM 2005 model code, which has
      limited error checking. If the input file or data files are incorrect or
      missing, GMAT may exhibit unintended behavior. Note that local winds
      returned by the Mars-GRAM 2005 model are not included in GMAT's drag
      model.</para>

      <para><emphasis>Configuring Space Weather Data for Density
      Models</emphasis></para>

      <para>GMAT supports several space weather input types for drag modelling
      including constant flux and Geo-magnetic index values, a historical
      weather data file, and a predicted weather data file. You can separately
      configure the data used for historical data and predicted data. For
      historical data you can choose between constant values and a CSSI space
      weather file. For predicted data you can choose between constant values
      and a Schatten predict file. Each of those sources is discussed in
      detail below.</para>

      <para>The precedence for data source is determined by the simulation
      epoch (i.e. the epoch when density is evaluated), and the epochs
      contained on the data files</para>

      <itemizedlist>
        <listitem>
          <para>If both historical data and predicted data sources are set to
          constants, then constant values are always used.</para>
        </listitem>

        <listitem>
          <para>If you have selected a CSSI file as the historical data
          source, if the simulation epoch falls before the last row of
          historical data in the CSSI file's historical data block, then the
          CSSI data is used (the first row is used if the simulation epoch is
          before the first historical data record), otherwise, the predicted
          data source is used. Note: GMAT does not use any of the predicted
          data from the CSSI file.</para>
        </listitem>

        <listitem>
          <para>If you have selected the Schatten file for predicted data, if
          the simulation epoch is NOT in the CSSI file historical data, or the
          historical data source is set to constant values, then the data is
          used from the Schatten file.</para>
        </listitem>
      </itemizedlist>

      <para><emphasis>Constant Values</emphasis></para>

      <para><emphasis>GMAT supports constant flux and Geo-magnetic index
      values for all Earth density models. You configure GMAT to use those
      values for historical and predicted data as shown below using NRLMSISE00
      for the example.</emphasis></para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00
GMAT aForceModel.Drag.HistoricWeatherSource = 'ConstantFluxAndGeoMag'
GMAT aForceModel.Drag.PredictedWeatherSource = 'ConstantFluxAndGeoMag'
GMAT aForceModel.Drag.F107 = 150
GMAT aForceModel.Drag.F107A = 150
GMAT aForceModel.Drag.MagneticIndex = 3
</programlisting>

      <para><emphasis>Historical Space Weather Data</emphasis></para>

      <para>You can provide a Center for Space Standards and Innovation (CSSI)
      file for historical space weather data. GMAT does not use the predicted
      portion of the file but does use the historical portion of the data. The
      CCSI file format is described in detail at the <link
      xlink:href="https://celestrak.com/SpaceData/">Celestrak</link> website
      and the files are available for download at that site and <link
      xlink:href="ftp://ftp.agi.com/pub/DynamicEarthData/">here</link>. You
      configure GMAT to use historical data as shown below.</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00
GMAT aForceModel.Drag.HistoricWeatherSource = 'CSSISpaceWeatherFile'
GMAT aForceModel.Drag.CSSISpaceWeatherFile = 'CSSI_2004To2026.txt'
</programlisting>

      <para>You can provide a full or relative path to the file, or put the
      file in GMAT’s data file folders documented in the startup file
      help.</para>

      <para><emphasis>Predicted Space Weather Data</emphasis></para>

      <para>You configure GMAT to use Schatten predicted data as shown
      below</para>

      <programlisting>Create ForceModel aForceModel
GMAT aForceModel.Drag.AtmosphereModel = NRLMSISE00
GMAT aForceModel.Drag.PredictedWeatherSource = 'SchattenFile'
GMAT aForceModel.Drag.SchattenFile = 'SchattenPredict.txt'
GMAT aForceModel.Drag.SchattenErrorModel = 'Nominal'
GMAT aForceModel.Drag.SchattenTimingModel = 'NominalCycle'
</programlisting>

      <para>You can provide a full or relative path to the file, or put the
      file in GMAT’s data file folders documented in the startup file help.
      Additionally you can choose between <guilabel>Nominal</guilabel>,
      <guilabel>PlusTwoSigma</guilabel>, and
      <guilabel>MinusTwoSigma</guilabel> for the
      <guilabel>SchattenErrorModel</guilabel>, and between
      <guilabel>NominalCycle</guilabel>, <guilabel>EarlyCycle</guilabel>, and
      <guilabel>LateCycle</guilabel> for the
      <guilabel>SchattenTimingModel</guilabel>.</para>

      <para>The Schatten file is distributed by the Flight Dynamics Facility
      (FDF) at Goddard Space Flight Center. You can apply for an account to
      obtain Schatten file updates at the <link
      xlink:href="http://fdf.gsfc.nasa.gov/forms">FDF Forms Interface</link>.
      Note that GMAT reads the raw file containing all permutation of mean, +2
      sigma, and -2 sigma, and nominal, early and late solar cycles. The files
      from the FDF must be modified to include keywords that indicate when
      data starts and ends as shown below:</para>

      <programlisting>           NOMINAL TIMING      EARLY TIMING        LATE TIMING      
 mo. yr.  mean +2sig -2sig ap mean +2sig -2sig ap mean +2sig -2sig ap
BEGIN_DATA 
  2 2011    92  107   76    9  105  125   85   10   77   87   66    8
  3 2011    93  110   77    9  106  128   86   10   79   89   67    8
  4 2011    95  112   78    9  108  129   87   10   80   92   69    8
END_DATA
</programlisting>

      <para>Data must be formatted according to FORMAT(I3,I5,I6,11I5), and no
      comments or blank lines can occur between the BEGIN_DATA and END_DATA
      keywords.</para>

      <para><emphasis>Configuring SRP Models</emphasis></para>

      <para>GMAT supports a spherical SRP model, and an SRP file for high
      fidelity SRP modelling. Both models use a dual cone model for central
      body shadowing of the spacecraft. See the <xref
      linkend="SpacecraftBallisticMass" xrefstyle="select:title"/>
      documentation for configuring a SPAD file for a spacecraft. The script
      snippet below shows how to configure two
      <guilabel>ForceModels</guilabel>, one that use
      <guilabel>Spherical</guilabel> and on that uses a
      <guilabel>SPADFile</guilabel>.</para>

      <programlisting>% A spherical SRP model
Create ForceModel aForceModel_1
aForceModel_1.PrimaryBodies = {Earth}
aForceModel_1.SRP = On
aForceModel_1.SRP.Model = Spherical

% A SPAD SRP model
Create ForceModel aForceModel_2
aForceModel_2.PrimaryBodies = {Earth}
aForceModel_2.SRP = On
aForceModel_2.SRP.Model = SPADFile
</programlisting>

      <para>You can define the solar flux using two approaches which are
      currently only supported in the script interface. One approach is to
      define the flux value using the <guilabel>SRP.Flux</guilabel> field and
      the value of an astronomical unit (in km) using the
      <guilabel>Nominal_Sun</guilabel> field as shown in the following
      example.</para>

      <programlisting>Create ForceModel aForceModel
aForceModel.PrimaryBodies = {Earth}
aForceModel.SRP = On
aForceModel.SRP.Flux = 1367
aForceModel.SRP.Nominal_Sun = 149597870.691</programlisting>

      <para>An alternative approach is to define the flux pressure at 1
      astronomical unit using the <guilabel>Flux_Pressure</guilabel> field as
      shown below..</para>

      <programlisting>Create ForceModel aForceModel
aForceModel.PrimaryBodies = {Earth}
aForceModel.SRP = On
aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006
aForceModel.SRP.Nominal_Sun = 149597870.691</programlisting>

      <para>If you mix flux settings, as shown in the example below, GMAT will
      use the last approach in the script. Here, GMAT will use the
      <guilabel>Flux_Pressure</guilabel> setting.</para>

      <programlisting>Create ForceModel aForceModel
aForceModel.PrimaryBodies = {Earth}
aForceModel.SRP = On
aForceModel.SRP.Flux = 1370
aForceModel.SRP.Nominal_Sun = 149597870
aForceModel.SRP.Flux_Pressure = 4.53443218374393e-006</programlisting>

      <caution>
        <para>Caution: GMAT’s default option for configuring solar flux for an
        SRP model is to use <guilabel>SRP.Flux</guilabel> and<guilabel>
        Nominal_Sun</guilabel> fields. If you initially configured the
        <guilabel>Flux_Pressure</guilabel> field, when you save your mission
        via the save button in the toolbar, GMAT will write out
        <guilabel>SRP.Flux</guilabel> and <guilabel>Nominal_Sun</guilabel>
        values consistent with your setting of
        <guilabel>Flux_Pressure</guilabel>.</para>
      </caution>

      <para><emphasis>Variational Equations and the STM </emphasis></para>

      <para>GMAT can optionally propagate the orbit State Transition Matrix
      (STM). For more information on how to configure GMAT to compute the STM,
      see the Propagate command documentation.</para>

      <caution>
        <para>Caution: GMAT allows you to propagate the State Transition
        Matrix (STM) along with the orbital state. However, not all
        variational terms are implemented for STM propagation. The following
        are implemented: point mass perturbation, spherical harmonics (with
        tide models), and solar radiation pressure. The following are NOT
        implemented: drag and relativistic terms, and finite burns.
        Additionally, the SRP variational term does not include the partial
        derivative of the percent shadow with respect to orbital state. This
        approximation is acceptable for orbits with short penumbra durations
        but is inaccurate for orbits that spend relatively long periods of
        time in penumbra.</para>
      </caution>
    </refsection>

    <refsection>
      <title>Examples</title>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for point mass
        propagation.</para>

        <programlisting><code>Create Spacecraft aSat

Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PointMasses = {Earth}

Create Propagator aProp
aProp.FM = aForceModel

BeginMissionSequence

Propagate aProp(aSat) {aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for high fidelity low Earth
        orbit propagation.</para>

        <programlisting><code>Create Spacecraft aSat

Create ForceModel aForceModel
aForceModel.CentralBody = Earth
aForceModel.PrimaryBodies = {Earth}
aForceModel.PointMasses = {Sun, Luna}
aForceModel.SRP = On
aForceModel.RelativisticCorrection = On
aForceModel.ErrorControl = RSSStep
aForceModel.GravityField.Earth.Degree = 20
aForceModel.GravityField.Earth.Order = 20
aForceModel.GravityField.Earth.PotentialFile = 'EGM96.cof'
aForceModel.GravityField.Earth.EarthTideModel = 'None'
aForceModel.Drag.AtmosphereModel = MSISE90
aForceModel.Drag.F107 = 150
aForceModel.Drag.F107A = 150
aForceModel.Drag.MagneticIndex = 3
aForceModel.SRP.Flux = 1359.388569998901
aForceModel.SRP.SRPModel = Spherical;
aForceModel.SRP.Nominal_Sun = 149597870.691

Create Propagator aProp
aProp.FM = aForceModel

BeginMissionSequence

Propagate aProp(aSat){aSat.ElapsedDays = .2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> that uses a SPAD SRP
        File.</para>

        <programlisting><code>Create Spacecraft aSpacecraft;
aSpacecraft.DryMass   = 2000
aSpacecraft.SPADSRPFile = '..\data\vehicle\spad\SphericalModel.spo'
aSpacecraft.SPADSRPScaleFactor = 1;

Create ForceModel aFM;
aFM.SRP = On;
aFM.SRP.SRPModel = SPADFile

Create Propagator aProp;
aProp.FM = aFM;

BeginMissionSequence

Propagate aProp(aSpacecraft) {aSpacecraft.ElapsedDays = 0.2}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>A <guilabel>ForceModel</guilabel> for high fidelity lunar orbit
        propagation.</para>

        <programlisting><code>Create Spacecraft moonSat
GMAT moonSat.DateFormat = UTCGregorian
GMAT moonSat.Epoch.UTCGregorian = 01 Jun 2004 12:00:00.000
GMAT moonSat.CoordinateSystem = MoonMJ2000Eq
GMAT moonSat.DisplayStateType = Cartesian
GMAT moonSat.X = -1486.792117191545200
GMAT moonSat.Y = 0.0
GMAT moonSat.Z = 1486.792117191543000
GMAT moonSat.VX = -0.142927729144255
GMAT moonSat.VY = -1.631407624437537
GMAT moonSat.VZ = 0.142927729144255

Create CoordinateSystem MoonMJ2000Eq
MoonMJ2000Eq.Origin = Luna
MoonMJ2000Eq.Axes   = MJ2000Eq

Create ForceModel MoonLP165P
GMAT MoonLP165P.CentralBody = Luna
GMAT MoonLP165P.PrimaryBodies = {Luna}
GMAT MoonLP165P.SRP = On
GMAT MoonLP165P.SRP.Flux = 1367
GMAT MoonLP165P.SRP.Nominal_Sun = 149597870.691
GMAT MoonLP165P.Gravity.Luna.PotentialFile = ../data/gravity/luna/LP165P.cof
GMAT MoonLP165P.Gravity.Luna.Degree = 20
GMAT MoonLP165P.Gravity.Luna.Order = 20

Create Propagator RKV89
GMAT RKV89.FM = MoonLP165P

BeginMissionSequence

Propagate RKV89(moonSat) {moonSat.ElapsedSecs = 300}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>

  <refsection xml:id="Propagator_SPKPropagator">
    <title>SPK-Configured Propagator</title>

    <indexterm>
      <primary>SPICE Orbit Propagation</primary>
    </indexterm>

    <refsection>
      <title>Description</title>

      <para>An SPK-configured <guilabel>Propagator</guilabel> propagates a
      spacecraft by interpolating user-provided SPICE kernels. You configure a
      <guilabel>Propagator</guilabel> to use an SPK kernel by setting the
      <guilabel>Type</guilabel> field to <guilabel>SPK</guilabel>. SPK kernels
      and the <guilabel>NAIFId</guilabel> are defined on the
      <guilabel>Spacecraft</guilabel> Resource. You control propagation,
      including stopping conditions, using the <guilabel>Propagate</guilabel>
      command. This resource cannot be modified in the Mission Sequence.
      However, you can do whole object assignment in the mission,( i.e.
      <literal>myPropagator = yourPropagator</literal> ).</para>

      <para><phrase role="ref_seealso">See Also</phrase>: <xref
      linkend="Spacecraft"/>, <xref linkend="Propagate"/></para>
    </refsection>

    <refsection>
      <title>Fields</title>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colnum="1" colwidth="1.3*"/>

          <colspec colnum="2" colwidth="3*"/>

          <thead>
            <row>
              <entry>Field</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>CentralBody</guilabel></entry>

              <entry><para>The central body of propagation. This field has no
              effect for SPK or Code500 propagators.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Resource reference</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Celestial body</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>Earth</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>EpochFormat</guilabel></entry>

              <entry><para> Only used for an SPK or Code500 propagator. The
              format of the epoch contained in the
              <guilabel>StartEpoch</guilabel> field. </para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>A1ModJulian</guilabel>,
                      <guilabel>TAIModJulian</guilabel>,
                      <guilabel>UTCModJulian</guilabel>,
                      <guilabel>TTModJulian</guilabel>,
                      <guilabel>TDBModJulian</guilabel>,
                      <guilabel>A1Gregorian</guilabel>,
                      <guilabel>TAIGregorian</guilabel>,
                      <guilabel>TTGregorian</guilabel>,
                      <guilabel>UTCGregorian</guilabel>,
                      <guilabel>TDBGregorian</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>
                        <guilabel>A1ModJulian</guilabel>
                      </para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A unless Mod Julian and in that case Modified
                      Julian Date</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Start Epoch</guilabel></entry>

              <entry><para>Only used for an SPK or Code500 propagator. The
              initial epoch of propagation. When an epoch is provided that
              epoch is used as the initial epoch. When the keyword
              "FromSpacecraft" is provided, the start epoch is inherited from
              the spacecraft.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>"Gregorian: 04 Oct 1957 12:00:00.000 &lt;= Epoch
                      &lt;= 28 Feb 2100 00:00:00.000 Modified Julian: 6116.0
                      &lt;= Epoch &lt;= 58127.5 or "FromSpacecraft"</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>21545</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>StepSize</guilabel></entry>

              <entry><para> The step size for an SPK or Code500
              Propagator.</para> <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>300</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Type</guilabel></entry>

              <entry><para>Specifies the integrator or analytic propagator
              used to model time evolution of spacecraft motion. </para>
              <variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>PrinceDormand78</guilabel>,
                      <guilabel>PrinceDormand45</guilabel>,
                      <guilabel>RungeKutta89</guilabel>,<guilabel>RungeKutta68</guilabel>,
                      <guilabel>RungeKutta56</guilabel>,
                      <guilabel>BulirschStoer</guilabel>,
                      <guilabel>AdamsBashforthMoulton</guilabel>,
                      <guilabel>SPK, Code500</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>
                        <guilabel>RungeKutta89</guilabel>
                      </para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_EphemerisPropagator_GUI.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>To configure a <guilabel>Propagator</guilabel> to use SPK files,
      on the <guilabel>Propagator</guilabel> dialog box, select
      <guilabel>SPK</guilabel> in the <guilabel>Type</guilabel> menu. There
      are four fields you can configure for an SPK propagator including
      <guilabel>StepSize</guilabel>, <guilabel>CentralBody</guilabel>,
      <guilabel>EpochFormat</guilabel>, and <guilabel>StartEpoch</guilabel>.
      Note that changing the <guilabel>EpochFormat</guilabel> setting converts
      the input epoch to the selected format. You can also type
      <userinput>FromSpacecraft</userinput> into the
      <guilabel>StartEpoch</guilabel> field and the
      <guilabel>Propagator</guilabel> will use the epoch of the
      <guilabel>Spacecraft</guilabel> as the initial propagation epoch.</para>
    </refsection>

    <refsection>
      <title>Remarks</title>

      <para>To use an SPK-configured <guilabel>Propagator</guilabel>, you must
      specify the SPK kernels and <guilabel>NAIFId</guilabel> on the
      <guilabel>Spacecraft</guilabel>, configure a
      <guilabel>Propagator</guilabel> to use SPK files as opposed to numerical
      methods, and configure the <guilabel>Propagate</guilabel> command to use
      the configured SPK propagator. The subsections and examples below
      discuss each of these items in detail.</para>

      <refsection>
        <title>Configuring Spacecraft SPK Kernels</title>

        <para>To use an SPK-configured <guilabel>Propagator</guilabel>, you
        must add the SPK kernels to the <guilabel>Spacecraft</guilabel> and
        define the spacecraft's <guilabel>NAIFId</guilabel>. SPK Kernels for
        selected spacecraft are available <link
        xlink:href="http://naif.jpl.nasa.gov/naif/data_archived.html">here.</link>
        Two sample vehicle spk kernels, (GEOSat.bsp and MoonTransfer.bsp) are
        distributed with GMAT for example purposes. An example of how to add
        spacecraft kernels via the script interface is shown below.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
GMAT aSpacecraft.NAIFId = -123456789
GMAT aSpacecraft.OrbitSpiceKernelName = {...
                                    '..\data\vehicle\ephem\spk\GEOSat.bsp'}</code></programlisting>

        <para>To add <guilabel>Spacecraft</guilabel> SPK kernels via the
        GUI:</para>

        <procedure>
          <step>
            <para>On the <guilabel>Spacecraft</guilabel> dialog box, click the
            <guilabel>SPICE</guilabel> tab.</para>
          </step>

          <step>
            <para>Under the <guilabel>SPK Files</guilabel> list, click
            <guilabel>Add</guilabel>.</para>
          </step>

          <step>
            <para>Browse to locate and select the desired SPK file</para>
          </step>

          <step>
            <para>Repeat to add all necessary SPK kernels</para>
          </step>

          <step>
            <para>In the <guilabel>NAIF ID</guilabel> field, enter the
            spacecraft integer NAIF id number. Note: For a given mission, each
            spacecraft should have a unique NAIF ID if the spacecraft are
            propagated with an SPK propagator.</para>
          </step>
        </procedure>

        <screenshot>
          <mediaobject>
            <imageobject>
              <imagedata align="center" contentdepth="100%"
                         fileref="files/images/Resource_EphemerisPropagator_GUI_2.png"
                         scalefit="1" width="100%"/>
            </imageobject>
          </mediaobject>
        </screenshot>

        <para>You can add more than one kernel to a spacecraft as shown via
        scripting below, where the files GEOSat1.bsp and GEOSat2.bsp are dummy
        file names used for example purposes only and are not distributed with
        GMAT. In the script, you can use relative path or absolute path to
        define the location of an SPK file. Relative paths are defined with
        respect to the GMAT bin directory of your local installation.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
aSpacecraft.OrbitSpiceKernelName ={'C:\MyDataFiles\GEOSat1.bsp',...
                                   'C:\MyDataFiles\GEOSat2.bsp'}</code></programlisting>
      </refsection>

      <refsection>
        <title>Configuring an SPK Propagator</title>

        <para>You can define the <guilabel>StartEpoch</guilabel> of
        propagation of an SPK-configured <guilabel>Propagator</guilabel> on
        either the <guilabel>Propagator</guilabel> Resource or inherit the
        <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel>. Below is a script snippet that shows
        how to inherit the <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel>. To inherit the
        <guilabel>StartEpoch</guilabel> from the
        <guilabel>Spacecraft</guilabel> using the GUI</para>

        <procedure>
          <step>
            <para>Open the SPK propagator dialog box,</para>
          </step>

          <step>
            <para>In the <guilabel>StartEpoch</guilabel> field., type
            <userinput>FromSpacecraft</userinput> or select
            <guilabel>FromSpacecraft</guilabel> from the drop-down menu</para>
          </step>
        </procedure>

        <para>To explicitly define the <guilabel>StartEpoch</guilabel> on the
        <guilabel>Propagator</guilabel> Resource use the following
        syntax.</para>

        <programlisting><code>Create Propagator spkProp
spkProp.EpochFormat = 'UTCGregorian'
spkProp.StartEpoch = '22 Jul 2014 11:29:10.811'

Create Propagator spkProp2
spkProp2.EpochFormat = 'TAIModJulian'
spkProp2.StartEpoch = '23466.5'</code></programlisting>

        <para>To configure the step size, use the StepSize field.</para>

        <programlisting><code>Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
</code></programlisting>
      </refsection>

      <refsection>
        <title xml:id="Ephemeris_Prop_Interaction">Interaction with the
        Propagate Command</title>

        <para>An SPK-configured <guilabel>Propagator</guilabel> works with the
        <guilabel>Propagate</guilabel> command in the same way numerical
        propagators work with the <guilabel>Propagate</guilabel> command with
        the following exceptions:</para>

        <itemizedlist>
          <listitem>
            <para>If a <guilabel>Propagate</guilabel> command uses an SPK
            propagator, then you can only propagate one spacecraft using that
            propagator. You can however, mix SPK propagators and numeric
            propagators in a single propagate command.</para>
          </listitem>

          <listitem>
            <para>SPK-configured <guilabel>Propagators</guilabel> will not
            propagate the STM or compute the orbit Jacobian (A matrix).</para>
          </listitem>
        </itemizedlist>

        <para>In the example below, we assume a
        <guilabel>Spacecraft</guilabel> named <guilabel>aSpacecraf</guilabel>t
        and a <guilabel>Propagator</guilabel> named
        <guilabel>spkProp</guilabel> have been configured a-priori. An example
        command to propagate <guilabel>aSpacecraft</guilabel> to Earth
        Periapsis using <guilabel>spkProp</guilabel> is shown below.</para>

        <programlisting><code>Propagate spkProp(aSpacecraft) {aSpacecraft.Earth.Periapsis}</code></programlisting>

        <para>Below is a script snippet that demonstrates how to propagate
        backwards using an SPK propagator.</para>

        <programlisting><code>Propagate BackProp spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = -1.5}</code></programlisting>
      </refsection>

      <refsection>
        <title>Behavior Near Ephemeris Boundaries</title>

        <para>In general, ephemeris interpolation is less accurate near the
        boundaries of ephemeris files and we recommend providing ephemeris for
        significant periods beyond the initial and final epochs of your
        application for this and other reasons. When propagating near the
        beginning or end of ephemeris files, the use of the double precision
        arithmetic may affect results. For example, if an ephemeris file has
        has an initial epoch TDBModJulian = 21545.00037249916, and you specify
        the StartEpoch in UTC Gregorian, round off error in time conversions
        and/or truncation of time using the Gregorian format (only accurate to
        millisecond) may cause the requested epoch to fall slightly outside of
        the range provided on the ephemeris file. The best solution is to
        provide extra ephemeris data to avoid time issues at the boundaries
        and the more subtle issue of poor interpolation.</para>

        <warning>
          <para>To locate requested stopping conditions, GMAT needs to bracket
          the root of the stopping condition function. Then, GMAT uses
          standard root finding techniques to locate the stopping condition to
          the requested accuracy. If the requested stopping condition lies at
          or near the beginning or end of the ephemeris data, then bracketing
          the stopping condition may not be possible without stepping off the
          ephemeris file which throw an error and execution will stop. In this
          case, you must provide more ephemeris data to locate the desired
          stopping condition.</para>
        </warning>
      </refsection>
    </refsection>

    <refsection>
      <title>Examples</title>

      <informalexample>
        <para>Propagate a GEO spacecraft using an SPK-configured
        <guilabel>Propagator</guilabel>. Define the
        <guilabel>StartEpoch</guilabel> from the spacecraft. Note: the SPK
        kernel GEOSat.bsp is distributed with GMAT.</para>

        <programlisting><code>Create Spacecraft aSpacecraft;
aSpacecraft.Epoch.UTCGregorian = '02 Jun 2004 12:00:00.000'
aSpacecraft.NAIFId = -123456789
aSpacecraft.OrbitSpiceKernelName = {'..\data\vehicle\ephem\spk\GEOSat.bsp'}

Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
spkProp.CentralBody = Earth
spkProp.StartEpoch = FromSpacecraft

Create OrbitView EarthView
EarthView.Add = {aSpacecraft, Earth, Luna}
EarthView.ViewPointVector = [ 30000 -20000 10000 ]
EarthView.ViewScaleFactor = 2.5

BeginMissionSequence
Propagate spkProp(aSpacecraft) {aSpacecraft.TA = 90}
Propagate spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = 2.4}</code></programlisting>
      </informalexample>

      <informalexample>
        <para>Simulate a lunar transfer using an SPK-configured
        <guilabel>Propagator</guilabel>. Define
        <guilabel>StartEpoch</guilabel> on the
        <guilabel>Propagator</guilabel>. Note: the SPK kernel MoonTransfer.bsp
        is distributed with GMAT.</para>

        <programlisting><code>Create Spacecraft aSpacecraft
aSpacecraft.NAIFId = -123456789
aSpacecraft.OrbitSpiceKernelName = {...
                          '..\data\vehicle\ephem\spk\MoonTransfer.bsp'}

Create Propagator spkProp
spkProp.Type = SPK
spkProp.StepSize = 300
spkProp.CentralBody = Earth
spkProp.EpochFormat = 'UTCGregorian'
spkProp.StartEpoch = '22 Jul 2014 11:29:10.811'

Create OrbitView EarthView
EarthView.Add = {aSpacecraft, Earth, Luna}
EarthView.ViewPointVector = [ 30000 -20000 10000 ]
EarthView.ViewScaleFactor = 30

BeginMissionSequence
Propagate spkProp(aSpacecraft) {aSpacecraft.ElapsedDays = 12}</code></programlisting>
      </informalexample>
    </refsection>
  </refsection>

  <refsection xml:id="Propagator_Code500Propagator">
    <title>Code500 Ephemeris-Configured Propagator</title>

    <indexterm>
      <primary>Code500 Ephemeris Orbit Propagation</primary>
    </indexterm>

    <refsection>
      <title>Description</title>

      <para>A Code500 ephemeris-configured <guilabel>Propagator</guilabel>
      propagates a spacecraft by interpolating or stepping along a
      user-provided Code500-format binary ephemeris file. You configure a
      <guilabel>Propagator</guilabel> to use a Code500 ephemeris by setting
      the <guilabel>Type</guilabel> field to <guilabel>Code500</guilabel>. The
      Code500 ephemeris file is specified on the
      <guilabel>Spacecraft.EphemerisName</guilabel> resource. The user
      controls propagation, including stopping conditions, using the
      <guilabel>Propagate</guilabel> command. This resource cannot be modified
      in the Mission Sequence. However, you can do whole object assignment in
      the mission sequence, (i.e. <literal>myPropagator =
      yourPropagator</literal> ).</para>

      <para>The <guilabel>Propagator</guilabel>
      <guilabel>CentralBody</guilabel> option is not applicable to the Code500
      propagator and should not be used with the Code500 propagator type. GMAT
      will automatically detect and use the central body of the ephemeris
      file. The <guilabel>Propagate</guilabel> command should be used to
      traverse the ephemeris file. GMAT will throw an error message and
      terminate when attempting to propagate outside the bounds of the
      ephemeris file.</para>

      <para>Code500 ephemeris files are binary-format files. As discussed in
      the <xref linkend="EphemerisFile"/> help, GMAT can generate Code500
      ephemeris files in both PC (little-endian) and UNIX (big-endian) binary
      format (via <guilabel>EphemerisFile.OutputFormat</guilabel>). The
      Code500 propagator, however, only permits little-endian formatted
      files.</para>

      <para><phrase role="ref_seealso">See Also</phrase>: <xref
      linkend="Spacecraft"/>, <xref linkend="Propagate"/>, <xref
      linkend="EphemerisFile"/></para>
    </refsection>

    <refsection>
      <title>Fields</title>

      <para>The only <guilabel>Propagator</guilabel> fields applicable to the
      Code500 ephemeris propagator are <guilabel>EpochFormat</guilabel>,
      <guilabel>StartEpoch</guilabel>, <guilabel>StepSize</guilabel> and
      <guilabel>Type</guilabel>.</para>

      <informaltable colsep="0" frame="topbot">
        <tgroup cols="2">
          <colspec colwidth="1.3*"/>

          <colspec colwidth="3*"/>

          <thead>
            <row>
              <entry>Field</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><guilabel>EpochFormat</guilabel></entry>

              <entry><para> Only used for an SPK or Code500 propagator.
              Specifies format of the epoch contained in the
              <guilabel>StartEpoch</guilabel> field. </para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>A1ModJulian</guilabel>,
                      <guilabel>TAIModJulian</guilabel>,
                      <guilabel>UTCModJulian</guilabel>,
                      <guilabel>TTModJulian</guilabel>,
                      <guilabel>TDBModJulian</guilabel>,
                      <guilabel>A1Gregorian</guilabel>,
                      <guilabel>TAIGregorian</guilabel>,
                      <guilabel>TTGregorian</guilabel>,
                      <guilabel>UTCGregorian</guilabel>,
                      <guilabel>TDBGregorian</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>A1ModJulian</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A unless Mod Julian and in that case Modified
                      Julian Date</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Start Epoch</guilabel></entry>

              <entry><para>Only used for an SPK or Code500 propagator.
              Specifies initial epoch of propagation. When an epoch is
              provided that epoch is used as the initial epoch. When the
              keyword <userinput>FromSpacecraft</userinput> is provided, the
              start epoch is inherited from the
              spacecraft.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>String</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>"Gregorian: 04 Oct 1957 12:00:00.000 &lt;= Epoch
                      &lt;= 28 Feb 2100 00:00:00.000 Modified Julian: 6116.0
                      &lt;= Epoch &lt;= 58127.5 or "FromSpacecraft"</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>21545</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>StepSize</guilabel></entry>

              <entry><para>The step size for an Code500 Propagator. GMAT will
              use this step size when traversing the ephemeris file,
              regardless of the internal step size of the ephemeris. GMAT will
              perform interpolation between vectors on the file as
              needed.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Real</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para>Real &gt; 0</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para>300</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>

            <row>
              <entry><guilabel>Type</guilabel></entry>

              <entry><para>Specifies the integrator or analytic propagator
              used to model time evolution of spacecraft motion. Specify
              <guilabel>Code500</guilabel> for a Code500 ephemeris
              propagator.</para><variablelist>
                  <varlistentry>
                    <term>Data Type</term>

                    <listitem>
                      <para>Enumeration</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Allowed Values</term>

                    <listitem>
                      <para><guilabel>PrinceDormand78</guilabel>,
                      <guilabel>PrinceDormand45</guilabel>,
                      <guilabel>RungeKutta89</guilabel>,<guilabel>RungeKutta68</guilabel>,
                      <guilabel>RungeKutta56</guilabel>,
                      <guilabel>BulirschStoer</guilabel>,
                      <guilabel>AdamsBashforthMoulton</guilabel>,
                      <guilabel>SPK, Code500</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Access</term>

                    <listitem>
                      <para>set</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Default Value</term>

                    <listitem>
                      <para><guilabel>RungeKutta89</guilabel></para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Units</term>

                    <listitem>
                      <para>N/A</para>
                    </listitem>
                  </varlistentry>

                  <varlistentry>
                    <term>Interfaces</term>

                    <listitem>
                      <para>GUI, script</para>
                    </listitem>
                  </varlistentry>
                </variablelist></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </refsection>

    <refsection>
      <title>GUI</title>

      <screenshot>
        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Resource_EphemerisPropagator_Code500_GUI.png"
                       scalefit="1" width="100%"/>
          </imageobject>
        </mediaobject>
      </screenshot>

      <para>To configure a <guilabel>Propagator</guilabel> from the GMAT GUI
      to use Code500 ephemeris files, select and open a
      <guilabel>Propagator</guilabel> from the Resources tree. In the
      <guilabel>Integrator</guilabel> category select
      <guilabel>Code500</guilabel> from the <guilabel>Type</guilabel>
      drop-down box. This will display the Code500 propagator options dialog.
      There are four fields displayed for a Code500 propagator -
      <guilabel>StepSize</guilabel>, <guilabel>CentralBody</guilabel>,
      <guilabel>EpochFormat</guilabel>, and <guilabel>StartEpoch</guilabel>.
      Note that changing the <guilabel>EpochFormat</guilabel> setting converts
      the input epoch to the selected format. You can also type
      <userinput>FromSpacecraft</userinput> into the
      <guilabel>StartEpoch</guilabel> field and the
      <guilabel>Propagator</guilabel> will use the epoch of the
      <guilabel>Spacecraft</guilabel> as the initial propagation epoch. The
      <guilabel>CentralBody</guilabel> field is displayed to the user, but is
      unused when the integrator type is Code500.</para>
    </refsection>

    <refsection>
      <title>Remarks</title>

      <para>There is currently no GUI option to assign the Code500 ephemeris
      file to the <guilabel>Spacecraft</guilabel> resource. You must specify
      the Code500 ephemeris file on the
      <guilabel>Spacecraft</guilabel><guilabel>.EphemerisName</guilabel>
      parameter via script. The subsections below provide examples of how to
      do this.</para>

      <refsection>
        <title>Configuring Spacecraft Ephemeris Files</title>

        <para>To use a Code500 ephemeris-configured
        <guilabel>Propagator</guilabel>, you must add the Code500 ephemeris
        file to the <guilabel>Spacecraft</guilabel>. A sample spacecraft
        Code500 ephemeris, (<filename>sat_leo.ephem</filename>, in the
        <filename>data/vehicle/ephem/code500</filename> directory) is
        distributed with GMAT. This sample file has a span of 4/20/2015
        00:00:00 to 4/30/2015 00:00:00. An example of how to assign this
        ephemeris to a spacecraft is shown below. Relative paths are defined
        with respect to the GMAT <filename>bin</filename> directory of your
        local installation.</para>

        <programlisting><?db-font-size 80% ?><code>Create Spacecraft aSpacecraft

aSpacecraft.EphemerisName = '../data/vehicle/ephem/code500/sat_leo.ephem'

BeginMissionSequence</code></programlisting>

        <para>A spacecraft may have only one Code500 ephemeris assigned. There
        is currently no GUI option to add a Code500 ephemeris file to a
        spacecraft.</para>
      </refsection>

      <refsection>
        <title>Configuring a Code500 Ephemeris Propagator</title>

        <para>If you have assigned the ephemeris file to your spacecraft,
        configuring the propagator only requires assigning the
        <guilabel>Code500</guilabel> type and the desired step size on a
        <guilabel>Propagator</guilabel> resource. The central body of
        propagation will be the central body of the the ephemeris file. If
        desired, you may also specify an <guilabel>EpochFormat</guilabel> and
        <guilabel>StartEpoch</guilabel> on the propagator to specify an
        initial epoch from which to start propagation. The same effect can be
        accomplished with an independent <guilabel>Propagate</guilabel>
        command (see <xref linkend="Propagate"/>) to the desired starting
        epoch.</para>

        <programlisting><code>Create Propagator Code500Prop

Code500Prop.Type     = 'Code500'
Code500Prop.StepSize = 60.

BeginMissionSequence</code></programlisting>

        <para>The same remarks mentioned in the prior section on SPK
        propagators with regard to interaction with the
        <guilabel>Propagate</guilabel> command and behavior near ephemeris
        boundaries also apply to the Code500 ephemeris propagator.</para>
      </refsection>
    </refsection>

    <refsection>
      <title>Examples</title>

      <informalexample>
        <para>This example propagates a spacecraft using a Code500 ephemeris,
        defining the <guilabel>StartEpoch</guilabel> from the spacecraft. The
        ephemeris file used in this example is included in the GMAT
        distribution at the indicated location. The code below will run if you
        copy and paste it into a new GMAT script.</para>

        <programlisting><?db-font-size 80% ?><code>Create Spacecraft aSpacecraft

% Ephem file span is 4/20/2015 - 4/30/2015

aSpacecraft.EphemerisName = '../data/vehicle/ephem/code500/sat_leo.ephem'
aSpacecraft.DateFormat    = UTCGregorian
aSpacecraft.Epoch         = '22 Apr 2015 00:00:00.000'

Create Propagator Code500Prop

Code500Prop.Type       = 'Code500'
Code500Prop.StepSize   = 60.
Code500Prop.StartEpoch = 'FromSpacecraft'

Create ReportFile PropReport

PropReport.Filename     = 'EphemPropagator_Code500_ForwardProp.txt'
PropReport.WriteHeaders = True

BeginMissionSequence

While aSpacecraft.ElapsedDays &lt;= 1

    Propagate Code500Prop(aSpacecraft)

    Report PropReport aSpacecraft.UTCGregorian aSpacecraft.TAIModJulian ...
        aSpacecraft.X aSpacecraft.Y aSpacecraft.Z ...
        aSpacecraft.VX aSpacecraft.VY aSpacecraft.VZ

EndWhile</code></programlisting>
      </informalexample>

      <para>An additional, more detailed, example of use of the Code500
      ephemeris propagator is shown in the
      <filename>Ex_Code500_EphemerisCompare.script</filename> file provided in
      the <filename>samples\Navigation</filename> directory. This script
      generates a report showing the difference, in RIC coordinates, between
      the orbits in two different Earth-centered Code500 ephemeris
      files.</para>
    </refsection>
  </refsection>
</refentry>
