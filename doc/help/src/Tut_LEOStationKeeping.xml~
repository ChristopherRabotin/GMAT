<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="LEOStationKeeping"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>LEO Station Keeping</title>

  <section>
    <title>Objective and Overview</title>

    <para><emphasis role="bold">Final result:</emphasis> <link
    xlink:href="scripts/HohmannTransferDesign.script">HohmannTransferDesign.script</link></para>

    <para>In this tutorial, you will learn how to use control flow and
    targeting in GMAT to maintain a Low-Earth orbit in the presense of drag.
    The area-to-mass ratio of the spacecraft is large to cause a rapid
    lowering of the orbit semimajor axis for the sake of simulation time.
    However, the process used in this script is useful for generating delta-V
    estimates for LEO stationkeeping of real-world missions. The basic steps
    of this tutorial are:</para>

    <orderedlist>
      <listitem>
        <para>Create and configure a spacecraft, impulsive maneuver,
        propagator, XYPlot, and differential corrector.</para>
      </listitem>

      <listitem>
        <para>Create a conditional loop using a while statement that
        propagates for 10 days.</para>
      </listitem>

      <listitem>
        <para>Run the mission and observe the behavior if there is no orbit
        control strategy.</para>
      </listitem>

      <listitem>
        <para>Create a target sequence nested in an if statement that executes
        if altitude is below 342 km.</para>
      </listitem>

      <listitem>
        <para>Run the mission and observe the behavior of orbit semimajor
        axis.</para>
      </listitem>
    </orderedlist>
  </section>

  <section>
    <title>Creating and Configuring the Resource Tree</title>

    <para>In this section, you will configure a model of a LEO spacecraft, a
    propopagator , a maneuver, and an XY plot to visualize the SMA during the
    control sequence developed in the next section.</para>

    <section>
      <title>Creating the Spacecraft</title>

      <orderedlist>
        <listitem>
          <para>Starting from the Resource Tree, right-click on DefaultSC,
          select rename, and change the name to LEOsat.</para>
        </listitem>

        <listitem>
          <para>Right-click on LEOSat, locate the EpochFormat combo box, and
          change the Epoch Format to UTCGregorian.</para>
        </listitem>

        <listitem>
          <para>Set the Epoch to 05 Jan 01 2010 00:00:00.000</para>
        </listitem>

        <listitem>
          <para>Set the state using the following values: X = -4083.9 , Y =
          4691.8 , Z = -2576.7 , VX = -4.252 , VY = -5.509 , VZ =
          -3.284</para>
        </listitem>

        <listitem>
          <para>Verify the configuration against the screen capture below, make
          any changes necessary, and click Ok on the LEOsat dialog box.</para>
        </listitem>
      </orderedlist>

      <screenshot>
        <info>
          <title>Figure: LEOsat Spacecraft Object</title>
        </info>

        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Tut_LEO_LEOsatSpacecraftObject.png"
                       scalefit="1" width="100%"></imagedata>
          </imageobject>

          <caption>
            <para>Figure: LEOsat Spacecraft Object</para>
          </caption>
        </mediaobject>
      </screenshot>
    </section>

    <section>
      <title>Creating the Propagator</title>

      <orderedlist>
        <listitem>
          <para>Right-click on DefaultProp, select Rename, and change the name
          to LEOprop.</para>
        </listitem>

		<listitem>
          <para>Right-click on DefaultProp, and select Open. </para>
        </listitem>
		
        <listitem>
          <para>Locate the Drag Model group box and change the Atmosphere model to JacchiaRoberts.</para>
        </listitem>

        <listitem>
          <para> Click the select button to the right of the Point Masses list.  Add the Sun, and Luna as Point Masses to the right-hand side  list and click Ok.</para>
        </listitem>

        <listitem>
          <para> Check the Use Solar Radiation Pressure box</para>
        </listitem>
		
		<listitem>
          <para>Verify the configuration against the screen capture below, make
          any changes necessary, and click Ok on the LEOprop dialog box.</para>
        </listitem>
		
      </orderedlist>

      <screenshot>
        <info>
          <title>Figure: LEOprop Propagator Object</title>
        </info>

        <mediaobject>
          <imageobject>
            <imagedata align="center" contentdepth="100%"
                       fileref="files/images/Tut_LEO_LEOpropPropagatorObject.png"
                       scalefit="1" width="100%"></imagedata>
          </imageobject>

          <caption>
            <para>Figure: LEOprop Propagator Object</para>
          </caption>
        </mediaobject>
      </screenshot>
    </section>

    <section>
      <title>Creating the DifferentialCorrector and Maneuver</title>
      <para> We'll use the default configurations for a maneuver and a differential corrector so simply follow the steps below to create default
configurations of those objects.	  </para>
      <orderedlist>
        <listitem>
          <para>Locate the Solvers folder under the Resource Tree and expand it if it is minimized.</para>
        </listitem>
		 <listitem>
          <para>Right-click on the Boundary Value Solvers folder and select DifferentialCorrector.</para>
        </listitem>
	    <listitem>
          <para>Rename the new Differential Corrector DC using steps described above.</para>
        </listitem>
		<listitem>
          <para>Right-click on DefaultIB in the Burns folder, select Rename, and change the name to DeltaV.</para>
        </listitem>
      </orderedlist>
    </section>
  </section>

  <section>
    <title>Creating and Configuring the Mission Sequence</title>

    <para>Below is a figure illustrating the Mission Tree after you have
    completed the steps in this section. You will implement this mission in
    two primary stages. The first stage is to add a While loop to the mission
    sequence, put a propagate sequence in the While loop, and configure the
    loop to propagate for about 10 days. At this point, there will be no orbit
    control strategy implemented and upon running the mission you will see the
    SMA drop below the allowed value of 340 km. In the second stage, you will
    implement a control sequence to ensure SMA remains above about 340
    km.</para>

    <screenshot>
      <info>
        <title>Figure: The Resource Tree</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_TheMissionTree.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>
      </mediaobject>
    </screenshot>

    <orderedlist>
      <listitem>
        <para>Starting from the Mission Tree, right-click on Propagate1,
        select Insert After, locate Control Logic in the menu, and select
        While.</para>
      </listitem>

      <listitem>
        <para>Right-click on Propagate1 and select Delete.</para>
      </listitem>

      <listitem>
        <para>Right-click on While1, select Insert After, and select
        Propagate.</para>
      </listitem>

      <listitem>
        <para>After While1, insert another Propagate</para>

        <orderedlist>
          <listitem>
            <para>Remove the propagate's stopping condition parameter and
            condition so that both fields are blank</para>
          </listitem>
        </orderedlist>
      </listitem>

      <listitem>
        <para>Add the first of two If statements now</para>

        <orderedlist>
          <listitem>
            <para>Change the left hand side to LEOsat.Earth.SMA</para>
          </listitem>

          <listitem>
            <para>Change the right hand side to 6738.5</para>
          </listitem>
        </orderedlist>
      </listitem>

      <listitem>
        <para>Insert a Target at this point</para>
      </listitem>

      <listitem>
        <para>Append this with a Vary, a Maneuver, and an Achieve</para>

        <orderedlist>
          <listitem>
            <para>Change the Goal to LEOsat.Earth.SMA</para>
          </listitem>

          <listitem>
            <para>Set the Value as 6738.951134009997</para>
          </listitem>

          <listitem>
            <para>Set the Tolerance as 0.05</para>
          </listitem>
        </orderedlist>
      </listitem>

      <listitem>
        <para>Insert another If after EndIf1</para>

        <orderedlist>
          <listitem>
            <para>Set the left hand side as LEOsat.EarthMJ2000Eq.RAAN</para>
          </listitem>

          <listitem>
            <para>Change the right hand side to 279.709</para>
          </listitem>

          <listitem>
            <para>Add an '|' symbol under the 'If' to continue the
            statement</para>
          </listitem>

          <listitem>
            <para>Set the left hand side of this second expression to the same
            LEOsat.EarthMJ2000Eq.RAAN</para>
          </listitem>

          <listitem>
            <para>Set the Condition as greater than, '&gt;'</para>
          </listitem>

          <listitem>
            <para>Add 279.949 as the right hand side value</para>
          </listitem>
        </orderedlist>
      </listitem>

      <listitem>
        <para>Insert a final propagate after If2</para>

        <orderedlist>
          <listitem>
            <para>Set the stopping condition parameter as
            LEOsat.EarthMJ2000Eq.VZ</para>
          </listitem>
        </orderedlist>
      </listitem>

      <listitem>
        <para>Insert the last target now</para>
      </listitem>

      <listitem>
        <para>Append this target with another set of vary, maneuver, and
        achieve so as to match the previous sequence</para>

        <orderedlist>
          <listitem>
            <para>Change the Variable of Vary2 to DefaultIB.N</para>
          </listitem>

          <listitem>
            <para>Also set the lower of Vary 2 as -3.14159</para>
          </listitem>

          <listitem>
            <para>LEOsat.EarthMJ2000Eq.RAAN should be the Goal for
            Achieve2</para>
          </listitem>

          <listitem>
            <para>279.829547746 is Achieve2's Value</para>
          </listitem>
        </orderedlist>
      </listitem>
    </orderedlist>

    <screenshot>
      <info>
        <title>Figure: Propagate1 Propagate Command</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_Propagate1PropagateCommand.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Propagate1 Propagate Command</para>
        </caption>
      </mediaobject>
    </screenshot>

    <screenshot>
      <info>
        <title>Figure: While1 While Command</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_While1WhileCommand.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: While1 While Command</para>
        </caption>
      </mediaobject>
    </screenshot>

    <screenshot>
      <info>
        <title>Figure: If1 If Command</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_If1IfCommand.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: If1 If Command</para>
        </caption>
      </mediaobject>
    </screenshot>

    <screenshot>
      <info>
        <title>Figure: Vary1 Vary Command</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_Vary1VaryCommand.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Vary1 Vary Command</para>
        </caption>
      </mediaobject>
    </screenshot>

    <screenshot>
      <info>
        <title>Figure: Achieve1 Achieve Command</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_Achieve1AchieveCommand.png"
                     scalefit="1" width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Achieve1 Achieve Command</para>
        </caption>
      </mediaobject>
    </screenshot>
  </section>

  <section>
    <title>Running the Mission</title>

    <para>The views that you created are good for seeing how well the mission
    sequence is keeping LEOsat in its orbit. The SMA view shows some thickness
    to it while the RAAN view shows barely any at all. You may now try and
    change the mission parameters as outlined in the mission tree section to
    see how the spacecraft's drift is affected.</para>

    <screenshot>
      <info>
        <title>Figure: Output</title>
      </info>

      <mediaobject>
        <imageobject>
          <imagedata align="center" contentdepth="100%"
                     fileref="files/images/Tut_LEO_Output.png" scalefit="1"
                     width="100%"></imagedata>
        </imageobject>

        <caption>
          <para>Figure: Output</para>
        </caption>
      </mediaobject>
    </screenshot>
  </section>
</section>
