
%  Test data for Annular eclipse
Data = [  -360289.895402500   1804947.560213000   782531.466557400       26499993.124778342       -132757256.161143260       -57556647.433934323             46.675056824          0.365440911
   -360926.944579662   1804840.516161845   782485.061519991       26501780.776234128       -132756955.057288200       -57556516.901344009             46.675051456          0.365440891
   -361563.993747349   1804733.472179746   782438.656509861       26501780.776234128       -132756955.057288200       -57556516.901344009             46.675036775          0.365440834
   -362201.042905511   1804626.428266710   782392.251527013       26503568.423790973       -132756653.933435630       -57556386.360094532             46.675011841          0.365440738
   -362838.092054101   1804519.384422750   782345.846571451       26503568.423790973       -132756653.933435630       -57556386.360094532             46.674977584          0.365440604
   -363475.141193069   1804412.340647873   782299.441643181       26503568.423790973       -132756653.933435630       -57556386.360094532             46.429764136          0.365440431
   -364112.190322366   1804305.296942090   782253.036742205       26505356.067448612       -132756352.789585620       -57556255.810185902             44.694434872          0.365440221
   -364749.239441943   1804198.253305411   782206.631868529       26507143.707206756       -132756051.625738230       -57556125.251618125             42.366433345          0.365439971
   -365386.288551751   1804091.209737844   782160.227022156       26507143.707206756       -132756051.625738230       -57556125.251618125             39.654373451          0.365439684
   -366023.337651741   1803984.166239401   782113.822203092       26507143.707206756       -132756051.625738230       -57556125.251618125             36.787088755          0.365439358
   -366660.386741864   1803877.122810090   782067.417411339       26508931.343065128       -132755750.441893460       -57555994.684391223             33.955561513          0.365438994
   -367297.435822071   1803770.079449922   782021.012646903       26508931.343065128       -132755750.441893460       -57555994.684391223             30.982204237          0.365438591
   -367934.484892314   1803663.036158908   781974.607909788       26510718.975023445       -132755449.238051350       -57555864.108505197             28.125220072          0.365438151
   -368571.533952542   1803555.992937055   781928.203199998       26512506.603081428       -132755148.014211940       -57555733.523960091             25.294476979          0.365437671
   -369208.583002709   1803448.949784375   781881.798517538       26512506.603081428       -132755148.014211940       -57555733.523960091             22.399712867          0.365437154
   -369845.632042764   1803341.906700878   781835.393862412       26512506.603081428       -132755148.014211940       -57555733.523960091             19.572594690          0.365436598
   -370482.681072658   1803234.863686573   781788.989234623       26514294.228437498       -132754846.770173240       -57555602.930668317             16.933505314          0.365436004
   -371119.730092343   1803127.820741470   781742.584634178       26516081.848693971       -132754545.506339330       -57555472.328805044             14.388551781          0.365435371
   -371756.779101770   1803020.777865581   781696.180061080       26516081.848693971       -132754545.506339330       -57555472.328805044             11.859579713          0.365434701
   -372393.828100889   1802913.735058914   781649.775515333       26517869.465049274       -132754244.222508210       -57555341.718282729              9.557354584          0.365433992
   -373030.877089653   1802806.692321479   781603.370996943       26517869.465049274       -132754244.222508210       -57555341.718282729              7.320523652          0.365433244
   -373667.926068012   1802699.649653288   781556.966505912       26517869.465049274       -132754244.222508210       -57555341.718282729              5.269512838          0.365432458
   -374304.975035917   1802592.607054349   781510.562042247       26519657.077503126       -132753942.918679940       -57555211.099101357              3.503354552          0.365431634
   -374942.023993319   1802485.564524674   781464.157605950       26521444.686055247       -132753641.594854530       -57555080.471260987              1.981969706          0.365430772
   -375579.072940170   1802378.522064272   781417.753197028       26521444.686055247       -132753641.594854530       -57555080.471260987              0.732432601          0.365429871
   -376216.121876420   1802271.479673154   781371.348815484       26521444.686055247       -132753641.594854530       -57555080.471260987              0.007972503          0.365428932
   -376853.170802020   1802164.437351330   781324.944461323       26523232.290705353       -132753340.251032040       -57554949.834761590              0.000000000          0.365427955
   -377490.219716923   1802057.395098809   781278.540134548       26523232.290705353       -132753340.251032040       -57554949.834761590              0.000000000          0.365426939
   -378127.268621079   1801950.352915603   781232.135835166       26525019.891453166       -132753038.887212490       -57554819.189603209              0.000000000          0.365425885
   -378764.317514438   1801843.310801723   781185.731563180       26526807.488298409       -132752737.503395930       -57554688.535785846              0.000000000          0.365424792
   -379401.366396953   1801736.268757177   781139.327318595       26526807.488298409       -132752737.503395930       -57554688.535785846              0.000000000          0.365423662
   -380038.415268574   1801629.226781977   781092.923101415       26526807.488298409       -132752737.503395930       -57554688.535785846       0.000000000          0.365422493];

%  Test data for total eclipse
Data = [ -10942.332218761   91722.958587138   39766.769410345       26499993.124778342       -132757256.161143260       -57556647.433934323              0.000000000          7.272295796
   -11001.476242337   91716.551072217   39763.991412053       26501780.776234128       -132756955.057288200       -57556516.901344009              0.000000000          7.272331249
   -11060.616379675   91710.111219716   39761.199392526       26501780.776234128       -132756955.057288200       -57556516.901344009              0.000000000          7.272366717
   -11119.752609859   91703.639031429   39758.393352544       26503568.423790973       -132756653.933435630       -57556386.360094532              0.000000000          7.272402199
   -11178.884911973   91697.134509166   39755.573292891       26503568.423790973       -132756653.933435630       -57556386.360094532              0.000000000          7.272437695
   -11238.013265103   91690.597654745   39752.739214357       26503568.423790973       -132756653.933435630       -57556386.360094532              0.000000000          7.272473206
   -11297.137648334   91684.028469997   39749.891117735       26505356.067448612       -132756352.789585620       -57556255.810185902              0.000000000          7.272508732
   -11356.258040754   91677.426956762   39747.029003824       26507143.707206756       -132756051.625738230       -57556125.251618125              0.581463228          7.272544272
   -11415.374421451   91670.793116895   39744.152873427       26507143.707206756       -132756051.625738230       -57556125.251618125              4.035012044          7.272579826
   -11474.486769512   91664.126952258   39741.262727353       26507143.707206756       -132756051.625738230       -57556125.251618125              9.005259182          7.272615394
   -11533.595064027   91657.428464727   39738.358566417       26508931.343065128       -132755750.441893460       -57555994.684391223             14.843093559          7.272650977
   -11592.699284085   91650.697656188   39735.440391435       26508931.343065128       -132755750.441893460       -57555994.684391223             21.525928135          7.272686575
   -11651.799408778   91643.934528541   39732.508203232       26510718.975023445       -132755449.238051350       -57555864.108505197             28.589221636          7.272722187
   -11710.895417198   91637.139083693   39729.562002635       26512506.603081428       -132755148.014211940       -57555733.523960091             36.018958269          7.272757813
   -11769.987288436   91630.311323565   39726.601790478       26512506.603081428       -132755148.014211940       -57555733.523960091             43.851753623          7.272793453
   -11829.075001585   91623.451250090   39723.627567598       26512506.603081428       -132755148.014211940       -57555733.523960091             51.805614152          7.272829108
   -11888.158535741   91616.558865209   39720.639334838       26514294.228437498       -132754846.770173240       -57555602.930668317             59.590850982          7.272864777
   -11947.237869997   91609.634170877   39717.637093046       26516081.848693971       -132754545.506339330       -57555472.328805044             67.251888466          7.272900460
   -12006.312983450   91602.677169060   39714.620843075       26516081.848693971       -132754545.506339330       -57555472.328805044             74.812322183          7.272936158
   -12065.383855196   91595.687861734   39711.590585781       26517869.465049274       -132754244.222508210       -57555341.718282729             81.805356621          7.272971870
   -12124.450464332   91588.666250888   39708.546322028       26517869.465049274       -132754244.222508210       -57555341.718282729             88.337914502          7.273007596
   -12183.512789957   91581.612338520   39705.488052683       26517869.465049274       -132754244.222508210       -57555341.718282729             93.992278556          7.273043337
   -12242.570811171   91574.526126641   39702.415778617       26519657.077503126       -132753942.918679940       -57555211.099101357             98.260376659          7.273079092
   -12301.624507072   91567.407617274   39699.329500707       26521444.686055247       -132753641.594854530       -57555080.471260987            100.000000000          7.273114861
   -12360.673856762   91560.256812451   39696.229219837       26521444.686055247       -132753641.594854530       -57555080.471260987            100.000000000          7.273150644
   -12419.718839344   91553.073714217   39693.114936891       26521444.686055247       -132753641.594854530       -57555080.471260987            100.000000000          7.273186442
   -12478.759433919   91545.858324626   39689.986652763       26523232.290705353       -132753340.251032040       -57554949.834761590            100.000000000          7.273222253
   -12537.795619591   91538.610645747   39686.844368348       26523232.290705353       -132753340.251032040       -57554949.834761590            100.000000000          7.273258079
   -12596.827375465   91531.330679658   39683.688084548       26525019.891453166       -132753038.887212490       -57554819.189603209            100.000000000          7.273293919
   -12655.854680646   91524.018428447   39680.517802269       26526807.488298409       -132752737.503395930       -57554688.535785846            100.000000000          7.273329774
   -12714.877514241   91516.673894216   39677.333522423       26526807.488298409       -132752737.503395930       -57554688.535785846            100.000000000          7.273365642
   -12773.895855358   91509.297079077   39674.135245925       26526807.488298409       -132752737.503395930       -57554688.535785846            100.000000000          7.273401525
   -12832.909683103   91501.887985153   39670.922973697       26528595.081240796       -132752436.099582370       -57554557.873309515            100.000000000          7.273437421
   -12891.918976588   91494.446614578   39667.696706665       26530382.670280050       -132752134.675771880       -57554427.202174246            100.000000000          7.273473332
   -12950.923714921   91486.972969498   39664.456445759       26530382.670280050       -132752134.675771880       -57554427.202174246            100.000000000          7.273509257
   -13009.923877214   91479.467052071   39661.202191915       26532170.255415894       -132751833.231964440       -57554296.522380032            100.000000000          7.273545196
   -13068.919442579   91471.928864465   39657.933946073       26532170.255415894       -132751833.231964440       -57554296.522380032            100.000000000          7.273581150
   -13127.910390130   91464.358408858   39654.651709179       26532170.255415894       -132751833.231964440       -57554296.522380032            100.000000000          7.273617117
   -13186.896698980   91456.755687444   39651.355482183       26533957.837846711       -132751531.767958000       -57554165.833839275            100.000000000          7.273653098
   -13245.878348245   91449.120702422   39648.045266041       26535745.415174887       -132751230.284156840       -57554035.136727236            100.000000000          7.273689094
   -13304.855317040   91441.453456008   39644.721061712       26535745.415174887       -132751230.284156840       -57554035.136727236            100.000000000          7.273725103
   -13363.827584483   91433.753950425   39641.382870161       26535745.415174887       -132751230.284156840       -57554035.136727236            100.000000000          7.273761127
   -13422.795129691   91426.022187909   39638.030692359       26537532.988598809       -132750928.780358870       -57553904.430956304            100.000000000          7.273797165
   -13481.757931785   91418.258170709   39634.664529280       26539320.558118198       -132750627.256564160       -57553773.716526516            100.000000000          7.273833216
   -13540.715969884   91410.461901081   39631.284381903       26539320.558118198       -132750627.256564160       -57553773.716526516            100.000000000          7.273869282
   -13599.669223109   91402.633381297   39627.890251214       26541108.123732775       -132750325.712772670       -57553642.993437849            100.000000000          7.273905362
   -13658.617670582   91394.772613636   39624.482138201       26541108.123732775       -132750325.712772670       -57553642.993437849            100.000000000          7.273941455
   -13717.561291428   91386.879600393   39621.060043859       26541108.123732775       -132750325.712772670       -57553642.993437849            100.000000000          7.273977563
   -13776.500064769   91378.954343869   39617.623969187       26542895.685442265       -132750024.148984480       -57553512.261690356            100.000000000          7.274013685
   -13835.433969733   91370.996846380   39614.173915190       26544683.243246380       -132749722.565199640       -57553381.521284021            100.000000000          7.274049820
   -13894.362985444   91363.007110252   39610.709882875       26544683.243246380       -132749722.565199640       -57553381.521284021            100.000000000          7.274085970
   -13953.287091031   91354.985137822   39607.231873257       26544683.243246380       -132749722.565199640       -57553381.521284021            100.000000000          7.274122133
   -14012.206265622   91346.930931439   39603.739887354       26546470.797144841       -132749420.961418170       -57553250.772218876            100.000000000          7.274158311
   -14071.120488348   91338.844493463   39600.233926191       26546470.797144841       -132749420.961418170       -57553250.772218876            100.000000000          7.274194502
   -14130.029738338   91330.725826266   39596.713990796       26548258.347137369       -132749119.337640090       -57553120.014494926            100.000000000          7.274230707
   -14188.933994725   91322.574932228   39593.180082201       26550045.893223688       -132748817.693865430       -57552989.248112194            100.000000000          7.274266926
   -14247.833236642   91314.391813746   39589.632201446       26550045.893223688       -132748817.693865430       -57552989.248112194            100.000000000          7.274303159
   -14306.727443223   91306.176473222   39586.070349573       26550045.893223688       -132748817.693865430       -57552989.248112194            100.000000000          7.274339406
   -14365.616593603   91297.928913074   39582.494527631       26551833.435403515       -132748516.030094300       -57552858.473070696            100.000000000          7.274375667
   -14424.500666919   91289.649135729   39578.904736672       26553620.974875204       -132748214.346124320       -57552727.689282738            100.000000000          7.274411942
   -14483.379642309   91281.337143626   39575.300977754       26553620.974875204       -132748214.346124320       -57552727.689282738            100.000000000          7.274448230
   -14542.253498911   91272.992939214   39571.683251940       26555408.509241205       -132747912.642360200       -57552596.896923736            100.000000000          7.274484532
   -14601.122215864   91264.616524956   39568.051560298       26555408.509241205       -132747912.642360200       -57552596.896923736            100.000000000          7.274520848
   -14659.985772311   91256.207903324   39564.405903900       26555408.509241205       -132747912.642360200       -57552596.896923736            100.000000000          7.274557178
   -14718.844147393   91247.767076802   39560.746283822       26557196.039699867       -132747610.918599650       -57552466.095906012            100.000000000          7.274593522
   -14777.697320254   91239.294047884   39557.072701149       26558983.566250928       -132747309.174842720       -57552335.286229581            100.000000000          7.274629879
   -14836.545270038   91230.788819077   39553.385156966       26558983.566250928       -132747309.174842720       -57552335.286229581            100.000000000          7.274666251
   -14895.387975891   91222.251392899   39549.683652365       26558983.566250928       -132747309.174842720       -57552335.286229581            100.000000000          7.274702636
   -14954.225416960   91213.681771879   39545.968188444       26560771.088894092       -132747007.411089420       -57552204.467894450            100.000000000          7.274739034
   -15013.057572393   91205.079958557   39542.238766304       26560771.088894092       -132747007.411089420       -57552204.467894450            100.000000000          7.274775447
   -15071.884421340   91196.445955485   39538.495387053       26562558.607629083       -132746705.627339830       -57552073.640900634            100.000000000          7.274811873
   -15130.705942951   91187.779765224   39534.738051800       26564346.122455623       -132746403.823593940       -57551942.805248156            100.000000000          7.274848313
   -15189.522116378   91179.081390349   39530.966761664       26564346.122455623       -132746403.823593940       -57551942.805248156            100.000000000          7.274884767
   -15248.332920774   91170.350833446   39527.181517764       26564346.122455623       -132746403.823593940       -57551942.805248156            100.000000000          7.274921234
   -15307.138335293   91161.588097110   39523.382321228       26566133.633373428       -132746101.999851810       -57551811.960937038            100.000000000          7.274957715
   -15365.938339091   91152.793183950   39519.569173187       26567921.140382223       -132745800.156113460       -57551681.107967272            100.000000000          7.274994210
   -15424.732911325   91143.966096585   39515.742074775       26567921.140382223       -132745800.156113460       -57551681.107967272            100.000000000          7.275030718
   -15483.522031153   91135.106837645   39511.901027135       26569708.643481731       -132745498.292378960       -57551550.246338889            100.000000000          7.275067240
   -15542.305677734   91126.215409771   39508.046031412       26569708.643481731       -132745498.292378960       -57551550.246338889            100.000000000          7.275103776
   -15601.083830229   91117.291815616   39504.177088757       26569708.643481731       -132745498.292378960       -57551550.246338889            100.000000000          7.275140325
   -15659.856467800   91108.336057845   39500.294200324       26571496.142671660       -132745196.408648310       -57551419.376051903            100.000000000          7.275176888
   -15718.623569610   91099.348139132   39496.397367276       26573283.639150351       -132744894.504719090       -57551288.497018561            100.000000000          7.275213465
   -15777.385114823   91090.328062165   39492.486590775       26573283.639150351       -132744894.504719090       -57551288.497018561            100.000000000          7.275250055
   -15836.141082605   91081.275829641   39488.561871994       26573283.639150351       -132744894.504719090       -57551288.497018561            100.000000000          7.275286659
   -15894.891452124   91072.191444269   39484.623212106       26575071.130520295       -132744592.580996260       -57551157.609414391            100.000000000          7.275323276
   -15953.636202547   91063.074908770   39480.670612293       26575071.130520295       -132744592.580996260       -57551157.609414391            100.000000000          7.275359907
   -16012.375313045   91053.926225875   39476.704073737       26576858.617979828       -132744290.637277380       -57551026.713151678            100.000000000          7.275396551
   -16071.108762788   91044.745398327   39472.723597631       26578646.101528671       -132743988.673562510       -57550895.808230415            100.000000000          7.275433209
   -16129.836530950   91035.532428881   39468.729185166       26578646.101528671       -132743988.673562510       -57550895.808230415            100.000000000          7.275469881
   -16188.558596703   91026.287320302   39464.720837545       26578646.101528671       -132743988.673562510       -57550895.808230415            100.000000000          7.275506566
   -16247.274939223   91017.010075366   39460.698555969       26580433.581166543       -132743686.689851670       -57550764.894650608            100.000000000          7.275543264
   -16305.985537687   91007.700696862   39456.662341650       26582221.056893166       -132743384.686144920       -57550633.972412296            100.000000000          7.275579976
   -16364.690371273   90998.359187589   39452.612195801       26582221.056893166       -132743384.686144920       -57550633.972412296            100.000000000          7.275616702
   -16423.389419158   90988.985550357   39448.548119640       26584008.528708253       -132743082.662442250       -57550503.041515484            100.000000000          7.275653440
   -16482.082660525   90979.579787988   39444.470114392       26584008.528708253       -132743082.662442250       -57550503.041515484            100.000000000          7.275690193
   -16540.770074556   90970.141903315   39440.378181286       26584008.528708253       -132743082.662442250       -57550503.041515484            100.000000000          7.275726959
   -16599.451640433   90960.671899182   39436.272321554       26585795.996611528       -132742780.618743750       -57550372.101960182            100.000000000          7.275763738
   -16658.127337341   90951.169778445   39432.152536436       26587583.460602708       -132742478.555049420       -57550241.153746411            100.000000000          7.275800531
   -16716.797144467   90941.635543970   39428.018827176       26587583.460602708       -132742478.555049420       -57550241.153746411            100.000000000          7.275837337
   -16775.461040999   90932.069198636   39423.871195020       26587583.460602708       -132742478.555049420       -57550241.153746411            100.000000000          7.275874157
   -16834.119006124   90922.470745332   39419.709641223       26589370.920681529       -132742176.471359300       -57550110.196874186            100.000000000          7.275910989
   -16892.771019035   90912.840186958   39415.534167042       26589370.920681529       -132742176.471359300       -57550110.196874186            100.000000000          7.275947836
   -16951.417058923   90903.177526426   39411.344773740       26591158.376847684       -132741874.367673430       -57549979.231343508            100.000000000          7.275984696
   -17010.057104981   90893.482766659   39407.141462586       26592945.830299493       -132741572.243789240       -57549848.257066593            100.000000000          7.276021569
   -17068.691136404   90883.755910592   39402.924234851       26592945.830299493       -132741572.243789240       -57549848.257066593            100.000000000          7.276058455
   -17127.319132389   90873.996961170   39398.693091814       26592945.830299493       -132741572.243789240       -57549848.257066593            100.000000000          7.276095355
   -17185.941072133   90864.205921350   39394.448034756       26594733.278639514       -132741270.100111980       -57549717.274219073            100.000000000          7.276132268
   -17244.556934836   90854.382794099   39390.189064966       26596520.723066039       -132740967.936439040       -57549586.282713167            100.000000000          7.276169194
   -17303.166699697   90844.527582398   39385.916183734       26596520.723066039       -132740967.936439040       -57549586.282713167            100.000000000          7.276206134
   -17361.770345921   90834.640289237   39381.629392359       26598308.163578790       -132740665.752770510       -57549455.282548867            100.000000000          7.276243087
   -17420.367852709   90824.720917618   39377.328692143       26598308.163578790       -132740665.752770510       -57549455.282548867            100.000000000          7.276280053
   -17478.959199268   90814.769470554   39373.014084391       26598308.163578790       -132740665.752770510       -57549455.282548867            100.000000000          7.276317033
   -17537.544364805   90804.785951068   39368.685570417       26600095.600177493       -132740363.549106390       -57549324.273726210            100.000000000          7.276354026
   -17596.123328526   90794.770362198   39364.343151535       26601883.032861866       -132740061.325446750       -57549193.256245211            100.000000000          7.276391032
   -17654.696069643   90784.722706989   39359.986829069       26601883.032861866       -132740061.325446750       -57549193.256245211            100.000000000          7.276428051
   -17713.262567367   90774.642988500   39355.616604344       26601883.032861866       -132740061.325446750       -57549193.256245211            100.000000000          7.276465084
   -17771.822800910   90764.531209800   39351.232478691       26603670.461631622       -132739759.081791590       -57549062.230105862            100.000000000          7.276502130
   -17830.376749487   90754.387373969   39346.834453447       26603670.461631622       -132739759.081791590       -57549062.230105862            100.000000000          7.276539189
   -17888.924392314   90744.211484100   39342.422529953       26605457.886486489       -132739456.818140980       -57548931.195308194            100.000000000          7.276576261
   -17947.465708608   90734.003543296   39337.996709554       26607245.307426184       -132739154.534494940       -57548800.151852220            100.000000000          7.276613346
   -18006.000677589   90723.763554671   39333.556993601       26607245.307426184       -132739154.534494940       -57548800.151852220            100.000000000          7.276650445
   -18064.529278477   90713.491521351   39329.103383450       26607245.307426184       -132739154.534494940       -57548800.151852220            100.000000000          7.276687556
   -18123.051490494   90703.187446471   39324.635880461       26609032.724450432       -132738852.230853480       -57548669.099737957            100.000000000          7.276724681
   -18181.567292865   90692.851333182   39320.154486000       26610820.137558945       -132738549.907216670       -57548538.038965411            100.000000000          7.276761819
   -18240.076664814   90682.483184642   39315.659201436       26610820.137558945       -132738549.907216670       -57548538.038965411            100.000000000          7.276798970
   -18298.579585569   90672.083004021   39311.150028146       26612607.546751443       -132738247.563584520       -57548406.969534606            100.000000000          7.276836134
   -18357.076034358   90661.650794501   39306.626967509       26612607.546751443       -132738247.563584520       -57548406.969534606            100.000000000          7.276873312
   -18415.565990412   90651.186559276   39302.090020910       26612607.546751443       -132738247.563584520       -57548406.969534606            100.000000000          7.276910502
   -18474.049432963   90640.690301550   39297.539189739       26614394.953226205       -132737945.199754360       -57548275.891357668            100.000000000          7.276947706
   -18532.526341244   90630.162024539   39292.974475390       26616182.354585838       -132737642.816131650       -57548144.804610379            100.000000000          7.276984922
   -18590.996694490   90619.601731469   39288.395879263       26616182.354585838       -132737642.816131650       -57548144.804610379            100.000000000          7.277022152
   -18649.460471938   90609.009425578   39283.803402763       26616182.354585838       -132737642.816131650       -57548144.804610379            100.000000000          7.277059395
   -18707.917652827   90598.385110116   39279.197047298       26617969.752028629       -132737340.412513730       -57548013.709204867            100.000000000          7.277096650
   -18766.368216396   90587.728788343   39274.576814282       26619757.145554282       -132737037.988900630       -57547882.605141163            100.000000000          7.277133919
   -18824.812141889   90577.040463532   39269.942705136       26619757.145554282       -132737037.988900630       -57547882.605141163            100.000000000          7.277171201
   -18883.249408547   90566.320138965   39265.294721282       26621544.535162527       -132736735.545292380       -57547751.492419273            100.000000000          7.277208495
   -18941.679995616   90555.567817936   39260.632864150       26621544.535162527       -132736735.545292380       -57547751.492419273            100.000000000          7.277245803
   -19000.103882344   90544.783503752   39255.957135172       26621544.535162527       -132736735.545292380       -57547751.492419273            100.000000000          7.277283124
   -19058.521047978   90533.967199728   39251.267535789       26623331.920853075       -132736433.081689000       -57547620.371039212            100.000000000          7.277320458
   -19116.931471769   90523.118909193   39246.564067442       26625119.302625660       -132736130.598090560       -57547489.241000980            100.000000000          7.277357804
   -19175.335132968   90512.238635487   39241.846731581       26625119.302625660       -132736130.598090560       -57547489.241000980            100.000000000          7.277395164
   -19233.732010830   90501.326381960   39237.115529658       26625119.302625660       -132736130.598090560       -57547489.241000980            100.000000000          7.277432536
   -19292.122084611   90490.382151973   39232.370463131       26626906.680479985       -132735828.094497070       -57547358.102304615            100.000000000          7.277469922
   -19350.505333566   90479.405948899   39227.611533464       26626906.680479985       -132735828.094497070       -57547358.102304615            100.000000000          7.277507320
   -19408.881736955   90468.397776124   39222.838742124       26628694.054415785       -132735525.570908560       -57547226.954950124            100.000000000          7.277544731
   -19467.251274039   90457.357637041   39218.052090584       26630481.424432769       -132735223.027325090       -57547095.798937522            100.000000000          7.277582156
   -19525.613924079   90446.285535059   39213.251580321       26630481.424432769       -132735223.027325090       -57547095.798937522            100.000000000          7.277619593
   -19583.969666341   90435.181473595   39208.437212818       26630481.424432769       -132735223.027325090       -57547095.798937522            100.000000000          7.277657042
   -19642.318480090   90424.045456078   39203.608989562       26632268.790530667       -132734920.463746710       -57546964.634266824            100.000000000          7.277694505
   -19700.660344594   90412.877485949   39198.766912045       26634056.153907709       -132734617.879970490       -57546833.460850082            100.000000000          7.277731981
   -19758.995239122   90401.677566659   39193.910981764       26634056.153907709       -132734617.879970490       -57546833.460850082            100.000000000          7.277769469
   -19817.323142945   90390.445701671   39189.041200222       26635843.512166578       -132734315.276402290       -57546702.278863221            100.000000000          7.277806970
   -19875.644035337   90379.181894460   39184.157568924       26635843.512166578       -132734315.276402290       -57546702.278863221            100.000000000          7.277844484
   -19933.957895572   90367.886148511   39179.260089382       26635843.512166578       -132734315.276402290       -57546702.278863221            100.000000000          7.277882011
   -19992.264702927   90356.558467320   39174.348763114       26637630.866505522       -132734012.652839260       -57546571.088218316            100.000000000          7.277919551
   -20050.564436681   90345.198854396   39169.423591640       26639418.216924243       -132733710.009281460       -57546439.888915375            100.000000000          7.277957103
   -20108.857076113   90333.807313257   39164.484576486       26639418.216924243       -132733710.009281460       -57546439.888915375            100.000000000          7.277994668
   -20167.142600507   90322.383847433   39159.531719184       26639418.216924243       -132733710.009281460       -57546439.888915375            100.000000000          7.278032246
   -20225.420989145   90310.928460468   39154.565021270       26641205.563422482       -132733407.345728870       -57546308.680954412            100.000000000          7.278069837
   -20283.692221315   90299.441155912   39149.584484284       26641205.563422482       -132733407.345728870       -57546308.680954412            100.000000000          7.278107440
   -20341.956276303   90287.921937330   39144.590109773       26642992.905999951       -132733104.662181590       -57546177.464335442            100.000000000          7.278145056
   -20400.213133399   90276.370808298   39139.581899286       26644780.244656362       -132732801.958639590       -57546046.239058480            100.000000000          7.278182685
   -20458.462771894   90264.787772402   39134.559854380       26644780.244656362       -132732801.958639590       -57546046.239058480            100.000000000          7.278220327
   -20516.705171083   90253.172833239   39129.523976614       26644780.244656362       -132732801.958639590       -57546046.239058480            100.000000000          7.278257981
   -20574.940310259   90241.525994419   39124.474267555       26646567.579391446       -132732499.235102970       -57545915.005123533            100.000000000          7.278295648
   -20633.168168720   90229.847259562   39119.410728771       26648354.910204921       -132732196.491571690       -57545783.762530632            100.000000000          7.278333327
   -20691.388725766   90218.136632299   39114.333361838       26648354.910204921       -132732196.491571690       -57545783.762530632            100.000000000          7.278371020
   -20749.601960696   90206.394116273   39109.242168337       26650142.237096500       -132731893.728045870       -57545652.511279784            100.000000000          7.278408724
   -20807.807852814   90194.619715138   39104.137149850       26650142.237096500       -132731893.728045870       -57545652.511279784            100.000000000          7.278446442
   -20866.006381424   90182.813432559   39099.018307969       26650142.237096500       -132731893.728045870       -57545652.511279784            100.000000000          7.278484172
   -20924.197525833   90170.975272212   39093.885644287       26651929.560065910       -132731590.944525470       -57545521.251371004            100.000000000          7.278521914
   -20982.381265350   90159.105237784   39088.739160404       26653716.880311359       -132731288.140807520       -57545389.982716285            100.000000000          7.278559670
   -21040.557579285   90147.203332976   39083.578857923       26653716.880311359       -132731288.140807520       -57545389.982716285            100.000000000          7.278597438
   -21098.726446950   90135.269561495   39078.404738455       26653716.880311359       -132731288.140807520       -57545389.982716285            100.000000000          7.278635218
   -21156.887847660   90123.303927065   39073.216803612       26655504.195435580       -132730985.317298130       -57545258.705491669            100.000000000          7.278673011
   -21215.041760731   90111.306433417   39068.015055015       26655504.195435580       -132730985.317298130       -57545258.705491669            100.000000000          7.278710816
   -21273.188165482   90099.277084294   39062.799494285       26657291.506636798       -132730682.473794310       -57545127.419609182            100.000000000          7.278748634
   -21331.327041233   90087.215883452   39057.570123052       26659078.813914720       -132730379.610296070       -57544996.125068814            100.000000000          7.278786465
   -21389.458367306   90075.122834658   39052.326942949       26659078.813914720       -132730379.610296070       -57544996.125068814            100.000000000          7.278824308
   -21447.582123025   90062.997941687   39047.069955614       26659078.813914720       -132730379.610296070       -57544996.125068814            100.000000000          7.278862164
   -21505.698287717   90050.841208330   39041.799162691       26660866.117269073       -132730076.726803470       -57544864.821870603            100.000000000          7.278900032
   -21563.806840710   90038.652638385   39036.514565827       26662653.416699570       -132729773.823316540       -57544733.510014541            100.000000000          7.278937912
   -21621.907761334   90026.432235664   39031.216166676       26662653.416699570       -132729773.823316540       -57544733.510014541            100.000000000          7.278975805
   -21680.001028922   90014.180003988   39025.903966894       26664440.712205939       -132729470.899835270       -57544602.189500645            100.000000000          7.279013711
   -21738.086622807   90001.895947192   39020.577968145       26664440.712205939       -132729470.899835270       -57544602.189500645            100.000000000          7.279051628
   -21796.164522327   89989.580069120   39015.238172095       26664440.712205939       -132729470.899835270       -57544602.189500645            100.000000000          7.279089559
   -21854.234706819   89977.232373628   39009.884580418       26666228.003787894       -132729167.956359800       -57544470.860328950            100.000000000          7.279127501
   -21912.297155625   89964.852864583   39004.517194790       26668015.291445162       -132728864.992890070       -57544339.522499450            100.000000000          7.279165457
   -21970.351848086   89952.441545863   38999.136016893       26668015.291445162       -132728864.992890070       -57544339.522499450            100.000000000          7.279203424
   -22028.398763547   89939.998421358   38993.741048415       26668015.291445162       -132728864.992890070       -57544339.522499450            100.000000000          7.279241404
   -22086.437881355   89927.523494969   38988.332291047       26669802.575177457       -132728562.009426160       -57544208.176012173            100.000000000          7.279279396
   -22144.469180859   89915.016770607   38982.909746485       26669802.575177457       -132728562.009426160       -57544208.176012173            100.000000000          7.279317401
   -22202.492641409   89902.478252196   38977.473416431       26671589.854984500       -132728259.005968080       -57544076.820867129            100.000000000          7.279355418
   -22260.508242357   89889.907943670   38972.023302591       26673377.132064477       -132727955.982312690       -57543945.456976235            100.000000000          7.279393447
   -22318.515963060   89877.305848974   38966.559406677       26673377.132064477       -132727955.982312690       -57543945.456976235            100.000000000          7.279431489
   -22376.515782875   89864.671972067   38961.081730405       26673377.132064477       -132727955.982312690       -57543945.456976235            100.000000000          7.279469543
   -22434.507681159   89852.006316914   38955.590275495       26675164.404020175       -132727652.938866410       -57543814.084515691            100.000000000          7.279507609
   -22492.491637276   89839.308887497   38950.085043673       26676951.672049779       -132727349.875426050       -57543682.703397438            100.000000000          7.279545688
   -22550.467630587   89826.579687805   38944.566036670       26676951.672049779       -132727349.875426050       -57543682.703397438            100.000000000          7.279583779
   -22608.435640459   89813.818721839   38939.033256222       26678738.936153021       -132727046.791991700       -57543551.313621469            100.000000000          7.279621882
   -22666.395646260   89801.025993614   38933.486704068       26678738.936153021       -132727046.791991700       -57543551.313621469            100.000000000          7.279659997
   -22724.347627359   89788.201507152   38927.926381954       26678738.936153021       -132727046.791991700       -57543551.313621469            100.000000000          7.279698125
   -22782.291563128   89775.345266490   38922.352291631       26680526.196329605       -132726743.688563350       -57543419.915187806            100.000000000          7.279736265
   -22840.227432942   89762.457275673   38916.764434852       26682313.452579260       -132726440.565141080       -57543288.508096471            100.000000000          7.279774417
   -22898.155216176   89749.537538759   38911.162813378       26682313.452579260       -132726440.565141080       -57543288.508096471            100.000000000          7.279812581
   -22956.074892210   89736.586059818   38905.547428974       26682313.452579260       -132726440.565141080       -57543288.508096471            100.000000000          7.279850758
   -23013.986440424   89723.602842928   38899.918283408       26684100.704901703       -132726137.421724890       -57543157.092347473            100.000000000          7.279888946
   -23071.889840200   89710.587892183   38894.275378456       26684100.704901703       -132726137.421724890       -57543157.092347473            100.000000000          7.279927147
   -23129.785070925   89697.541211683   38888.618715896       26685887.953296654       -132725834.258314850       -57543025.667940833            100.000000000          7.279965360
   -23187.672111984   89684.462805544   38882.948297513       26687675.197763834       -132725531.074910950       -57542894.234876558            100.000000000          7.280003585
   -23245.550942769   89671.352677888   38877.264125095       26687675.197763834       -132725531.074910950       -57542894.234876558            100.000000000          7.280041823
   -23303.421542670   89658.210832854   38871.566200437       26687675.197763834       -132725531.074910950       -57542894.234876558            100.000000000          7.280080072
   -23361.283891081   89645.037274588   38865.854525337       26689462.438302964       -132725227.871513260       -57542762.793154672            100.000000000          7.280118334
   -23419.137967399   89631.832007249   38860.129101598       26691249.674913764       -132724924.648121800       -57542631.342775181            100.000000000          7.280156607
   -23476.983751022   89618.595035006   38854.389931029       26691249.674913764       -132724924.648121800       -57542631.342775181            100.000000000          7.280194893
   -23534.821221351   89605.326362040   38848.637015444       26693036.908794381       -132724621.404533280       -57542499.883649945            100.000000000          7.280233191
   -23592.650357788   89592.025992544   38842.870356659       26693036.908794381       -132724621.404533280       -57542499.883649945            100.000000000          7.280271501
   -23650.471139739   89578.693930721   38837.089956499       26693036.908794381       -132724621.404533280       -57542499.883649945            100.000000000          7.280309823
   -23708.283546611   89565.330180784   38831.295816790       26694824.137547672       -132724318.141154360       -57542368.415955290            100.000000000          7.280348157
   -23766.087557814   89551.934746961   38825.487939367       26696611.362371791       -132724014.857781830       -57542236.939603083            100.000000000          7.280386503
   -23823.883152760   89538.507633487   38819.666326065       26696611.362371791       -132724014.857781830       -57542236.939603083            100.000000000          7.280424861
   -23881.670310864   89525.048844612   38813.830978727       26696611.362371791       -132724014.857781830       -57542236.939603083            100.000000000          7.280463231
   -23939.449011541   89511.558384593   38807.981899202       26698398.583266463       -132723711.554415660       -57542105.454593331            100.000000000          7.280501613
   -23997.219234210   89498.036257702   38802.119089340       26700185.800231401       -132723408.231055890       -57541973.960926056            100.000000000          7.280540007
   -24054.980958294   89484.482468220   38796.242550998       26700185.800231401       -132723408.231055890       -57541973.960926056             98.232751041          7.280578413
   -24112.734163215   89470.897020441   38790.352286039       26701973.013266325       -132723104.887702570       -57541842.458601266             93.947113661          7.280616831
   -24170.478828399   89457.279918667   38784.448296329       26701973.013266325       -132723104.887702570       -57541842.458601266             88.277615217          7.280655261
   -24228.214933275   89443.631167215   38778.530583739       26701973.013266325       -132723104.887702570       -57541842.458601266             81.731209579          7.280693703
   -24285.942457273   89429.950770411   38772.599150146       26703760.222370967       -132722801.524355750       -57541710.947618976             74.725425328          7.280732157
   -24343.661379825   89416.238732593   38766.653997431       26705547.427545026       -132722498.141015440       -57541579.427979216             67.314042062          7.280770623
   -24401.371680368   89402.495058108   38760.695127480       26705547.427545026       -132722498.141015440       -57541579.427979216             59.481377670          7.280809101
   -24459.073338339   89388.719751318   38754.722542184       26705547.427545026       -132722498.141015440       -57541579.427979216             51.520505781          7.280847590
   -24516.766333176   89374.912816593   38748.736243438       26707334.628788240       -132722194.737681700       -57541447.899681985             43.725145021          7.280886092
   -24574.450644324   89361.074258315   38742.736233144       26707334.628788240       -132722194.737681700       -57541447.899681985             35.886691346          7.280924605
   -24632.126251227   89347.204080879   38736.722513205       26709121.826100323       -132721891.314354540       -57541316.362727307             28.453776976          7.280963130
   -24689.793133331   89333.302288689   38730.695085534       26710909.019480992       -132721587.871034000       -57541184.817115195             21.390533203          7.281001667
   -24747.451270087   89319.368886161   38724.653952045       26710909.019480992       -132721587.871034000       -57541184.817115195             14.712330872          7.281040216
   -24805.100640946   89305.403877721   38718.599114657       26710909.019480992       -132721587.871034000       -57541184.817115195              8.770365952          7.281078777
   -24862.741225362   89291.407267809   38712.530575297       26712696.208929971       -132721284.407720130       -57541053.262845658              3.935454193          7.281117350
   -24920.373002793   89277.379060873   38706.448335892       26714483.395645376       -132720980.924209450       -57540921.699830495              0.573464485          7.281155934
   -24977.995952697   89263.319261375   38700.352398379       26714483.395645376       -132720980.924209450       -57540921.699830495              0.000000000          7.281194530
   -25035.610054535   89249.227873786   38694.242764696       26716270.577230129       -132720677.420908990       -57540790.128246166              0.000000000          7.281233138
   -25093.215287773   89235.104902588   38688.119436787       26716270.577230129       -132720677.420908990       -57540790.128246166              0.000000000          7.281271758
   -25150.811631877   89220.950352277   38681.982416601       26716270.577230129       -132720677.420908990       -57540790.128246166              0.000000000          7.281310389
   -25208.399066315   89206.764227357   38675.831706093       26718057.754882354       -132720373.897615310       -57540658.548004448              0.000000000          7.281349032
   -25265.977570558   89192.546532346   38669.667307222       26719844.928601760       -132720070.354328450       -57540526.959105372              0.000000000          7.281387687];
% % Penumbra Example
rv = [   -6891.447894751   63949.738178047   27724.545505436  ]';
rv_sun = [ 27623639.128357474       -132563915.689256130       -57472830.702920817   ]';

%  Umbra (Total Eclipse)  Example
rv = [    -8881.665279228   63739.985573811   27633.564195141  ]';
rv_sun = [27648630.770752989       -132559522.421055180       -57470926.247453578   ]';

%  Umbra (Annular Eclipse)  Example
rv = [  -360289.895402500   1804947.560213000   782531.466557400        ]';
rv_sun = [26499993.124778342       -132757256.161143260       -57556647.433934323               ]';


for i = 1:size(Data,1)
    
    t(i) = i;

    rv = Data(i,1:3)';
    rv_sun = Data(i,4:6)';

    %  Define the input vectors  ]';
    rv_B = [0 0 0]';

    %  Define the radius of Sun and Earth
    Re = 6378.1363;
    Rs = 695990.0000;

    %  Calculate relative vectors
    sv = rv - rv_B;
    sv_sun = rv_sun - rv_B;

    %  Calculate the apparrent radius of Sun and Earth
    Rps = asin(  Rs / norm( rv_sun - rv  )  );
    Rpe = asin(  Re / norm( rv - rv_B    )  );

    %  Calculate the apparent distance between Sun and Earth
    Dp = acos(-sv'*(rv_sun - rv)/norm(sv)/norm( rv_sun - rv  )   );

    if ( Dp >=Rps + Rpe)
        PercentShadow = 0;
    elseif (Dp <=  Rpe - Rps )
        PercentShadow = 100;
    elseif abs(Rps - Rpe) < Dp & Dp < Rps + Rpe  % Not an annular eclipse
        c1 = (Dp^2 + Rps^2 - Rpe^2 ) / 2/ Dp;
        c2 = sqrt( Rps^2 - c1^2 );
        A = Rps^2*acos( c1 / Rps  ) + Rpe^2 * acos( (Dp - c1)/Rpe ) - Dp*c2;
        PercentShadow =  100*A/pi/Rps^2;
    else                                      %  Annular eclipse
        PercentShadow = 100*Rpe^2/Rps^2;
    end

    ell   = -dot(sv,sv_sun)/norm(sv_sun);
    s     = norm(sv);
    s_sun = norm(sv_sun);
    d   = sqrt( s^2 - ell^2);

    sin_ap = (Rs + Re)/s_sun;
    sin_au = (Rs - Re)/s_sun;

    rp    = tan( asin(sin_ap)  )* (ell + Re/sin_ap);
    ru    = tan( asin(sin_au)  )* (ell - Re/sin_au);

    if ell > 0
        dp =  d - rp;
        du =  d - abs(ru);
    else
        dp =  abs(d - rp);
        du =  abs(d - abs(ru));
    end

    if du > 0 & dp > 0
        EclipseType = 'No Eclipse';
    elseif du < 0
        if ru < 0
            EclipseType = 'Umbra (Total Eclipse)';
        else
            EclipseType = 'Penumbra (Annular)';
        end
    else
        EclipseType = 'Penumbra';
    end
    Ru(i) = du;
    Rp(i) = dp;
    PS(i) = PercentShadow;
    disp(['PercentShadow = ' num2str(PercentShadow,4) '   '  ' EclipseType = ' EclipseType  ]);
    error(i) = PercentShadow - Data(i,7);
    

end

subplot(2,1,1)
plot(t,PS)
subplot(2,1,2)
plot(t,error)

