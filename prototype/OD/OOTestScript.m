PrepareGMAT

%==========================================================================
%==========================================================================
%------  Define the spacecraft properties
%==========================================================================
%==========================================================================
ODSat       = Spacecraft();
ODSat.Epoch = 24228.72810185185;
ODSat.X     = -33676.9539725404;
ODSat.Y     =  24914.768850706;
ODSat.Z     =  5824.40009033107;
ODSat.VX    = -1.81337607817738;
ODSat.VY    = -2.47154335695136;
ODSat.VZ    = .0797839760900568;
ODSat.Cr    = 2.2;
ODSat.Cd    = 1.8;

%==========================================================================
%==========================================================================
%------  Define the batch least squares solver
%==========================================================================
%==========================================================================
CanberraData = Measurement();
CanberraData.AddMeasurement{1} = {'Range','ODSat','Canberra'};
%CanberraData.AddMeasurement{2} = {'RangeRate','ODSat','Canberra'};

%==========================================================================
%==========================================================================
%------  Define the batch least squares solver
%==========================================================================
%==========================================================================
BLS = BatchEstimator();
BLS.MaxIterations   = 20;
BLS.Measurements    = 'CanberraData';
BLS.SolveFor        = {'ODSat.CartesianState'};
BLS.Propagator      = 'ODProp';
 
%==========================================================================
%==========================================================================
%-----  Define the ground station properties    
%==========================================================================
%==========================================================================
Canberra = GroundStation();
Canberra.X = -5469.41801615453;
Canberra.Y = -2385.88742555;
Canberra.Z =  2245.20260041136;
Canberra.X = -4450.8 ;
Canberra.Y = 2676.1;
Canberra.Z = -3691.38 ;


%==========================================================================
%==========================================================================
%-----  Define the Propagator   
%==========================================================================
%==========================================================================
ODProp = Propagator();
ODProp_FM.CentralBody  = 'Earth';
ODProp_FM.PointMasses  = {'Earth'};
ODProp_FM.SRP          = 'Off';
ODProp.FM              = ODProp_FM;
ODProp.Type            = 'RungeKutta89';
ODProp.InitialStepSize = 60;
ODProp.Accuracy        = 1.0e-12;
ODProp.MinStep         = 0.001;
ODProp.MaxStep         = 2700;
ODProp.MaxStepAttempts = 50;

RunGMAT
