<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>MATLAB Interface</title><link href="../files/style.css" type="text/css" rel="stylesheet"><meta content="DocBook XSL Stylesheets V1.78.1" name="generator"><link rel="home" href="index.html" title="General Mission Analysis Tool (GMAT)"><link rel="up" href="System.html" title="System"><link rel="prev" href="KeyboardShortcuts.html" title="Keyboard Shortcuts"><link rel="next" href="PythonInterface.html" title="Python Interface"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">MATLAB Interface</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="KeyboardShortcuts.html">Prev</a>&nbsp;</td><th align="center" width="60%">System</th><td align="right" width="20%">&nbsp;<a accesskey="n" href="PythonInterface.html">Next</a></td></tr></table><hr></div><div class="refentry"><a name="MatlabInterface"></a><div class="titlepage"></div><a name="N28F30" class="indexterm"></a><div class="refnamediv"><h2><span class="refentrytitle">MATLAB Interface</span></h2><p>MATLAB Interface &mdash; Interface to MATLAB system</p></div><div class="refsection"><a name="N28F41"></a><h2>Description</h2><p>The MATLAB interface provides a link to the Mathworks MATLAB
    environment, allowing GMAT to run MATLAB functions as if they were native
    functions in the GMAT script language.</p><p>The interface cannot be controlled directly through the script
    language, though it can be in the GMAT GUI. Instead, GMAT starts the
    interface automatically when it calls a MATLAB function.</p><p>There are two GMAT components that provide user access to the
    interface. For details on declaring a MATLAB function, see the
    <span class="guilabel"><a class="xref" href="MatlabFunction.html" title="MatlabFunction"><span class="refentrytitle">MatlabFunction</span></a></span> reference. For
    details on calling a function and passing data, see the <span class="guilabel"><a class="xref" href="CallMatlabFunction.html" title="CallMatlabFunction"><span class="refentrytitle">CallMatlabFunction</span></a></span> reference.</p><p><span class="ref_seealso">See Also</span>: <a class="xref" href="CallMatlabFunction.html" title="CallMatlabFunction"><span class="refentrytitle">CallMatlabFunction</span></a>, <a class="xref" href="MatlabFunction.html" title="MatlabFunction"><span class="refentrytitle">MatlabFunction</span></a></p></div><div class="refsection"><a name="N28F5C"></a><h2>GUI</h2><div class="screenshot"><div class="mediaobject" align="center"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td align="center"><img src="../files/images/System_MatlabInterface_ResourcesTree.png" align="middle" height="331"></td></tr></table></div></div><p>The MATLAB interface provides an icon in the
    <span class="guilabel">Interfaces</span> folder in the Resources tree that can be
    used to control the interface. Right-clicking the icon shows two options:
    <span class="guilabel">Open</span> and <span class="guilabel">Close</span>.</p><p>The <span class="guilabel">Open</span> menu item causes GMAT to open a
    connection to the MATLAB Engine, which in turns displays a MATLAB command
    window in the background. This connection is then used for all
    communication between GMAT and MATLAB until the connection is closed. Only
    one connection can be open at a time.</p><p>The <span class="guilabel">Close</span> menu item causes GMAT to close any
    open connection to the MATLAB Engine. If no connection is open, it has no
    effect.</p></div><div class="refsection"><a name="N28F7D"></a><h2>Remarks</h2><div class="refsection"><a name="N28F80"></a><h3>Interface
      Setup</h3><p>The following conditions must be true for GMAT to successfully
      initiate communication with MATLAB. All conditions must be true for the
      same instance of MATLAB.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Install a compatible, licensed version of MATLAB on the same
          machine on which GMAT is running. GMAT is tested with the latest
          version of MATLAB at the time of release, though versions R2006b and
          newer have been known to work.</p></li><li class="listitem"><p>The architecture (32-bit or 64-bit) of GMAT and the installed
          version of MATLAB must match. For example, the 32-bit version of
          GMAT is compatible only with the 32-bit version of MATLAB.</p></li><li class="listitem"><p>On Windows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Add the following path (where
                <code class="filename"><em class="replaceable"><code>MATLAB</code></em></code> is the
                path to the installed version of MATLAB) to your
                <code class="envar">Path</code> environment variable (either your user
                variable, or the system variable). If you continue to have
                trouble, try putting this path at the very beginning of your
                system path.</p><p><code class="filename"><em class="replaceable"><code>MATLAB</code></em>\bin\win32</code>
                (or <code class="filename">win64</code> for use with 64-bit versions of
                GMAT)</p></li><li class="listitem"><p>Register MATLAB for use as a COM server by
                running:</p><p><strong class="userinput"><code>matlab -regserver</code></strong></p><p>This is done automatically by the MATLAB installer. To
                do it manually, open an elevated command window and run the
                command above. Make sure to run the command in the folder
                containing the executable you wish to use (i.e.
                <em class="replaceable"><code>MATLAB</code></em>\bin\win32 or
                <em class="replaceable"><code>MATLAB</code></em>\bin\win64.)</p></li></ol></div></li><li class="listitem"><p>On Mac OS X: </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>The MATLABFORGMAT environment variable must exist and
                contain the full path to the MATLAB application bundle (e.g.
                /Applications/MATLAB_R2010a/MATLAB_R2010a.app).</p><p>Note that 64-bit GMAT must be used to interface with
                MATLAB after version R2010a.</p></li></ul></div></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Common troubleshooting tips on Windows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>If you are using the officially-released 32-bit version of
            GMAT, make sure you have the 32-bit version of MATLAB
            installed.</p></li><li class="listitem"><p>If the path above exists in your system <code class="envar">Path</code>
            variable, try place it at the front.</p></li><li class="listitem"><p>Make sure the same instance of MATLAB is referenced both in
            the <code class="envar">Path</code> variable and when running
            <strong class="userinput"><code>matlab -regserver</code></strong>.</p></li></ul></div></div></div><div class="refsection"><a name="N28FD2"></a><h3>MATLAB Engine Connection</h3><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Caution: GMAT does not close the MATLAB Command Window it
        creates after a run has completed. This allows manual inspection of
        the MATLAB workspace, but it can lead to confusing behavior if MATLAB
        functions or paths are changed and rerun in the same window.</p><p>We recommend closing the MATLAB Command Window by right-clicking
        Matlab in the Resources tree and clicking Close between each run if
        you are actively editing the script.</p></div><p>When GMAT runs a mission that contains a MATLAB function call, it
      opens a connection to the MATLAB engine before it makes the function
      call. It then reuses this connection for the rest of the GMAT
      session.</p><p>The MATLAB Engine can be controlled manually through the
      <span class="guilabel">Open</span> and <span class="guilabel">Close</span> options
      available by right-clicking the <span class="guilabel">Matlab</span> item in the
      Resources tree.</p></div></div><div class="refsection"><a name="N28FE7"></a><h2>Examples</h2><p>See the <a class="xref" href="MatlabFunction.html" title="MatlabFunction"><span class="refentrytitle">MatlabFunction</span></a> reference for common
    examples.</p></div></div><div class="navfooter"><hr><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="KeyboardShortcuts.html">Prev</a>&nbsp;</td><td align="center" width="20%"><a accesskey="u" href="System.html">Up</a></td><td align="right" width="40%">&nbsp;<a accesskey="n" href="PythonInterface.html">Next</a></td></tr><tr><td valign="top" align="left" width="40%">Keyboard Shortcuts&nbsp;</td><td align="center" width="20%"><a accesskey="h" href="index.html">Home</a></td><td valign="top" align="right" width="40%">&nbsp;Python Interface</td></tr></table></div></body></html>